,RefId,SqlTaskData,ExecutableType,ObjectName,componentClassID,contactInfo,description,name,File_path
0,Package\Licensed Capacity Measures\Seq - BuidlingCapacity_Actual\Foreach - New or Updated Fiscal Week\SQL - End LicensedCapacity_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1,Package\Licensed Capacity Measures\Seq - BuidlingCapacity_Actual\Foreach - New or Updated Fiscal Week\SQL - Start BuidlingCapacity_Actual AuditLog,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2,Package\Licensed Capacity Measures\Seq - BuidlingCapacity_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
3,Package\Licensed Capacity Measures\Seq - BuidlingCapacity_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount; ",1,1,0,0,0,0,1
4,Package\Licensed Capacity Measures\Seq - BuidlingCapacity_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
5,Package\Licensed Capacity Measures\Seq - BuidlingCapacity_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactCenterStatSnapshot (NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.[FiscalWeekEndDateKey] = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   AND d.FiscalYearNumber >= 2011
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]

UNION

SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactCenterStatSnapshot (NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.[FiscalWeekEndDateKey] = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
    AND d.FiscalYearNumber >= 2011
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
6,Package\Licensed Capacity Measures\Seq - LicensedCapacity_Actual\Foreach - New or Updated Fiscal Week\SQL - End LicensedCapacity_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
7,Package\Licensed Capacity Measures\Seq - LicensedCapacity_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LicensedCapacity_Actual AuditLog,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
8,Package\Licensed Capacity Measures\Seq - LicensedCapacity_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
9,Package\Licensed Capacity Measures\Seq - LicensedCapacity_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
10,Package\Licensed Capacity Measures\Seq - LicensedCapacity_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
11,Package\Licensed Capacity Measures\Seq - LicensedCapacity_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactCenterStatSnapshot (NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.[FiscalWeekEndDateKey] = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   AND d.FiscalYearNumber >= 2011
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]

UNION

SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactCenterStatSnapshot (NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.[FiscalWeekEndDateKey] = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
    AND d.FiscalYearNumber >= 2011
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
12,Package\Licensed Capacity Measures\Seq - LicensedCapacity_Plan\Foreach - New or Updated Fiscal Week\SQL - End LicensedCapacity_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
13,Package\Licensed Capacity Measures\Seq - LicensedCapacity_Plan\Foreach - New or Updated Fiscal Week\SQL - Start LicensedCapacity_Plan AuditLog,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
14,Package\Licensed Capacity Measures\Seq - LicensedCapacity_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
15,Package\Licensed Capacity Measures\Seq - LicensedCapacity_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
16,Package\Licensed Capacity Measures\Seq - LicensedCapacity_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
17,Package\Licensed Capacity Measures\Seq - LicensedCapacity_Plan\SQL - Get List Of Weeks to Process,"SELECT	  d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
				, d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
				, ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
				, ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(WEEK, DATEDIFF(WEEK, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
FROM FactGLBalancePlanAllocation (NOLOCK) AS f
JOIN DimDate(NOLOCK) AS d
ON f.[DateKey] = d.DateKey
LEFT JOIN DimDate(NOLOCK) AS d_nyr 
ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
WHERE [f].[EDWCreatedDate] > ?
GROUP BY d.[FiscalWeekNumber]
				  , d.[FiscalWeekEndDate]
				  , d.[FiscalYearEndDate]
				  , d.[FiscalWeekOfYearNumber]
				  , d_nyr.[FiscalWeekNumber]
				  , d_nyr.[FiscalWeekEndDate]


UNION

SELECT   d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
				, d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
				, ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
				, ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
FROM FactGLBalancePlanAllocation (NOLOCK) AS f
JOIN DimDate(NOLOCK) AS d
	ON f.[DateKey] = d.DateKey
LEFT JOIN DimDate(NOLOCK) AS d_nyr 
	ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
	AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
	AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
WHERE [d].[FiscalWeekNumber] > ?
GROUP BY d.[FiscalWeekNumber]
				  , d.[FiscalWeekEndDate]
				  , d.[FiscalYearEndDate]
				  , d.[FiscalWeekOfYearNumber]
				  , d_nyr.[FiscalWeekNumber]
				  , d_nyr.[FiscalWeekEndDate]
ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
18,Package\Licensed Capacity Measures\Seq - OperationalCapacity_Actual\Foreach - New or Updated Fiscal Week\SQL - End OperationalCapacity_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
19,Package\Licensed Capacity Measures\Seq - OperationalCapacity_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LicensedCapacity_Actual AuditLog,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
20,Package\Licensed Capacity Measures\Seq - OperationalCapacity_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
21,Package\Licensed Capacity Measures\Seq - OperationalCapacity_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
22,Package\Licensed Capacity Measures\Seq - OperationalCapacity_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
23,Package\Licensed Capacity Measures\Seq - OperationalCapacity_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactCenterStatSnapshot (NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.[FiscalWeekEndDateKey] = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   AND d.FiscalYearNumber >= 2011
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]

UNION

SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactCenterStatSnapshot (NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.[FiscalWeekEndDateKey] = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
    AND d.FiscalYearNumber >= 2011
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
24,Package\Licensed Capacity Measures\Seq - OperationalCapacity_Plan\Foreach - New or Updated Fiscal Week\SQL - End LicensedCapacity_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
25,Package\Licensed Capacity Measures\Seq - OperationalCapacity_Plan\Foreach - New or Updated Fiscal Week\SQL - Start LicensedCapacity_Plan AuditLog,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
26,Package\Licensed Capacity Measures\Seq - OperationalCapacity_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
27,Package\Licensed Capacity Measures\Seq - OperationalCapacity_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
28,Package\Licensed Capacity Measures\Seq - OperationalCapacity_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
29,Package\Licensed Capacity Measures\Seq - OperationalCapacity_Plan\SQL - Get List Of Weeks to Process,"SELECT   d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
    , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
    , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
    , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(WEEK, DATEDIFF(WEEK, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
FROM FactGLBalancePlanAllocation (NOLOCK) AS f
JOIN DimDate(NOLOCK) AS d
ON f.[DateKey] = d.DateKey
LEFT JOIN DimDate(NOLOCK) AS d_nyr 
ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
WHERE [f].[EDWCreatedDate] > ?
GROUP BY d.[FiscalWeekNumber]
      , d.[FiscalWeekEndDate]
      , d.[FiscalYearEndDate]
      , d.[FiscalWeekOfYearNumber]
      , d_nyr.[FiscalWeekNumber]
      , d_nyr.[FiscalWeekEndDate]


UNION

SELECT   d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
    , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
    , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
    , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
FROM FactGLBalancePlanAllocation (NOLOCK) AS f
JOIN DimDate(NOLOCK) AS d
 ON f.[DateKey] = d.DateKey
LEFT JOIN DimDate(NOLOCK) AS d_nyr 
 ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
 AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
 AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
WHERE [d].[FiscalWeekNumber] > ?
GROUP BY d.[FiscalWeekNumber]
      , d.[FiscalWeekEndDate]
      , d.[FiscalYearEndDate]
      , d.[FiscalWeekOfYearNumber]
      , d_nyr.[FiscalWeekNumber]
      , d_nyr.[FiscalWeekEndDate]
ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
30,Package\SEQ - GLPlanAllocation_LaborHours Measures\Foreach Loop Container - LaborHoursChildcare_Plan\SQL - BaseWeeklyMeasure Post Count for LaborHoursChildcare_Plan,"SELECT COUNT(1) AS vPostCount FROM BaseWeeklyMeasure(NOLOCK)
WHERE MeasureName = 'Labor Hours Childcare'
AND DataScenarioName = ('Plan')",1,1,0,0,0,0,1
31,Package\SEQ - GLPlanAllocation_LaborHours Measures\Foreach Loop Container - LaborHoursChildcare_Plan\SQL - BaseWeeklyMeasure Pre Count for LaborHoursChildcare_Plan,"SELECT COUNT(1) AS vPreCount FROM BaseWeeklyMeasure(NOLOCK)
WHERE MeasureName = 'Labor Hours Childcare'
AND DataScenarioName = ('Plan')",1,1,0,0,0,0,1
32,Package\SEQ - GLPlanAllocation_LaborHours Measures\Foreach Loop Container - LaborHoursChildcare_Plan\SQL - Delete from BaseWeeklyMeasure if LaborHoursChildcare_Plan present,"DELETE FROM BaseWeeklyMeasure
WHERE MeasureName = 'Labor Hours Childcare'
AND DataScenarioName = ('Plan')
AND FiscalWeekEndDate = ?

Select @@ROWCOUNT as DeleteCount ",1,1,0,0,0,0,1
33,Package\SEQ - GLPlanAllocation_LaborHours Measures\Foreach Loop Container - LaborHoursChildcare_Plan\SQL - End LaborHoursChildcare_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
34,Package\SEQ - GLPlanAllocation_LaborHours Measures\Foreach Loop Container - LaborHoursChildcare_Plan\SQL - Get FiscalWeekEndDate for Actual from DimDate for the FiscalWeekNumber,"SELECT DISTINCT FiscalWeekEndDate AS FiscalWeekEndDate 
FROM DimDate(NOLOCK) 
WHERE FiscalWeekNumber = ?;",1,1,0,0,0,0,1
35,Package\SEQ - GLPlanAllocation_LaborHours Measures\Foreach Loop Container - LaborHoursChildcare_Plan\SQL - Start LaborHoursChildcare_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
36,Package\SEQ - GLPlanAllocation_LaborHours Measures\Foreach Loop Container - LaborHoursOperating_Plan\SQL - BaseWeeklyMeasure Post Count for LaborHoursOperating_Plan,"SELECT COUNT(1) AS vPostCount FROM BaseWeeklyMeasure(NOLOCK)
WHERE MeasureName = 'Labor Hours Operating'
AND DataScenarioName = ('Plan')",1,1,0,0,0,0,1
37,Package\SEQ - GLPlanAllocation_LaborHours Measures\Foreach Loop Container - LaborHoursOperating_Plan\SQL - BaseWeeklyMeasure Pre Count for LaborHoursOperating_Plan,"SELECT COUNT(1) AS vPreCount FROM BaseWeeklyMeasure(NOLOCK)
WHERE MeasureName = 'Labor Hours Operating'
AND DataScenarioName = ('Plan')",1,1,0,0,0,0,1
38,Package\SEQ - GLPlanAllocation_LaborHours Measures\Foreach Loop Container - LaborHoursOperating_Plan\SQL - Delete from BaseWeeklyMeasure if LaborHoursOperating_Plan present,"DELETE FROM BaseWeeklyMeasure
WHERE MeasureName = 'Labor Hours Operating'
AND DataScenarioName = ('Plan')
AND FiscalWeekEndDate = ?

Select @@ROWCOUNT as DeleteCount ",1,1,0,0,0,0,1
39,Package\SEQ - GLPlanAllocation_LaborHours Measures\Foreach Loop Container - LaborHoursOperating_Plan\SQL - End LaborHoursOperating_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
40,Package\SEQ - GLPlanAllocation_LaborHours Measures\Foreach Loop Container - LaborHoursOperating_Plan\SQL - Get FiscalWeekEndDate for Actual from DimDate for the FiscalWeekNumber,"SELECT DISTINCT FiscalWeekEndDate AS FiscalWeekEndDate 
FROM DimDate(NOLOCK) 
WHERE FiscalWeekNumber = ?;",1,1,0,0,0,0,1
41,Package\SEQ - GLPlanAllocation_LaborHours Measures\Foreach Loop Container - LaborHoursOperating_Plan\SQL - Start LaborHoursOperating_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
42,Package\SEQ - GLPlanAllocation_LaborHours Measures\Foreach Loop Container - LaborHoursOvertime_Plan\SQL - BaseWeeklyMeasure Post Count for LaborHoursOvertime_Plan,"SELECT COUNT(1) AS vPostCount FROM BaseWeeklyMeasure(NOLOCK)
WHERE MeasureName = 'Labor Hours Overtime'
AND DataScenarioName = ('Plan')",1,1,0,0,0,0,1
43,Package\SEQ - GLPlanAllocation_LaborHours Measures\Foreach Loop Container - LaborHoursOvertime_Plan\SQL - BaseWeeklyMeasure Pre Count for LaborHoursOvertime_Plan,"SELECT COUNT(1) AS vPreCount FROM BaseWeeklyMeasure(NOLOCK)
WHERE MeasureName = 'Labor Hours Overtime'
AND DataScenarioName = ('Plan')",1,1,0,0,0,0,1
44,Package\SEQ - GLPlanAllocation_LaborHours Measures\Foreach Loop Container - LaborHoursOvertime_Plan\SQL - Delete from BaseWeeklyMeasure if LaborHoursOvertime_Plan present,"DELETE FROM BaseWeeklyMeasure
WHERE MeasureName = 'Labor Hours Overtime'
AND DataScenarioName = ('Plan')
AND FiscalWeekEndDate = ?

Select @@ROWCOUNT as DeleteCount ",1,1,0,0,0,0,1
45,Package\SEQ - GLPlanAllocation_LaborHours Measures\Foreach Loop Container - LaborHoursOvertime_Plan\SQL - End LaborHoursOvertime_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
46,Package\SEQ - GLPlanAllocation_LaborHours Measures\Foreach Loop Container - LaborHoursOvertime_Plan\SQL - Get FiscalWeekEndDate for Actual from DimDate for the FiscalWeekNumber,"SELECT DISTINCT FiscalWeekEndDate AS FiscalWeekEndDate 
FROM DimDate(NOLOCK) 
WHERE FiscalWeekNumber = ?;",1,1,0,0,0,0,1
47,Package\SEQ - GLPlanAllocation_LaborHours Measures\Foreach Loop Container - LaborHoursOvertime_Plan\SQL - Start LaborHoursOvertime_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
48,Package\SEQ - GLPlanAllocation_LaborHours Measures\Foreach Loop Container - LaborHoursSpecialProgramsMemo_Plan\SQL - BaseWeeklyMeasure Post Count for LaborHoursSpecialProgramsMemo_Plan,"SELECT COUNT(1) AS vPostCount FROM BaseWeeklyMeasure(NOLOCK)
WHERE MeasureName = 'Labor Hours Special Programs (Memo)'
AND DataScenarioName = ('Plan')",1,1,0,0,0,0,1
49,Package\SEQ - GLPlanAllocation_LaborHours Measures\Foreach Loop Container - LaborHoursSpecialProgramsMemo_Plan\SQL - BaseWeeklyMeasure Pre Count for LaborHoursSpecialProgramsMemo_Plan,"SELECT COUNT(1) AS vPreCount FROM BaseWeeklyMeasure(NOLOCK)
WHERE MeasureName = 'Labor Hours Special Programs (Memo)'
AND DataScenarioName = ('Plan')",1,1,0,0,0,0,1
50,Package\SEQ - GLPlanAllocation_LaborHours Measures\Foreach Loop Container - LaborHoursSpecialProgramsMemo_Plan\SQL - Delete from BaseWeeklyMeasure if LaborHoursSpecialProgramsMemo_Plan present,"DELETE FROM BaseWeeklyMeasure
WHERE MeasureName = 'Labor Hours Special Programs (Memo)'
AND DataScenarioName = ('Plan')
AND FiscalWeekEndDate = ?

Select @@ROWCOUNT as DeleteCount ",1,1,0,0,0,0,1
51,Package\SEQ - GLPlanAllocation_LaborHours Measures\Foreach Loop Container - LaborHoursSpecialProgramsMemo_Plan\SQL - End LaborHoursSpecialProgramsMemo_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
52,Package\SEQ - GLPlanAllocation_LaborHours Measures\Foreach Loop Container - LaborHoursSpecialProgramsMemo_Plan\SQL - Get FiscalWeekEndDate for Actual from DimDate for the FiscalWeekNumber,"SELECT DISTINCT FiscalWeekEndDate AS FiscalWeekEndDate 
FROM DimDate(NOLOCK) 
WHERE FiscalWeekNumber = ?;",1,1,0,0,0,0,1
53,Package\SEQ - GLPlanAllocation_LaborHours Measures\Foreach Loop Container - LaborHoursSpecialProgramsMemo_Plan\SQL - Start LaborHoursSpecialProgramsMemo_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
54,Package\SEQ - GLPlanAllocation_LaborHours Measures\Foreach Loop Container - LaborHoursTraining_Plan\SQL - BaseWeeklyMeasure Post Count for LaborHoursTraining_Plan,"SELECT COUNT(1) AS vPostCount FROM BaseWeeklyMeasure(NOLOCK)
WHERE MeasureName = 'Labor Hours Training'
AND DataScenarioName = ('Plan')",1,1,0,0,0,0,1
55,Package\SEQ - GLPlanAllocation_LaborHours Measures\Foreach Loop Container - LaborHoursTraining_Plan\SQL - BaseWeeklyMeasure Pre Count for LaborHoursTraining_Plan,"SELECT COUNT(1) AS vPreCount FROM BaseWeeklyMeasure(NOLOCK)
WHERE MeasureName = 'Labor Hours Training'
AND DataScenarioName = ('Plan')",1,1,0,0,0,0,1
56,Package\SEQ - GLPlanAllocation_LaborHours Measures\Foreach Loop Container - LaborHoursTraining_Plan\SQL - Delete from BaseWeeklyMeasure if LaborHoursTraining_Plan present,"DELETE FROM BaseWeeklyMeasure
WHERE MeasureName = 'Labor Hours Training'
AND DataScenarioName = ('Plan')
AND FiscalWeekEndDate = ?

Select @@ROWCOUNT as DeleteCount ",1,1,0,0,0,0,1
57,Package\SEQ - GLPlanAllocation_LaborHours Measures\Foreach Loop Container - LaborHoursTraining_Plan\SQL - End LaborHoursTraining_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
58,Package\SEQ - GLPlanAllocation_LaborHours Measures\Foreach Loop Container - LaborHoursTraining_Plan\SQL - Get FiscalWeekEndDate for Actual from DimDate for the FiscalWeekNumber,"SELECT DISTINCT FiscalWeekEndDate AS FiscalWeekEndDate 
FROM DimDate(NOLOCK) 
WHERE FiscalWeekNumber = ?;",1,1,0,0,0,0,1
59,Package\SEQ - GLPlanAllocation_LaborHours Measures\Foreach Loop Container - LaborHoursTraining_Plan\SQL - Start LaborHoursTraining_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
60,Package\SEQ - GLPlanAllocation_LaborHours Measures\Foreach Loop Container - LaborHours_Plan\SQL - BaseWeeklyMeasure Post Count for LaborHours_Plan,"SELECT COUNT(1) AS vPostCount FROM BaseWeeklyMeasure(NOLOCK)
WHERE MeasureName = 'Labor Hours'
AND DataScenarioName = ('Plan')",1,1,0,0,0,0,1
61,Package\SEQ - GLPlanAllocation_LaborHours Measures\Foreach Loop Container - LaborHours_Plan\SQL - BaseWeeklyMeasure Pre Count for LaborHours_Plan,"SELECT COUNT(1) AS vPreCount FROM BaseWeeklyMeasure(NOLOCK)
WHERE MeasureName = 'Labor Hours'
AND DataScenarioName = ('Plan')",1,1,0,0,0,0,1
62,Package\SEQ - GLPlanAllocation_LaborHours Measures\Foreach Loop Container - LaborHours_Plan\SQL - Delete from BaseWeeklyMeasure if LaborHours_Plan present,"DELETE FROM BaseWeeklyMeasure
WHERE MeasureName = 'Labor Hours'
AND DataScenarioName = ('Plan')
AND FiscalWeekEndDate = ?

Select @@ROWCOUNT as DeleteCount ",1,1,0,0,0,0,1
63,Package\SEQ - GLPlanAllocation_LaborHours Measures\Foreach Loop Container - LaborHours_Plan\SQL - End LaborHours_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
64,Package\SEQ - GLPlanAllocation_LaborHours Measures\Foreach Loop Container - LaborHours_Plan\SQL - Get FiscalWeekEndDate for Actual from DimDate for the FiscalWeekNumber,"SELECT DISTINCT FiscalWeekEndDate AS FiscalWeekEndDate 
FROM DimDate(NOLOCK) 
WHERE FiscalWeekNumber = ?;",1,1,0,0,0,0,1
65,Package\SEQ - GLPlanAllocation_LaborHours Measures\Foreach Loop Container - LaborHours_Plan\SQL - Start LaborHours_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
66,Package\SEQ - GLPlanAllocation_LaborHours Measures\Foreach Loop Container - TotalLaborHours_Plan\SQL - BaseWeeklyMeasure Post Count for TotalLaborHours_Plan,"SELECT COUNT(1) AS vPostCount FROM BaseWeeklyMeasure(NOLOCK)
WHERE MeasureName = 'Total Labor Hours'
AND DataScenarioName = ('Plan')",1,1,0,0,0,0,1
67,Package\SEQ - GLPlanAllocation_LaborHours Measures\Foreach Loop Container - TotalLaborHours_Plan\SQL - BaseWeeklyMeasure Pre Count for TotalLaborHours_Plan,"SELECT COUNT(1) AS vPreCount FROM BaseWeeklyMeasure(NOLOCK)
WHERE MeasureName = 'Total Labor Hours'
AND DataScenarioName = ('Plan')",1,1,0,0,0,0,1
68,Package\SEQ - GLPlanAllocation_LaborHours Measures\Foreach Loop Container - TotalLaborHours_Plan\SQL - Delete from BaseWeeklyMeasure if TotalLaborHours_Plan present,"DELETE FROM BaseWeeklyMeasure
WHERE MeasureName = 'Total Labor Hours'
AND DataScenarioName = ('Plan')
AND FiscalWeekEndDate = ?

Select @@ROWCOUNT as DeleteCount ",1,1,0,0,0,0,1
69,Package\SEQ - GLPlanAllocation_LaborHours Measures\Foreach Loop Container - TotalLaborHours_Plan\SQL - End TotalLaborHours_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
70,Package\SEQ - GLPlanAllocation_LaborHours Measures\Foreach Loop Container - TotalLaborHours_Plan\SQL - Get FiscalWeekEndDate for Actual from DimDate for the FiscalWeekNumber,"SELECT DISTINCT FiscalWeekEndDate AS FiscalWeekEndDate 
FROM DimDate(NOLOCK) 
WHERE FiscalWeekNumber = ?;",1,1,0,0,0,0,1
71,Package\SEQ - GLPlanAllocation_LaborHours Measures\Foreach Loop Container - TotalLaborHours_Plan\SQL - Start TotalLaborHours_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
72,Package\SEQ - GLPlanAllocation_LaborHours Measures\SQL - Get FiscalWeekNumbers for LaborHoursChildcare_Plan,"SELECT FiscalWeekNumber FROM FactGLBalancePlanAllocation(NOLOCK)f
JOIN DimDate(NOLOCK)d ON f.DateKey = d.DateKey
JOIN BING_EDW.model.vAccountSubaccount(NOLOCK)a ON f.AccountSubaccountKey = a.AccountSubaccountKey
WHERE GLMetricTypeKey = 2 AND [Field Path] LIKE '%9300.000300%'
AND f.EDWCreatedDate > ?
GROUP BY FiscalWeekNumber
ORDER BY FiscalWeekNumber",1,1,0,0,0,0,1
73,Package\SEQ - GLPlanAllocation_LaborHours Measures\SQL - Get FiscalWeekNumbers for LaborHoursOperating_Plan,"SELECT FiscalWeekNumber FROM FactGLBalancePlanAllocation(NOLOCK)f
JOIN DimDate(NOLOCK)d ON f.DateKey = d.DateKey
JOIN BING_EDW.model.vAccountSubaccount(NOLOCK)a ON f.AccountSubaccountKey = a.AccountSubaccountKey
WHERE GLMetricTypeKey = 2 AND [Field Path] LIKE '%9300.000300%'
AND f.EDWCreatedDate > ?
GROUP BY FiscalWeekNumber
ORDER BY FiscalWeekNumber",1,1,0,0,0,0,1
74,Package\SEQ - GLPlanAllocation_LaborHours Measures\SQL - Get FiscalWeekNumbers for LaborHoursOvertime_Plan,"SELECT FiscalWeekNumber FROM FactGLBalancePlanAllocation(NOLOCK)f
JOIN DimDate(NOLOCK)d ON f.DateKey = d.DateKey
JOIN BING_EDW.model.vAccountSubaccount(NOLOCK)a ON f.AccountSubaccountKey = a.AccountSubaccountKey
WHERE GLMetricTypeKey = 2 AND [Field Path] LIKE '%9300.000300%'
AND f.EDWCreatedDate > ?
GROUP BY FiscalWeekNumber
ORDER BY FiscalWeekNumber",1,1,0,0,0,0,1
75,Package\SEQ - GLPlanAllocation_LaborHours Measures\SQL - Get FiscalWeekNumbers for LaborHoursSpecialProgramsMemo_Plan,"SELECT FiscalWeekNumber FROM FactGLBalancePlanAllocation(NOLOCK)f
JOIN DimDate(NOLOCK)d ON f.DateKey = d.DateKey
JOIN BING_EDW.model.vAccountSubaccount(NOLOCK)a ON f.AccountSubaccountKey = a.AccountSubaccountKey
WHERE GLMetricTypeKey = 2 AND [Field Path] LIKE '%9300.000300%'
AND f.EDWCreatedDate > ?
GROUP BY FiscalWeekNumber
ORDER BY FiscalWeekNumber",1,1,0,0,0,0,1
76,Package\SEQ - GLPlanAllocation_LaborHours Measures\SQL - Get FiscalWeekNumbers for LaborHoursTraining_Plan,"SELECT FiscalWeekNumber FROM FactGLBalancePlanAllocation(NOLOCK)f
JOIN DimDate(NOLOCK)d ON f.DateKey = d.DateKey
JOIN BING_EDW.model.vAccountSubaccount(NOLOCK)a ON f.AccountSubaccountKey = a.AccountSubaccountKey
WHERE GLMetricTypeKey = 2 AND [Field Path] LIKE '%9300.000300%'
AND f.EDWCreatedDate > ?
GROUP BY FiscalWeekNumber
ORDER BY FiscalWeekNumber",1,1,0,0,0,0,1
77,Package\SEQ - GLPlanAllocation_LaborHours Measures\SQL - Get FiscalWeekNumbers for LaborHours_Plan,"SELECT FiscalWeekNumber FROM FactGLBalancePlanAllocation(NOLOCK)f
JOIN DimDate(NOLOCK)d ON f.DateKey = d.DateKey
JOIN BING_EDW.model.vAccountSubaccount(NOLOCK)a ON f.AccountSubaccountKey = a.AccountSubaccountKey
WHERE GLMetricTypeKey = 2 AND [Field Path] LIKE '%9300.000300%'
AND f.EDWCreatedDate > ?
GROUP BY FiscalWeekNumber
ORDER BY FiscalWeekNumber",1,1,0,0,0,0,1
78,Package\SEQ - GLPlanAllocation_LaborHours Measures\SQL - Get FiscalWeekNumbers for TotalLaborHours_Plan,"SELECT FiscalWeekNumber FROM FactGLBalancePlanAllocation(NOLOCK)f
JOIN DimDate(NOLOCK)d ON f.DateKey = d.DateKey
JOIN BING_EDW.model.vAccountSubaccount(NOLOCK)a ON f.AccountSubaccountKey = a.AccountSubaccountKey
WHERE GLMetricTypeKey = 2 AND [Field Path] LIKE '%9300.000300%'
AND f.EDWCreatedDate > ?
GROUP BY FiscalWeekNumber
ORDER BY FiscalWeekNumber",1,1,0,0,0,0,1
79,Package\SQL - End ARBalanceMeasure Auditlog,"Execute spEndAuditLog ?, ?, ?, ?, ?;",1,1,0,0,0,0,1
80,Package\SQL - End FTESnapshotMeasure Auditlog,"Execute spEndAuditLog ?, ?, ?, ?, ?;",1,1,0,0,0,0,1
81,Package\SQL - End GLBalancePlanAllocation_FTEMeasure Auditlog,"Execute spEndAuditLog ?, ?, ?, ?, ?;",1,1,0,0,0,0,1
82,Package\SQL - End GLBalancePlanAllocation_LaborHoursMeasure Auditlog,"Execute spEndAuditLog ?, ?, ?, ?, ?;",1,1,0,0,0,0,1
83,Package\SQL - End GLBalancePlanAllocation_LaborSalaryMeasure Auditlog,"Execute spEndAuditLog ?, ?, ?, ?, ?;",1,1,0,0,0,0,1
84,Package\SQL - End GLBalancePlanAllocation_NetRevenueMeasure Auditlog,"Execute spEndAuditLog ?, ?, ?, ?, ?;",1,1,0,0,0,0,1
85,Package\SQL - End GLPlanAllocation_LaborHoursMeasure Auditlog,"Execute spEndAuditLog ?, ?, ?, ?, ?;",1,1,0,0,0,0,1
86,Package\SQL - End LaborHoursMeasure Auditlog,"Execute spEndAuditLog ?, ?, ?, ?, ?;",1,1,0,0,0,0,1
87,Package\SQL - End LaborSalaryMeasure Auditlog,"Execute spEndAuditLog ?, ?, ?, ?, ?;",1,1,0,0,0,0,1
88,Package\SQL - End LeadEventMeasure Auditlog,"Execute spEndAuditLog ?, ?, ?, ?, ?;",1,1,0,0,0,0,1
89,Package\SQL - End LicenseCapacity Measure Auditlog,"Execute spEndAuditLog ?, ?, ?, ?, ?;",1,1,0,0,0,0,1
90,Package\SQL - End LifeCycleStatusMeasure Auditlog,"Execute spEndAuditLog ?, ?, ?, ?, ?;",1,1,0,0,0,0,1
91,Package\SQL - End NetRevenueMeasure Auditlog,"Execute spEndAuditLog ?, ?, ?, ?, ?;",1,1,0,0,0,0,1
92,Package\SQL - End Package Auditlog,"Execute spEndAuditLog ?, ?, ?, ?, ?;",2,2,0,0,0,0,2
93,Package\SQL - Get Last Processed Date from BaseETLBatchControl,"IF EXISTS
(SELECT 1
FROM BaseETLBatchControl(NOLOCK)
WHERE EventName = ?)

BEGIN
 (SELECT COALESCE(LastProcessedDate,'19000101') AS  LastProcessedDate 
 FROM BaseETLBatchControl(NOLOCK)
 WHERE EventName = ?)

END

ELSE 

BEGIN
 INSERT INTO BaseETLBatchControl(EventName, LastProcessedDate, Status) VALUES
  (?, NULL, NULL);

SELECT '1900-01-01' AS  LastProcessedDate;
END",1,1,0,0,0,0,1
94,"Package\SQL - Get Total Insert, Source, Update, Delete Count","SELECT SUM(SourceCount) AS SourceCount, SUM(InsertCount) AS InsertCount, SUM(UpdateCount) AS UpdateCount, SUM(DeleteCount) AS DeleteCount
FROM AuditLog(NOLOCK)
WHERE ExecutionID = ?",15,15,0,0,0,0,15
95,Package\SQL - Start GLPlanAllocation_LaborHoursMeasure Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
96,Package\SQL - Start Package Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",14,14,0,0,0,0,14
97,Package\SQL - Update Last Processed Date in BaseETLBatchControl,"UPDATE BaseETLBatchControl
SET LastProcessedDate = ?,
Status = 'Success'
WHERE EventName = 'GLPlanAllocation_LaborHours'",1,1,0,0,0,0,1
98,Package\Seq - ARBalance Measures\Seq - ARParent0to7Days_Actual\Foreach - New or Updated Fiscal Week\SQL - End ARParent0to7Days_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
99,Package\Seq - ARBalance Measures\Seq - ARParent0to7Days_Actual\Foreach - New or Updated Fiscal Week\SQL - Start ARParent0to7Days_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
100,Package\Seq - ARBalance Measures\Seq - ARParent0to7Days_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
101,Package\Seq - ARBalance Measures\Seq - ARParent0to7Days_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
102,Package\Seq - ARBalance Measures\Seq - ARParent0to7Days_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
103,Package\Seq - ARBalance Measures\Seq - ARParent0to7Days_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactARBalanceSnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.AsOfDateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactARBalanceSnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.AsOfDateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
104,Package\Seq - ARBalance Measures\Seq - ARParent8to14Days_Actual\Foreach - New or Updated Fiscal Week\SQL - End ARParent8to14Days_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
105,Package\Seq - ARBalance Measures\Seq - ARParent8to14Days_Actual\Foreach - New or Updated Fiscal Week\SQL - Start ARParent8to14Days_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
106,Package\Seq - ARBalance Measures\Seq - ARParent8to14Days_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
107,Package\Seq - ARBalance Measures\Seq - ARParent8to14Days_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
108,Package\Seq - ARBalance Measures\Seq - ARParent8to14Days_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
109,Package\Seq - ARBalance Measures\Seq - ARParent8to14Days_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactARBalanceSnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.AsOfDateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactARBalanceSnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.AsOfDateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
110,Package\Seq - ARBalance Measures\Seq - ARParent_Actual\Foreach - New or Updated Fiscal Week\SQL - End ARParent_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
111,Package\Seq - ARBalance Measures\Seq - ARParent_Actual\Foreach - New or Updated Fiscal Week\SQL - Start ARParent_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
112,Package\Seq - ARBalance Measures\Seq - ARParent_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
113,Package\Seq - ARBalance Measures\Seq - ARParent_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
114,Package\Seq - ARBalance Measures\Seq - ARParent_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
115,Package\Seq - ARBalance Measures\Seq - ARParent_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactARBalanceSnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.AsOfDateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactARBalanceSnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.AsOfDateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
116,Package\Seq - ARBalance Measures\Seq - ARParentover30Days_Actual\Foreach - New or Updated Fiscal Week\SQL - End ARParentover30Days_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
117,Package\Seq - ARBalance Measures\Seq - ARParentover30Days_Actual\Foreach - New or Updated Fiscal Week\SQL - Start ARParentover30Days_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
118,Package\Seq - ARBalance Measures\Seq - ARParentover30Days_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
119,Package\Seq - ARBalance Measures\Seq - ARParentover30Days_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
120,Package\Seq - ARBalance Measures\Seq - ARParentover30Days_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
121,Package\Seq - ARBalance Measures\Seq - ARParentover30Days_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactARBalanceSnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.AsOfDateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactARBalanceSnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.AsOfDateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
122,Package\Seq - ARBalance Measures\Seq - ARPrepay_Actual\Foreach - New or Updated Fiscal Week\SQL - End ARPrepay_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
123,Package\Seq - ARBalance Measures\Seq - ARPrepay_Actual\Foreach - New or Updated Fiscal Week\SQL - Start ARPrepay_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
124,Package\Seq - ARBalance Measures\Seq - ARPrepay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
125,Package\Seq - ARBalance Measures\Seq - ARPrepay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
126,Package\Seq - ARBalance Measures\Seq - ARPrepay_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
127,Package\Seq - ARBalance Measures\Seq - ARPrepay_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactARBalanceSnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.AsOfDateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactARBalanceSnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.AsOfDateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
128,Package\Seq - ARBalance Measures\Seq - ARStaff_Actual\Foreach - New or Updated Fiscal Week\SQL - End ARStaff_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
129,Package\Seq - ARBalance Measures\Seq - ARStaff_Actual\Foreach - New or Updated Fiscal Week\SQL - Start ARStaff_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
130,Package\Seq - ARBalance Measures\Seq - ARStaff_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
131,Package\Seq - ARBalance Measures\Seq - ARStaff_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
132,Package\Seq - ARBalance Measures\Seq - ARStaff_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
133,Package\Seq - ARBalance Measures\Seq - ARStaff_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactARBalanceSnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.AsOfDateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactARBalanceSnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.AsOfDateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
134,Package\Seq - ARBalance Measures\Seq - ARSubsidyOver90Days_Actual\Foreach - New or Updated Fiscal Week\SQL - End ARSubsidyOver90Days_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
135,Package\Seq - ARBalance Measures\Seq - ARSubsidyOver90Days_Actual\Foreach - New or Updated Fiscal Week\SQL - Start ARSubsidyOver90Days_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
136,Package\Seq - ARBalance Measures\Seq - ARSubsidyOver90Days_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
137,Package\Seq - ARBalance Measures\Seq - ARSubsidyOver90Days_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
138,Package\Seq - ARBalance Measures\Seq - ARSubsidyOver90Days_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
139,Package\Seq - ARBalance Measures\Seq - ARSubsidyOver90Days_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactARBalanceSnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.AsOfDateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactARBalanceSnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.AsOfDateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
140,Package\Seq - ARBalance Measures\Seq - ARSubsidyOver90DayswARParent_Actual\Foreach - New or Updated Fiscal Week\SQL - End ARSubsidyOver90DayswARParent_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
141,Package\Seq - ARBalance Measures\Seq - ARSubsidyOver90DayswARParent_Actual\Foreach - New or Updated Fiscal Week\SQL - Start ARSubsidyOver90DayswARParent_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
142,Package\Seq - ARBalance Measures\Seq - ARSubsidyOver90DayswARParent_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
143,Package\Seq - ARBalance Measures\Seq - ARSubsidyOver90DayswARParent_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
144,Package\Seq - ARBalance Measures\Seq - ARSubsidyOver90DayswARParent_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
145,Package\Seq - ARBalance Measures\Seq - ARSubsidyOver90DayswARParent_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactARBalanceSnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.AsOfDateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactARBalanceSnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.AsOfDateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
146,Package\Seq - ARBalance Measures\Seq - ARSubsidyUnder90Days_Actual\Foreach - New or Updated Fiscal Week\SQL - End ARSubsidyUnder90Days_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
147,Package\Seq - ARBalance Measures\Seq - ARSubsidyUnder90Days_Actual\Foreach - New or Updated Fiscal Week\SQL - Start ARSubsidyUnder90Days_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
148,Package\Seq - ARBalance Measures\Seq - ARSubsidyUnder90Days_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
149,Package\Seq - ARBalance Measures\Seq - ARSubsidyUnder90Days_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
150,Package\Seq - ARBalance Measures\Seq - ARSubsidyUnder90Days_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
151,Package\Seq - ARBalance Measures\Seq - ARSubsidyUnder90Days_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactARBalanceSnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.AsOfDateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactARBalanceSnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.AsOfDateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
152,Package\Seq - ARBalance Measures\Seq - ARSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - End ARSubsidy_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
153,Package\Seq - ARBalance Measures\Seq - ARSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - Start ARSubsidy_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
154,Package\Seq - ARBalance Measures\Seq - ARSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
155,Package\Seq - ARBalance Measures\Seq - ARSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
156,Package\Seq - ARBalance Measures\Seq - ARSubsidy_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
157,Package\Seq - ARBalance Measures\Seq - ARSubsidy_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactARBalanceSnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.AsOfDateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactARBalanceSnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.AsOfDateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
158,Package\Seq - ARBalance Measures\Seq - AR_Actual\Foreach - New or Updated Fiscal Week\SQL - End AR_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
159,Package\Seq - ARBalance Measures\Seq - AR_Actual\Foreach - New or Updated Fiscal Week\SQL - Start AR_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
160,Package\Seq - ARBalance Measures\Seq - AR_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
161,Package\Seq - ARBalance Measures\Seq - AR_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
162,Package\Seq - ARBalance Measures\Seq - AR_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
163,Package\Seq - ARBalance Measures\Seq - AR_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactARBalanceSnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.AsOfDateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactARBalanceSnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.AsOfDateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
164,Package\Seq - ARBalance Measures\Seq - NetAR_Actual\Foreach - New or Updated Fiscal Week\SQL - End NetAR_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
165,Package\Seq - ARBalance Measures\Seq - NetAR_Actual\Foreach - New or Updated Fiscal Week\SQL - Start NetAR_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
166,Package\Seq - ARBalance Measures\Seq - NetAR_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
167,Package\Seq - ARBalance Measures\Seq - NetAR_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
168,Package\Seq - ARBalance Measures\Seq - NetAR_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
169,Package\Seq - ARBalance Measures\Seq - NetAR_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactARBalanceSnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.AsOfDateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactARBalanceSnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.AsOfDateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
170,Package\Seq - Calculated Measures\Reported_Labor_Hour__Per_FTE\Foreach - New or Updated Fiscal Week\SQL - End LaborHours_Target Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
171,Package\Seq - Calculated Measures\Reported_Labor_Hour__Per_FTE\Foreach - New or Updated Fiscal Week\SQL - Start ReportedLaborHoursChildCare Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
172,Package\Seq - Calculated Measures\Reported_Labor_Hour__Per_FTE\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
173,Package\Seq - Calculated Measures\Reported_Labor_Hour__Per_FTE\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
174,Package\Seq - Calculated Measures\Reported_Labor_Hour__Per_FTE\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
175,Package\Seq - Calculated Measures\Reported_Labor_Hour__Per_FTE\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]

   ORDER BY DataScenarioFiscalWeekNumber
",1,1,0,0,0,0,1
176,Package\Seq - Calculated Measures\Reported_Labor_Hour__Per_FTE_Plan\Foreach - New or Updated Fiscal Week\SQL - End ReportedLaborHoursPerFTEPlan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
177,Package\Seq - Calculated Measures\Reported_Labor_Hour__Per_FTE_Plan\Foreach - New or Updated Fiscal Week\SQL - Start ReportedLaborHoursPerFTEPlan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
178,Package\Seq - Calculated Measures\Reported_Labor_Hour__Per_FTE_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
179,Package\Seq - Calculated Measures\Reported_Labor_Hour__Per_FTE_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
180,Package\Seq - Calculated Measures\Reported_Labor_Hour__Per_FTE_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]

   ORDER BY DataScenarioFiscalWeekNumber
",1,1,0,0,0,0,1
181,Package\Seq - Calculated Measures\Reported_Labor_Hour__Per_FTE_Target\Foreach - New or Updated Fiscal Week\SQL - End ReportedLaborHoursPerFTETarget Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
182,Package\Seq - Calculated Measures\Reported_Labor_Hour__Per_FTE_Target\Foreach - New or Updated Fiscal Week\SQL - Start ReportedLaborHoursPerFTETarget Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
183,Package\Seq - Calculated Measures\Reported_Labor_Hour__Per_FTE_Target\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Target'
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
184,Package\Seq - Calculated Measures\Reported_Labor_Hour__Per_FTE_Target\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
185,Package\Seq - Calculated Measures\Reported_Labor_Hour__Per_FTE_Target\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]

   ORDER BY DataScenarioFiscalWeekNumber
",1,1,0,0,0,0,1
186,Package\Seq - Calculated Measures\Reported_Labor_Salary_Pct_Net_Revenue\Foreach - New or Updated Fiscal Week\SQL - End LaborHours_Target Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
187,Package\Seq - Calculated Measures\Reported_Labor_Salary_Pct_Net_Revenue\Foreach - New or Updated Fiscal Week\SQL - Start ReportedLaborHoursChildCare Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
188,Package\Seq - Calculated Measures\Reported_Labor_Salary_Pct_Net_Revenue\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
189,Package\Seq - Calculated Measures\Reported_Labor_Salary_Pct_Net_Revenue\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
190,Package\Seq - Calculated Measures\Reported_Labor_Salary_Pct_Net_Revenue\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
191,Package\Seq - Calculated Measures\Reported_Labor_Salary_Pct_Net_Revenue\SQL - Get List Of Weeks to Process,"   SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]


  Union

  SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber
",1,1,0,0,0,0,1
192,Package\Seq - Calculated Measures\Reported_Labor_Salary_Pct_Net_Revenue_Plan\Foreach - New or Updated Fiscal Week\SQL - End ReportedLaborSalaryPctNetRevenuePlan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
193,Package\Seq - Calculated Measures\Reported_Labor_Salary_Pct_Net_Revenue_Plan\Foreach - New or Updated Fiscal Week\SQL - Start ReportedLaborSalaryPctNetRevenuePlan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
194,Package\Seq - Calculated Measures\Reported_Labor_Salary_Pct_Net_Revenue_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
195,Package\Seq - Calculated Measures\Reported_Labor_Salary_Pct_Net_Revenue_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
196,Package\Seq - Calculated Measures\Reported_Labor_Salary_Pct_Net_Revenue_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]


  Union

  SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborSalary(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborSalary(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
197,Package\Seq - Calculated Measures\Reported_WageRateBase_Plan\Foreach - New or Updated Fiscal Week\SQL - End ReportedWageRateBase_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
198,Package\Seq - Calculated Measures\Reported_WageRateBase_Plan\Foreach - New or Updated Fiscal Week\SQL - Start ReportedWageRateBase_plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
199,Package\Seq - Calculated Measures\Reported_WageRateBase_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
200,Package\Seq - Calculated Measures\Reported_WageRateBase_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
201,Package\Seq - Calculated Measures\Reported_WageRateBase_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]

   ORDER BY DataScenarioFiscalWeekNumber
",1,1,0,0,0,0,1
202,Package\Seq - Calculated Measures\Reported_WageRateBase_Target\Foreach - New or Updated Fiscal Week\SQL - End ReportedWageRateBase_Target Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
203,Package\Seq - Calculated Measures\Reported_WageRateBase_Target\Foreach - New or Updated Fiscal Week\SQL - Start ReportedWageRateBaseTarget Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
204,Package\Seq - Calculated Measures\Reported_WageRateBase_Target\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Target'
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
205,Package\Seq - Calculated Measures\Reported_WageRateBase_Target\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
206,Package\Seq - Calculated Measures\Reported_WageRateBase_Target\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]

   ORDER BY DataScenarioFiscalWeekNumber
",1,1,0,0,0,0,1
207,Package\Seq - Calculated Measures\Seq - BaseWeekStudents_Actual\Foreach - New or Updated Fiscal Week\SQL - End BaseWeekStudents_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
208,Package\Seq - Calculated Measures\Seq - BaseWeekStudents_Actual\Foreach - New or Updated Fiscal Week\SQL - Start BaseWeekStudents_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
209,Package\Seq - Calculated Measures\Seq - BaseWeekStudents_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
210,Package\Seq - Calculated Measures\Seq - BaseWeekStudents_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
211,Package\Seq - Calculated Measures\Seq - BaseWeekStudents_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 201101) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
212,Package\Seq - Calculated Measures\Seq - BaseWeekStudents_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]

   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
213,Package\Seq - Calculated Measures\Seq - InquirytoNSE_Actual\Foreach - New or Updated Fiscal Week\SQL - End InquirytoNSE_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
214,Package\Seq - Calculated Measures\Seq - InquirytoNSE_Actual\Foreach - New or Updated Fiscal Week\SQL - Start InquirytoNSE_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
215,Package\Seq - Calculated Measures\Seq - InquirytoNSE_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
216,Package\Seq - Calculated Measures\Seq - InquirytoNSE_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
217,Package\Seq - Calculated Measures\Seq - InquirytoNSE_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
218,Package\Seq - Calculated Measures\Seq - InquirytoNSE_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLeadEvent(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLeadEvent(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]

UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]

   ORDER BY DataScenarioFiscalWeekNumber
",1,1,0,0,0,0,1
219,Package\Seq - Calculated Measures\Seq - LaborHourPerFTE_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborHourPerFTE_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
220,Package\Seq - Calculated Measures\Seq - LaborHourPerFTE_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborHourperFTE_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
221,Package\Seq - Calculated Measures\Seq - LaborHourPerFTE_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
222,Package\Seq - Calculated Measures\Seq - LaborHourPerFTE_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
223,Package\Seq - Calculated Measures\Seq - LaborHourPerFTE_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
224,Package\Seq - Calculated Measures\Seq - LaborHourPerFTE_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]

   ORDER BY DataScenarioFiscalWeekNumber
",1,1,0,0,0,0,1
225,Package\Seq - Calculated Measures\Seq - LaborHourPerFTE_Plan\Foreach - New or Updated Fiscal Week\SQL - End LaborHourPerFTE_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
226,Package\Seq - Calculated Measures\Seq - LaborHourPerFTE_Plan\Foreach - New or Updated Fiscal Week\SQL - Start LaborHourPerFTE_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
227,Package\Seq - Calculated Measures\Seq - LaborHourPerFTE_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
228,Package\Seq - Calculated Measures\Seq - LaborHourPerFTE_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
229,Package\Seq - Calculated Measures\Seq - LaborHourPerFTE_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
  Union
  SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
230,Package\Seq - Calculated Measures\Seq - LaborHourPerFTE_Target\Foreach - New or Updated Fiscal Week\SQL - End LaborHourPerFTE_Target Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
231,Package\Seq - Calculated Measures\Seq - LaborHourPerFTE_Target\Foreach - New or Updated Fiscal Week\SQL - Start LaborHourPerFTE_Target Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
232,Package\Seq - Calculated Measures\Seq - LaborHourPerFTE_Target\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Target';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
233,Package\Seq - Calculated Measures\Seq - LaborHourPerFTE_Target\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
234,Package\Seq - Calculated Measures\Seq - LaborHourPerFTE_Target\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION

   SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
235,Package\Seq - Calculated Measures\Seq - LaborSalaryPctNetRevenue_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryPctNetRevenue_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
236,Package\Seq - Calculated Measures\Seq - LaborSalaryPctNetRevenue_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalaryPctNetRevenue_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
237,Package\Seq - Calculated Measures\Seq - LaborSalaryPctNetRevenue_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
238,Package\Seq - Calculated Measures\Seq - LaborSalaryPctNetRevenue_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
239,Package\Seq - Calculated Measures\Seq - LaborSalaryPctNetRevenue_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
240,Package\Seq - Calculated Measures\Seq - LaborSalaryPctNetRevenue_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]


  Union

  SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborSalary(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborSalary(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
241,Package\Seq - Calculated Measures\Seq - LaborSalaryPctNetRevenue_Plan\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryPctNetRevenue_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
242,Package\Seq - Calculated Measures\Seq - LaborSalaryPctNetRevenue_Plan\Foreach - New or Updated Fiscal Week\SQL - Labor Salary Pct Net Revenue_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
243,Package\Seq - Calculated Measures\Seq - LaborSalaryPctNetRevenue_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
244,Package\Seq - Calculated Measures\Seq - LaborSalaryPctNetRevenue_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
245,Package\Seq - Calculated Measures\Seq - LaborSalaryPctNetRevenue_Plan\SQL - Get List Of Weeks to Process,"
 SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   Union
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber
",1,1,0,0,0,0,1
246,Package\Seq - Calculated Measures\Seq - NSE_Actual\Foreach - New or Updated Fiscal Week\SQL - End NSE_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
247,Package\Seq - Calculated Measures\Seq - NSE_Actual\Foreach - New or Updated Fiscal Week\SQL - Start NSE_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
248,Package\Seq - Calculated Measures\Seq - NSE_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
249,Package\Seq - Calculated Measures\Seq - NSE_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
250,Package\Seq - Calculated Measures\Seq - NSE_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
251,Package\Seq - Calculated Measures\Seq - NSE_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM dbo.FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM dbo.FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]

   UNION 
   SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM CMS_Staging.dbo.enrlScheduleDay AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.EffectiveDate = d.FullDate
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].StgModifiedDate > ?
   AND f.EffectiveDate BETWEEN '2011-01-01' AND GETDATE()
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
     ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
252,Package\Seq - Calculated Measures\Seq - NetAverageRatePrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - End NetAverageRatePrivatePay_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
253,Package\Seq - Calculated Measures\Seq - NetAverageRatePrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - Start NetAverageRatePrivatePay_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
254,Package\Seq - Calculated Measures\Seq - NetAverageRatePrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
255,Package\Seq - Calculated Measures\Seq - NetAverageRatePrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
256,Package\Seq - Calculated Measures\Seq - NetAverageRatePrivatePay_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
257,Package\Seq - Calculated Measures\Seq - NetAverageRatePrivatePay_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]

   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
258,Package\Seq - Calculated Measures\Seq - NetAverageRatePrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - End NetAverageRatePrivatePay_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
259,Package\Seq - Calculated Measures\Seq - NetAverageRatePrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - Start NetAverageRatePrivatePay_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
260,Package\Seq - Calculated Measures\Seq - NetAverageRatePrivatePay_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
261,Package\Seq - Calculated Measures\Seq - NetAverageRatePrivatePay_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
262,Package\Seq - Calculated Measures\Seq - NetAverageRatePrivatePay_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   Union
   SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
263,Package\Seq - Calculated Measures\Seq - NetAverageRateSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - End NetAverageRateSubsidy_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
264,Package\Seq - Calculated Measures\Seq - NetAverageRateSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - Start NetAverageRateSubsidy_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
265,Package\Seq - Calculated Measures\Seq - NetAverageRateSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
266,Package\Seq - Calculated Measures\Seq - NetAverageRateSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
267,Package\Seq - Calculated Measures\Seq - NetAverageRateSubsidy_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
268,Package\Seq - Calculated Measures\Seq - NetAverageRateSubsidy_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]

   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
269,Package\Seq - Calculated Measures\Seq - NetAverageRateSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - End NetAverageRateSubsidy_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
270,Package\Seq - Calculated Measures\Seq - NetAverageRateSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - Start NetAverageRateSubsidy_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
271,Package\Seq - Calculated Measures\Seq - NetAverageRateSubsidy_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
272,Package\Seq - Calculated Measures\Seq - NetAverageRateSubsidy_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
273,Package\Seq - Calculated Measures\Seq - NetAverageRateSubsidy_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   Union
   SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
274,Package\Seq - Calculated Measures\Seq - NetAverageRate_Actual\Foreach - New or Updated Fiscal Week\SQL - End NetAverageRate_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
275,Package\Seq - Calculated Measures\Seq - NetAverageRate_Actual\Foreach - New or Updated Fiscal Week\SQL - Start NetAverageRate_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
276,Package\Seq - Calculated Measures\Seq - NetAverageRate_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
277,Package\Seq - Calculated Measures\Seq - NetAverageRate_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
278,Package\Seq - Calculated Measures\Seq - NetAverageRate_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
279,Package\Seq - Calculated Measures\Seq - NetAverageRate_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]

   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
280,Package\Seq - Calculated Measures\Seq - NetAverageRate_Plan\Foreach - New or Updated Fiscal Week\SQL - End NetAverageRate_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
281,Package\Seq - Calculated Measures\Seq - NetAverageRate_Plan\Foreach - New or Updated Fiscal Week\SQL - Start NetAverageRate_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
282,Package\Seq - Calculated Measures\Seq - NetAverageRate_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
283,Package\Seq - Calculated Measures\Seq - NetAverageRate_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
284,Package\Seq - Calculated Measures\Seq - NetAverageRate_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   Union
   SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
285,Package\Seq - Calculated Measures\Seq - Occupancy_Actual\Foreach - New or Updated Fiscal Week\SQL - End Occupancy_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
286,Package\Seq - Calculated Measures\Seq - Occupancy_Actual\Foreach - New or Updated Fiscal Week\SQL - Start Occupancy_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
287,Package\Seq - Calculated Measures\Seq - Occupancy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
288,Package\Seq - Calculated Measures\Seq - Occupancy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
289,Package\Seq - Calculated Measures\Seq - Occupancy_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
290,Package\Seq - Calculated Measures\Seq - Occupancy_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   Union
   SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactCenterStatSnapshot (NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.[FiscalWeekEndDateKey] = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   AND d.FiscalYearNumber >= 2011
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]

UNION

SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactCenterStatSnapshot (NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.[FiscalWeekEndDateKey] = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
    AND d.FiscalYearNumber >= 2011
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
291,Package\Seq - Calculated Measures\Seq - Occupancy_Plan\Foreach - New or Updated Fiscal Week\SQL - End Occupancy_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
292,Package\Seq - Calculated Measures\Seq - Occupancy_Plan\Foreach - New or Updated Fiscal Week\SQL - Start Occupancy_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
293,Package\Seq - Calculated Measures\Seq - Occupancy_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
294,Package\Seq - Calculated Measures\Seq - Occupancy_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
295,Package\Seq - Calculated Measures\Seq - Occupancy_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
  Union

  SELECT	  d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
				, d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
				, ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
				, ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
FROM FactCenterStatSnapshot (NOLOCK) AS f
JOIN DimDate(NOLOCK) AS d
ON f.[FiscalWeekEndDateKey] = d.DateKey
LEFT JOIN DimDate(NOLOCK) AS d_nyr 
ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
WHERE [f].[EDWCreatedDate] > ?
GROUP BY d.[FiscalWeekNumber]
				  , d.[FiscalWeekEndDate]
				  , d.[FiscalYearEndDate]
				  , d.[FiscalWeekOfYearNumber]
				  , d_nyr.[FiscalWeekNumber]
				  , d_nyr.[FiscalWeekEndDate]

UNION

SELECT   d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
				, d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
				, ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
				, ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
FROM FactCenterStatSnapshot (NOLOCK) AS f
JOIN DimDate(NOLOCK) AS d
	ON f.[FiscalWeekEndDateKey] = d.DateKey
LEFT JOIN DimDate(NOLOCK) AS d_nyr 
	ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
	AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
	AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
WHERE [d].[FiscalWeekNumber] > ?
GROUP BY d.[FiscalWeekNumber]
				  , d.[FiscalWeekEndDate]
				  , d.[FiscalYearEndDate]
				  , d.[FiscalWeekOfYearNumber]
				  , d_nyr.[FiscalWeekNumber]
				  , d_nyr.[FiscalWeekEndDate]
ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
296,Package\Seq - Calculated Measures\Seq - StudentRetention_Actual\Foreach - New or Updated Fiscal Week\SQL - End StudentRetention_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
297,Package\Seq - Calculated Measures\Seq - StudentRetention_Actual\Foreach - New or Updated Fiscal Week\SQL - Start StudentRetention_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
298,Package\Seq - Calculated Measures\Seq - StudentRetention_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
299,Package\Seq - Calculated Measures\Seq - StudentRetention_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
300,Package\Seq - Calculated Measures\Seq - StudentRetention_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 201101) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
301,Package\Seq - Calculated Measures\Seq - StudentRetention_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]

   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
302,Package\Seq - Calculated Measures\Seq - TourstoNSE_Actual\Foreach - New or Updated Fiscal Week\SQL - End TourstoNSE_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
303,Package\Seq - Calculated Measures\Seq - TourstoNSE_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TourstoNSE_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
304,Package\Seq - Calculated Measures\Seq - TourstoNSE_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
305,Package\Seq - Calculated Measures\Seq - TourstoNSE_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
306,Package\Seq - Calculated Measures\Seq - TourstoNSE_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
307,Package\Seq - Calculated Measures\Seq - TourstoNSE_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLeadEvent(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLeadEvent(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]

UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]

   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
308,Package\Seq - Calculated Measures\SpPopulateNSESupport,EXEC [dbo].[SpPopulateNSESupport]   @DebugMode =1,1,1,0,0,0,0,1
309,Package\Seq - FTESnapshot Measures\Seq - FTESumFivesPrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - End FTESumFivesPrivatePay_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
310,Package\Seq - FTESnapshot Measures\Seq - FTESumFivesPrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - Start FTESumFivesPrivatePay_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
311,Package\Seq - FTESnapshot Measures\Seq - FTESumFivesPrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
312,Package\Seq - FTESnapshot Measures\Seq - FTESumFivesPrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
313,Package\Seq - FTESnapshot Measures\Seq - FTESumFivesPrivatePay_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
314,Package\Seq - FTESnapshot Measures\Seq - FTESumFivesPrivatePay_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
315,Package\Seq - FTESnapshot Measures\Seq - FTESumFivesSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - End FTESumFivesSubsidy_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
316,Package\Seq - FTESnapshot Measures\Seq - FTESumFivesSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - Start FTESumFivesSubsidy_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
317,Package\Seq - FTESnapshot Measures\Seq - FTESumFivesSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
318,Package\Seq - FTESnapshot Measures\Seq - FTESumFivesSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
319,Package\Seq - FTESnapshot Measures\Seq - FTESumFivesSubsidy_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
320,Package\Seq - FTESnapshot Measures\Seq - FTESumFivesSubsidy_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
321,Package\Seq - FTESnapshot Measures\Seq - FTESumFives_Actual\Foreach - New or Updated Fiscal Week\SQL - End FTESumFives_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
322,Package\Seq - FTESnapshot Measures\Seq - FTESumFives_Actual\Foreach - New or Updated Fiscal Week\SQL - Start FTESumFives_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
323,Package\Seq - FTESnapshot Measures\Seq - FTESumFives_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
324,Package\Seq - FTESnapshot Measures\Seq - FTESumFives_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
325,Package\Seq - FTESnapshot Measures\Seq - FTESumFives_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
326,Package\Seq - FTESnapshot Measures\Seq - FTESumFives_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
327,Package\Seq - FTESnapshot Measures\Seq - FTESumFoursPrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - End FTESumFoursPrivatePay_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
328,Package\Seq - FTESnapshot Measures\Seq - FTESumFoursPrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - Start FTESumFoursPrivatePay_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
329,Package\Seq - FTESnapshot Measures\Seq - FTESumFoursPrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
330,Package\Seq - FTESnapshot Measures\Seq - FTESumFoursPrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
331,Package\Seq - FTESnapshot Measures\Seq - FTESumFoursPrivatePay_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
332,Package\Seq - FTESnapshot Measures\Seq - FTESumFoursPrivatePay_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
333,Package\Seq - FTESnapshot Measures\Seq - FTESumFoursSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - End FTESumFoursSubsidy_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
334,Package\Seq - FTESnapshot Measures\Seq - FTESumFoursSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - Start FTESumFoursSubsidy_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
335,Package\Seq - FTESnapshot Measures\Seq - FTESumFoursSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
336,Package\Seq - FTESnapshot Measures\Seq - FTESumFoursSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
337,Package\Seq - FTESnapshot Measures\Seq - FTESumFoursSubsidy_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
338,Package\Seq - FTESnapshot Measures\Seq - FTESumFoursSubsidy_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
339,Package\Seq - FTESnapshot Measures\Seq - FTESumFours_Actual\Foreach - New or Updated Fiscal Week\SQL - End FTESumFours_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
340,Package\Seq - FTESnapshot Measures\Seq - FTESumFours_Actual\Foreach - New or Updated Fiscal Week\SQL - Start FTESumFours_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
341,Package\Seq - FTESnapshot Measures\Seq - FTESumFours_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
342,Package\Seq - FTESnapshot Measures\Seq - FTESumFours_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
343,Package\Seq - FTESnapshot Measures\Seq - FTESumFours_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
344,Package\Seq - FTESnapshot Measures\Seq - FTESumFours_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
345,Package\Seq - FTESnapshot Measures\Seq - FTESumHourlyDropInPP_Actual\Foreach - New or Updated Fiscal Week\SQL - End FTESumHourlyDropInPP_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
346,Package\Seq - FTESnapshot Measures\Seq - FTESumHourlyDropInPP_Actual\Foreach - New or Updated Fiscal Week\SQL - Start FTESumHourlyDropInPP_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
347,Package\Seq - FTESnapshot Measures\Seq - FTESumHourlyDropInPP_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
348,Package\Seq - FTESnapshot Measures\Seq - FTESumHourlyDropInPP_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
349,Package\Seq - FTESnapshot Measures\Seq - FTESumHourlyDropInPP_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
350,Package\Seq - FTESnapshot Measures\Seq - FTESumHourlyDropInPP_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
351,Package\Seq - FTESnapshot Measures\Seq - FTESumHourlyDropInSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - End FTESumHourlyDropInSubsidy_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
352,Package\Seq - FTESnapshot Measures\Seq - FTESumHourlyDropInSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - Start FTESumHourlyDropInSubsidy_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
353,Package\Seq - FTESnapshot Measures\Seq - FTESumHourlyDropInSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
354,Package\Seq - FTESnapshot Measures\Seq - FTESumHourlyDropInSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
355,Package\Seq - FTESnapshot Measures\Seq - FTESumHourlyDropInSubsidy_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
356,Package\Seq - FTESnapshot Measures\Seq - FTESumHourlyDropInSubsidy_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
357,Package\Seq - FTESnapshot Measures\Seq - FTESumHourlyDropIn_Actual\Foreach - New or Updated Fiscal Week\SQL - End FTESumHourlyDropIn_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
358,Package\Seq - FTESnapshot Measures\Seq - FTESumHourlyDropIn_Actual\Foreach - New or Updated Fiscal Week\SQL - Start FTESumHourlyDropIn_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
359,Package\Seq - FTESnapshot Measures\Seq - FTESumHourlyDropIn_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
360,Package\Seq - FTESnapshot Measures\Seq - FTESumHourlyDropIn_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
361,Package\Seq - FTESnapshot Measures\Seq - FTESumHourlyDropIn_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
362,Package\Seq - FTESnapshot Measures\Seq - FTESumHourlyDropIn_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
363,Package\Seq - FTESnapshot Measures\Seq - FTESumInfantPrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - End FTESumInfantPrivatePay_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
364,Package\Seq - FTESnapshot Measures\Seq - FTESumInfantPrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - Start FTESumInfantPrivatePay_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
365,Package\Seq - FTESnapshot Measures\Seq - FTESumInfantPrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
366,Package\Seq - FTESnapshot Measures\Seq - FTESumInfantPrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
367,Package\Seq - FTESnapshot Measures\Seq - FTESumInfantPrivatePay_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
368,Package\Seq - FTESnapshot Measures\Seq - FTESumInfantPrivatePay_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
369,Package\Seq - FTESnapshot Measures\Seq - FTESumInfantSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - End FTESumInfantSubsidy_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
370,Package\Seq - FTESnapshot Measures\Seq - FTESumInfantSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - Start FTESumInfantSubsidy_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
371,Package\Seq - FTESnapshot Measures\Seq - FTESumInfantSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
372,Package\Seq - FTESnapshot Measures\Seq - FTESumInfantSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
373,Package\Seq - FTESnapshot Measures\Seq - FTESumInfantSubsidy_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
374,Package\Seq - FTESnapshot Measures\Seq - FTESumInfantSubsidy_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
375,Package\Seq - FTESnapshot Measures\Seq - FTESumInfant_Actual\Foreach - New or Updated Fiscal Week\SQL - End FTESumInfant_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
376,Package\Seq - FTESnapshot Measures\Seq - FTESumInfant_Actual\Foreach - New or Updated Fiscal Week\SQL - Start FTESumInfant_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
377,Package\Seq - FTESnapshot Measures\Seq - FTESumInfant_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
378,Package\Seq - FTESnapshot Measures\Seq - FTESumInfant_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
379,Package\Seq - FTESnapshot Measures\Seq - FTESumInfant_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
380,Package\Seq - FTESnapshot Measures\Seq - FTESumInfant_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
381,Package\Seq - FTESnapshot Measures\Seq - FTESumKindergartenPrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - End FTESumKindergartenPrivatePay_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
382,Package\Seq - FTESnapshot Measures\Seq - FTESumKindergartenPrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - Start FTESumKindergartenPrivatePay_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
383,Package\Seq - FTESnapshot Measures\Seq - FTESumKindergartenPrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
384,Package\Seq - FTESnapshot Measures\Seq - FTESumKindergartenPrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
385,Package\Seq - FTESnapshot Measures\Seq - FTESumKindergartenPrivatePay_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
386,Package\Seq - FTESnapshot Measures\Seq - FTESumKindergartenPrivatePay_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
387,Package\Seq - FTESnapshot Measures\Seq - FTESumKindergartenSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - End FTESumKindergartenSubsidy_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
388,Package\Seq - FTESnapshot Measures\Seq - FTESumKindergartenSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - Start FTESumKindergartenSubsidy_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
389,Package\Seq - FTESnapshot Measures\Seq - FTESumKindergartenSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
390,Package\Seq - FTESnapshot Measures\Seq - FTESumKindergartenSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
391,Package\Seq - FTESnapshot Measures\Seq - FTESumKindergartenSubsidy_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
392,Package\Seq - FTESnapshot Measures\Seq - FTESumKindergartenSubsidy_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
393,Package\Seq - FTESnapshot Measures\Seq - FTESumKindergarten_Actual\Foreach - New or Updated Fiscal Week\SQL - End FTESumKindergarten_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
394,Package\Seq - FTESnapshot Measures\Seq - FTESumKindergarten_Actual\Foreach - New or Updated Fiscal Week\SQL - Start FTESumKindergarten_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
395,Package\Seq - FTESnapshot Measures\Seq - FTESumKindergarten_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
396,Package\Seq - FTESnapshot Measures\Seq - FTESumKindergarten_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
397,Package\Seq - FTESnapshot Measures\Seq - FTESumKindergarten_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
398,Package\Seq - FTESnapshot Measures\Seq - FTESumKindergarten_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
399,Package\Seq - FTESnapshot Measures\Seq - FTESumMultiagePrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - End FTESumMultiagePrivatePay_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
400,Package\Seq - FTESnapshot Measures\Seq - FTESumMultiagePrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - Start FTESumMultiagePrivatePay_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
401,Package\Seq - FTESnapshot Measures\Seq - FTESumMultiagePrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
402,Package\Seq - FTESnapshot Measures\Seq - FTESumMultiagePrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
403,Package\Seq - FTESnapshot Measures\Seq - FTESumMultiagePrivatePay_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
404,Package\Seq - FTESnapshot Measures\Seq - FTESumMultiagePrivatePay_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
405,Package\Seq - FTESnapshot Measures\Seq - FTESumMultiageSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - End FTESumMultiageSubsidy_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
406,Package\Seq - FTESnapshot Measures\Seq - FTESumMultiageSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - Start FTESumMultiageSubsidy_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
407,Package\Seq - FTESnapshot Measures\Seq - FTESumMultiageSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
408,Package\Seq - FTESnapshot Measures\Seq - FTESumMultiageSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
409,Package\Seq - FTESnapshot Measures\Seq - FTESumMultiageSubsidy_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
410,Package\Seq - FTESnapshot Measures\Seq - FTESumMultiageSubsidy_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
411,Package\Seq - FTESnapshot Measures\Seq - FTESumMultiage_Actual\Foreach - New or Updated Fiscal Week\SQL - End FTESumMultiage_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
412,Package\Seq - FTESnapshot Measures\Seq - FTESumMultiage_Actual\Foreach - New or Updated Fiscal Week\SQL - Start FTESumMultiage_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
413,Package\Seq - FTESnapshot Measures\Seq - FTESumMultiage_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
414,Package\Seq - FTESnapshot Measures\Seq - FTESumMultiage_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
415,Package\Seq - FTESnapshot Measures\Seq - FTESumMultiage_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
416,Package\Seq - FTESnapshot Measures\Seq - FTESumMultiage_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
417,Package\Seq - FTESnapshot Measures\Seq - FTESumPrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - End FTESumPrivatePay_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
418,Package\Seq - FTESnapshot Measures\Seq - FTESumPrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - Start FTESumPrivatePay_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
419,Package\Seq - FTESnapshot Measures\Seq - FTESumPrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
420,Package\Seq - FTESnapshot Measures\Seq - FTESumPrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
421,Package\Seq - FTESnapshot Measures\Seq - FTESumPrivatePay_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
422,Package\Seq - FTESnapshot Measures\Seq - FTESumPrivatePay_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
423,Package\Seq - FTESnapshot Measures\Seq - FTESumSchoolAgePP_Actual\Foreach - New or Updated Fiscal Week\SQL - End FTESumSchoolAgePP_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
424,Package\Seq - FTESnapshot Measures\Seq - FTESumSchoolAgePP_Actual\Foreach - New or Updated Fiscal Week\SQL - Start FTESumSchoolAgePP_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
425,Package\Seq - FTESnapshot Measures\Seq - FTESumSchoolAgePP_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
426,Package\Seq - FTESnapshot Measures\Seq - FTESumSchoolAgePP_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
427,Package\Seq - FTESnapshot Measures\Seq - FTESumSchoolAgePP_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
428,Package\Seq - FTESnapshot Measures\Seq - FTESumSchoolAgePP_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
429,Package\Seq - FTESnapshot Measures\Seq - FTESumSchoolAgeSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - End FTESumSchoolAgeSubsidy_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
430,Package\Seq - FTESnapshot Measures\Seq - FTESumSchoolAgeSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - Start FTESumSchoolAgeSubsidy_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
431,Package\Seq - FTESnapshot Measures\Seq - FTESumSchoolAgeSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
432,Package\Seq - FTESnapshot Measures\Seq - FTESumSchoolAgeSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
433,Package\Seq - FTESnapshot Measures\Seq - FTESumSchoolAgeSubsidy_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
434,Package\Seq - FTESnapshot Measures\Seq - FTESumSchoolAgeSubsidy_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
435,Package\Seq - FTESnapshot Measures\Seq - FTESumSchoolAge_Actual\Foreach - New or Updated Fiscal Week\SQL - End FTESumSchoolAge_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
436,Package\Seq - FTESnapshot Measures\Seq - FTESumSchoolAge_Actual\Foreach - New or Updated Fiscal Week\SQL - Start FTESumSchoolAge_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
437,Package\Seq - FTESnapshot Measures\Seq - FTESumSchoolAge_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
438,Package\Seq - FTESnapshot Measures\Seq - FTESumSchoolAge_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
439,Package\Seq - FTESnapshot Measures\Seq - FTESumSchoolAge_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
440,Package\Seq - FTESnapshot Measures\Seq - FTESumSchoolAge_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
441,Package\Seq - FTESnapshot Measures\Seq - FTESumSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - End FTESumSubsidy_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
442,Package\Seq - FTESnapshot Measures\Seq - FTESumSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - Start FTESumSubsidy_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
443,Package\Seq - FTESnapshot Measures\Seq - FTESumSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
444,Package\Seq - FTESnapshot Measures\Seq - FTESumSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
445,Package\Seq - FTESnapshot Measures\Seq - FTESumSubsidy_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
446,Package\Seq - FTESnapshot Measures\Seq - FTESumSubsidy_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
447,Package\Seq - FTESnapshot Measures\Seq - FTESumThreesPrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - End FTESumThreesPrivatePay_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
448,Package\Seq - FTESnapshot Measures\Seq - FTESumThreesPrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - Start FTESumThreesPrivatePay_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
449,Package\Seq - FTESnapshot Measures\Seq - FTESumThreesPrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
450,Package\Seq - FTESnapshot Measures\Seq - FTESumThreesPrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
451,Package\Seq - FTESnapshot Measures\Seq - FTESumThreesPrivatePay_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
452,Package\Seq - FTESnapshot Measures\Seq - FTESumThreesPrivatePay_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
453,Package\Seq - FTESnapshot Measures\Seq - FTESumThreesSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - End FTESumThreesSubsidy_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
454,Package\Seq - FTESnapshot Measures\Seq - FTESumThreesSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - Start FTESumThreesSubsidy_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
455,Package\Seq - FTESnapshot Measures\Seq - FTESumThreesSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
456,Package\Seq - FTESnapshot Measures\Seq - FTESumThreesSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
457,Package\Seq - FTESnapshot Measures\Seq - FTESumThreesSubsidy_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
458,Package\Seq - FTESnapshot Measures\Seq - FTESumThreesSubsidy_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
459,Package\Seq - FTESnapshot Measures\Seq - FTESumThrees_Actual\Foreach - New or Updated Fiscal Week\SQL - End FTESumThrees_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
460,Package\Seq - FTESnapshot Measures\Seq - FTESumThrees_Actual\Foreach - New or Updated Fiscal Week\SQL - Start FTESumThrees_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
461,Package\Seq - FTESnapshot Measures\Seq - FTESumThrees_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
462,Package\Seq - FTESnapshot Measures\Seq - FTESumThrees_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
463,Package\Seq - FTESnapshot Measures\Seq - FTESumThrees_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
464,Package\Seq - FTESnapshot Measures\Seq - FTESumThrees_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
465,Package\Seq - FTESnapshot Measures\Seq - FTESumToddlerPrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - End FTESumToddlerPrivatePay_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
466,Package\Seq - FTESnapshot Measures\Seq - FTESumToddlerPrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - Start FTESumToddlerPrivatePay_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
467,Package\Seq - FTESnapshot Measures\Seq - FTESumToddlerPrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
468,Package\Seq - FTESnapshot Measures\Seq - FTESumToddlerPrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
469,Package\Seq - FTESnapshot Measures\Seq - FTESumToddlerPrivatePay_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
470,Package\Seq - FTESnapshot Measures\Seq - FTESumToddlerPrivatePay_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
471,Package\Seq - FTESnapshot Measures\Seq - FTESumToddlerSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - End FTESumToddlerSubsidy_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
472,Package\Seq - FTESnapshot Measures\Seq - FTESumToddlerSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - Start FTESumToddlerSubsidy_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
473,Package\Seq - FTESnapshot Measures\Seq - FTESumToddlerSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
474,Package\Seq - FTESnapshot Measures\Seq - FTESumToddlerSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
475,Package\Seq - FTESnapshot Measures\Seq - FTESumToddlerSubsidy_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
476,Package\Seq - FTESnapshot Measures\Seq - FTESumToddlerSubsidy_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
477,Package\Seq - FTESnapshot Measures\Seq - FTESumToddler_Actual\Foreach - New or Updated Fiscal Week\SQL - End FTESumToddler_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
478,Package\Seq - FTESnapshot Measures\Seq - FTESumToddler_Actual\Foreach - New or Updated Fiscal Week\SQL - Start FTESumToddler_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
479,Package\Seq - FTESnapshot Measures\Seq - FTESumToddler_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
480,Package\Seq - FTESnapshot Measures\Seq - FTESumToddler_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
481,Package\Seq - FTESnapshot Measures\Seq - FTESumToddler_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
482,Package\Seq - FTESnapshot Measures\Seq - FTESumToddler_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
483,Package\Seq - FTESnapshot Measures\Seq - FTESumTwosPrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - End FTESumTwosPrivatePay_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
484,Package\Seq - FTESnapshot Measures\Seq - FTESumTwosPrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - Start FTESumTwosPrivatePay_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
485,Package\Seq - FTESnapshot Measures\Seq - FTESumTwosPrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
486,Package\Seq - FTESnapshot Measures\Seq - FTESumTwosPrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
487,Package\Seq - FTESnapshot Measures\Seq - FTESumTwosPrivatePay_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
488,Package\Seq - FTESnapshot Measures\Seq - FTESumTwosPrivatePay_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
489,Package\Seq - FTESnapshot Measures\Seq - FTESumTwosSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - End FTESumTwosSubsidy_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
490,Package\Seq - FTESnapshot Measures\Seq - FTESumTwosSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - Start FTESumTwosSubsidy_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
491,Package\Seq - FTESnapshot Measures\Seq - FTESumTwosSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
492,Package\Seq - FTESnapshot Measures\Seq - FTESumTwosSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
493,Package\Seq - FTESnapshot Measures\Seq - FTESumTwosSubsidy_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
494,Package\Seq - FTESnapshot Measures\Seq - FTESumTwosSubsidy_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
495,Package\Seq - FTESnapshot Measures\Seq - FTESumTwos_Actual\Foreach - New or Updated Fiscal Week\SQL - End FTESumTwos_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
496,Package\Seq - FTESnapshot Measures\Seq - FTESumTwos_Actual\Foreach - New or Updated Fiscal Week\SQL - Start FTESumTwos_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
497,Package\Seq - FTESnapshot Measures\Seq - FTESumTwos_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
498,Package\Seq - FTESnapshot Measures\Seq - FTESumTwos_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
499,Package\Seq - FTESnapshot Measures\Seq - FTESumTwos_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
500,Package\Seq - FTESnapshot Measures\Seq - FTESumTwos_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
501,Package\Seq - FTESnapshot Measures\Seq - FTESum_Actual\Foreach - New or Updated Fiscal Week\SQL - End FTESum_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
502,Package\Seq - FTESnapshot Measures\Seq - FTESum_Actual\Foreach - New or Updated Fiscal Week\SQL - Start FTESum_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
503,Package\Seq - FTESnapshot Measures\Seq - FTESum_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
504,Package\Seq - FTESnapshot Measures\Seq - FTESum_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
505,Package\Seq - FTESnapshot Measures\Seq - FTESum_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
506,Package\Seq - FTESnapshot Measures\Seq - FTESum_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
507,Package\Seq - FTESnapshot Measures\Seq - FTEWeeklyAvgPP_Actual\Foreach - New or Updated Fiscal Week\SQL - End FTESumPrivatePay_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
508,Package\Seq - FTESnapshot Measures\Seq - FTEWeeklyAvgPP_Actual\Foreach - New or Updated Fiscal Week\SQL - Start FTEWeeklyAvgPP_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
509,Package\Seq - FTESnapshot Measures\Seq - FTEWeeklyAvgPP_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
510,Package\Seq - FTESnapshot Measures\Seq - FTEWeeklyAvgPP_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
511,Package\Seq - FTESnapshot Measures\Seq - FTEWeeklyAvgPP_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
512,Package\Seq - FTESnapshot Measures\Seq - FTEWeeklyAvgPP_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
513,Package\Seq - FTESnapshot Measures\Seq - FTEWeeklyAvgSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - End FTEWeeklyAvgSubsidy_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
514,Package\Seq - FTESnapshot Measures\Seq - FTEWeeklyAvgSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - Start FTEWeeklyAvgSubsidy_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
515,Package\Seq - FTESnapshot Measures\Seq - FTEWeeklyAvgSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
516,Package\Seq - FTESnapshot Measures\Seq - FTEWeeklyAvgSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
517,Package\Seq - FTESnapshot Measures\Seq - FTEWeeklyAvgSubsidy_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
518,Package\Seq - FTESnapshot Measures\Seq - FTEWeeklyAvgSubsidy_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
519,Package\Seq - FTESnapshot Measures\Seq - FTEWeeklyAvg_Actual\Foreach - New or Updated Fiscal Week\SQL - End FTEWeeklyAvg_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
520,Package\Seq - FTESnapshot Measures\Seq - FTEWeeklyAvg_Actual\Foreach - New or Updated Fiscal Week\SQL - Start FTEWeekly_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
521,Package\Seq - FTESnapshot Measures\Seq - FTEWeeklyAvg_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
522,Package\Seq - FTESnapshot Measures\Seq - FTEWeeklyAvg_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
523,Package\Seq - FTESnapshot Measures\Seq - FTEWeeklyAvg_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
524,Package\Seq - FTESnapshot Measures\Seq - FTEWeeklyAvg_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
525,Package\Seq - FTESnapshot Measures\Seq - LaborHourPerFTE_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborHourPerFTE_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
526,Package\Seq - FTESnapshot Measures\Seq - LaborHourPerFTE_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborHourperFTE_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
527,Package\Seq - FTESnapshot Measures\Seq - LaborHourPerFTE_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
528,Package\Seq - FTESnapshot Measures\Seq - LaborHourPerFTE_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
529,Package\Seq - FTESnapshot Measures\Seq - LaborHourPerFTE_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
530,Package\Seq - FTESnapshot Measures\Seq - LaborHourPerFTE_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
531,Package\Seq - FTESnapshot Measures\Seq - Occupancy_Actual\Foreach - New or Updated Fiscal Week\SQL - End Occupancy_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
532,Package\Seq - FTESnapshot Measures\Seq - Occupancy_Actual\Foreach - New or Updated Fiscal Week\SQL - Start Occupancy_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
533,Package\Seq - FTESnapshot Measures\Seq - Occupancy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
534,Package\Seq - FTESnapshot Measures\Seq - Occupancy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
535,Package\Seq - FTESnapshot Measures\Seq - Occupancy_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
536,Package\Seq - FTESnapshot Measures\Seq - Occupancy_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
537,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumFivesPrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - End FTESumFivesPrivatePay_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
538,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumFivesPrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - Start FTESumFivesPrivatePay_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
539,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumFivesPrivatePay_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
540,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumFivesPrivatePay_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
541,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumFivesPrivatePay_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
542,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumFivesSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - End FTESumFivesSubsidy_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
543,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumFivesSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - Start FTESumFivesSubsidy_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
544,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumFivesSubsidy_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
545,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumFivesSubsidy_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
546,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumFivesSubsidy_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
547,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumFives_Plan\Foreach - New or Updated Fiscal Week\SQL - End FTESumFives_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
548,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumFives_Plan\Foreach - New or Updated Fiscal Week\SQL - Start FTESumFives_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
549,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumFives_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
550,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumFives_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
551,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumFives_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
552,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumFoursPrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - End FTESumFoursPrivatePay_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
553,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumFoursPrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - Start FTESumFoursPrivatePay_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
554,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumFoursPrivatePay_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
555,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumFoursPrivatePay_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
556,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumFoursPrivatePay_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
557,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumFoursSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - End FTESumFoursSubsidy_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
558,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumFoursSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - Start FTESumFoursSubsidy_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
559,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumFoursSubsidy_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
560,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumFoursSubsidy_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
561,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumFoursSubsidy_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
562,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumFours_Plan\Foreach - New or Updated Fiscal Week\SQL - End FTESumFours_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
563,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumFours_Plan\Foreach - New or Updated Fiscal Week\SQL - Start FTESumFours_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
564,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumFours_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
565,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumFours_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
566,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumFours_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
567,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumHourlyDropInPP_Plan\Foreach - New or Updated Fiscal Week\SQL - End FTESumHourlyDropInPP_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
568,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumHourlyDropInPP_Plan\Foreach - New or Updated Fiscal Week\SQL - Start FTESumHourlyDropInPP_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
569,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumHourlyDropInPP_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
570,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumHourlyDropInPP_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
571,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumHourlyDropInPP_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
572,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumHourlyDropInSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - End FTESumHourlyDropInSubsidy_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
573,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumHourlyDropInSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - Start FTESumHourlyDropInSubsidy_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
574,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumHourlyDropInSubsidy_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
575,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumHourlyDropInSubsidy_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
576,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumHourlyDropInSubsidy_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
577,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumHourlyDropIn_Plan\Foreach - New or Updated Fiscal Week\SQL - End FTESumHourlyDropIn_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
578,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumHourlyDropIn_Plan\Foreach - New or Updated Fiscal Week\SQL - Start FTESumHourlyDropIn_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
579,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumHourlyDropIn_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
580,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumHourlyDropIn_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
581,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumHourlyDropIn_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
582,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumInfantPrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - End FTESumInfantPrivatePay_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
583,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumInfantPrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - Start FTESumInfantPrivatePay_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
584,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumInfantPrivatePay_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
585,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumInfantPrivatePay_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
586,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumInfantPrivatePay_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
587,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumInfantSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - End FTESumInfantSubsidy_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
588,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumInfantSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - Start FTESumInfantSubsidy_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
589,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumInfantSubsidy_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
590,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumInfantSubsidy_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
591,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumInfantSubsidy_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
592,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumInfant_Plan\Foreach - New or Updated Fiscal Week\SQL - End FTESumInfant_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
593,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumInfant_Plan\Foreach - New or Updated Fiscal Week\SQL - Start FTESumInfant_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
594,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumInfant_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
595,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumInfant_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
596,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumInfant_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
597,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumKindergartenPrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - End FTESumKindergartenPrivatePay_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
598,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumKindergartenPrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - Start FTESumKindergartenPrivatePay_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
599,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumKindergartenPrivatePay_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
600,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumKindergartenPrivatePay_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
601,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumKindergartenPrivatePay_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
602,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumKindergartenSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - End FTESumKindergartenSubsidy_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
603,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumKindergartenSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - Start FTESumKindergartenSubsidy_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
604,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumKindergartenSubsidy_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
605,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumKindergartenSubsidy_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
606,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumKindergartenSubsidy_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
607,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumKindergarten_Plan\Foreach - New or Updated Fiscal Week\SQL - End FTESumKindergarten_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
608,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumKindergarten_Plan\Foreach - New or Updated Fiscal Week\SQL - Start FTESumKindergarten_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
609,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumKindergarten_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
610,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumKindergarten_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
611,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumKindergarten_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
612,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumMultiagePrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - End FTESumMultiagePrivatePay_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
613,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumMultiagePrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - Start FTESumMultiagePrivatePay_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
614,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumMultiagePrivatePay_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
615,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumMultiagePrivatePay_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
616,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumMultiagePrivatePay_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
617,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumMultiageSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - End FTESumMultiageSubsidy_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
618,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumMultiageSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - Start FTESumMultiageSubsidy_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
619,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumMultiageSubsidy_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
620,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumMultiageSubsidy_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
621,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumMultiageSubsidy_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
622,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumMultiage_Plan\Foreach - New or Updated Fiscal Week\SQL - End FTESumMultiage_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
623,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumMultiage_Plan\Foreach - New or Updated Fiscal Week\SQL - Start FTESumMultiage_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
624,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumMultiage_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
625,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumMultiage_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
626,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumMultiage_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
627,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumPrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - End FTESumPrivatePay_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
628,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumPrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - Start FTESumPrivatePay_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
629,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumPrivatePay_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
630,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumPrivatePay_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
631,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumPrivatePay_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
632,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumSchoolAgePP_Plan\Foreach - New or Updated Fiscal Week\SQL - End FTESumSchoolAgePP_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
633,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumSchoolAgePP_Plan\Foreach - New or Updated Fiscal Week\SQL - Start FTESumSchoolAgePP_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
634,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumSchoolAgePP_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
635,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumSchoolAgePP_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
636,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumSchoolAgePP_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
637,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumSchoolAgeSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - End FTESumSchoolAgeSubsidy_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
638,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumSchoolAgeSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - Start FTESumSchoolAgeSubsidy_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
639,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumSchoolAgeSubsidy_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
640,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumSchoolAgeSubsidy_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
641,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumSchoolAgeSubsidy_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
642,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumSchoolAge_Plan\Foreach - New or Updated Fiscal Week\SQL - End FTESumSchoolAge_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
643,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumSchoolAge_Plan\Foreach - New or Updated Fiscal Week\SQL - Start FTESumSchoolAge_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
644,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumSchoolAge_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
645,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumSchoolAge_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
646,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumSchoolAge_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
647,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - End FTESumSubsidy_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
648,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - Start FTESumSubsidy_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
649,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumSubsidy_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
650,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumSubsidy_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
651,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumSubsidy_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
652,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumThreesPrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - End FTESumThreesPrivatePay_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
653,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumThreesPrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - Start FTESumThreesPrivatePay_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
654,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumThreesPrivatePay_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
655,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumThreesPrivatePay_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
656,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumThreesPrivatePay_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
657,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumThreesSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - End FTESumThreesSubsidy_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
658,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumThreesSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - Start FTESumThreesSubsidy_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
659,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumThreesSubsidy_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
660,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumThreesSubsidy_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
661,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumThreesSubsidy_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
662,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumThrees_Plan\Foreach - New or Updated Fiscal Week\SQL - End FTESumThrees_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
663,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumThrees_Plan\Foreach - New or Updated Fiscal Week\SQL - Start FTESumThrees_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
664,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumThrees_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
665,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumThrees_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
666,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumThrees_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
667,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumToddlerPrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - End FTESumToddlerPrivatePay_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
668,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumToddlerPrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - Start FTESumToddlerPrivatePay_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
669,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumToddlerPrivatePay_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
670,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumToddlerPrivatePay_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
671,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumToddlerPrivatePay_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
672,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumToddlerSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - End FTESumToddlerSubsidy_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
673,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumToddlerSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - Start FTESumToddlerSubsidy_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
674,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumToddlerSubsidy_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
675,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumToddlerSubsidy_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
676,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumToddlerSubsidy_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
677,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumToddler_Plan\Foreach - New or Updated Fiscal Week\SQL - End FTESumToddler_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
678,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumToddler_Plan\Foreach - New or Updated Fiscal Week\SQL - Start FTESumToddler_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
679,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumToddler_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
680,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumToddler_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
681,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumToddler_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
682,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumTwosPrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - End FTESumTwosPrivatePay_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
683,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumTwosPrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - Start FTESumTwosPrivatePay_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
684,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumTwosPrivatePay_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
685,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumTwosPrivatePay_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
686,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumTwosPrivatePay_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
687,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumTwosSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - End FTESumTwosSubsidy_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
688,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumTwosSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - Start FTESumTwosSubsidy_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
689,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumTwosSubsidy_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
690,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumTwosSubsidy_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
691,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumTwosSubsidy_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
692,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumTwos_Plan\Foreach - New or Updated Fiscal Week\SQL - End FTESumTwos_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
693,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumTwos_Plan\Foreach - New or Updated Fiscal Week\SQL - Start FTESumTwos_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
694,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumTwos_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
695,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumTwos_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
696,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESumTwos_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
697,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESum_Plan\Foreach - New or Updated Fiscal Week\SQL - End FTESum_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
698,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESum_Plan\Foreach - New or Updated Fiscal Week\SQL - Start FTESum_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
699,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESum_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
700,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESum_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
701,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTESum_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
702,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTEWeeklyAvgPP_Plan\Foreach - New or Updated Fiscal Week\SQL - End FTEWeeklyAvgPP_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
703,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTEWeeklyAvgPP_Plan\Foreach - New or Updated Fiscal Week\SQL - Start FTEWeeklyAvgPP_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
704,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTEWeeklyAvgPP_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
705,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTEWeeklyAvgPP_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
706,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTEWeeklyAvgPP_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
707,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTEWeeklyAvgSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - End FTEWeeklyAvgSubsidy_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
708,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTEWeeklyAvgSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - Start FTEWeeklyAvgSubsidy_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
709,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTEWeeklyAvgSubsidy_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
710,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTEWeeklyAvgSubsidy_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
711,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTEWeeklyAvgSubsidy_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
712,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTEWeeklyAvg_Plan\Foreach - New or Updated Fiscal Week\SQL - End FTESum_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
713,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTEWeeklyAvg_Plan\Foreach - New or Updated Fiscal Week\SQL - Start FTEWeeklyAvg_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
714,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTEWeeklyAvg_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
715,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTEWeeklyAvg_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
716,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - FTEWeeklyAvg_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
717,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - LaborHourPerFTE_Plan\Foreach - New or Updated Fiscal Week\SQL - End LaborHourPerFTE_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
718,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - LaborHourPerFTE_Plan\Foreach - New or Updated Fiscal Week\SQL - Start LaborHourPerFTE_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
719,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - LaborHourPerFTE_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
720,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - LaborHourPerFTE_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
721,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - LaborHourPerFTE_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
722,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - LaborHourPerFTE_Target\Foreach - New or Updated Fiscal Week\SQL - End LaborHourPerFTE_Target Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
723,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - LaborHourPerFTE_Target\Foreach - New or Updated Fiscal Week\SQL - Start LaborHourPerFTE_Target Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
724,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - LaborHourPerFTE_Target\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Target';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
725,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - LaborHourPerFTE_Target\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
726,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - LaborHourPerFTE_Target\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
727,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - Occupancy_Plan\Foreach - New or Updated Fiscal Week\SQL - End Occupancy_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
728,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - Occupancy_Plan\Foreach - New or Updated Fiscal Week\SQL - Start Occupancy_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
729,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - Occupancy_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
730,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - Occupancy_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
731,Package\Seq - GLBalancePlanAllocation_FTE Measures\Seq - Occupancy_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2 
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000100%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2 
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
732,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursChildcare_Plan\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursChildcare_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
733,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursChildcare_Plan\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursChildcare_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
734,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursChildcare_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
735,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursChildcare_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
736,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursChildcare_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
737,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursManagementAndAdmin_Plan\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursManagementAndAdmin_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
738,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursManagementAndAdmin_Plan\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursManagementAndAdmin_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
739,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursManagementAndAdmin_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
740,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursManagementAndAdmin_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
741,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursManagementAndAdmin_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
742,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursOperating_Plan\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursOperating_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
743,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursOperating_Plan\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursOperating_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
744,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursOperating_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
745,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursOperating_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
746,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursOperating_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
747,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursOvertime_Plan\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursOvertime_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
748,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursOvertime_Plan\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursOvertime_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
749,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursOvertime_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
750,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursOvertime_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
751,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursOvertime_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
752,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursRegular_Plan\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursRegulare_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
753,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursRegular_Plan\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursRegular_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
754,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursRegular_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
755,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursRegular_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
756,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursRegular_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
757,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursSpecialProgramsMemo_Plan\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursSpecialProgramsMemo_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
758,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursSpecialProgramsMemo_Plan\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursSpecialProgramsMemo_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
759,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursSpecialProgramsMemo_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
760,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursSpecialProgramsMemo_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
761,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursSpecialProgramsMemo_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
762,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursTotalDirect_Plan\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursTotalDirect_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
763,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursTotalDirect_Plan\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursTotalDirect_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
764,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursTotalDirect_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
765,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursTotalDirect_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
766,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursTotalDirect_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000700%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000700%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
767,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursTotalFringeBenefits_Plan\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursTotalFringeBenefits_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
768,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursTotalFringeBenefits_Plan\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursTotalFringeBenefits_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
769,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursTotalFringeBenefits_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
770,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursTotalFringeBenefits_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
771,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursTotalFringeBenefits_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000800%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000800%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
772,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursTotalSalariesandFringeBenefits_Plan\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursTotalSalariesandFringeBenefits_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
773,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursTotalSalariesandFringeBenefits_Plan\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursTotalSalariesandFringeBenefits_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
774,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursTotalSalariesandFringeBenefits_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
775,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursTotalSalariesandFringeBenefits_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
776,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursTotalSalariesandFringeBenefits_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
777,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursTraining_Plan\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursTraining_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
778,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursTraining_Plan\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursTraining_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
779,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursTraining_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
780,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursTraining_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
781,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHoursTraining_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
782,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHours_Plan\Foreach - New or Updated Fiscal Week\SQL - End LaborHours_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
783,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHours_Plan\Foreach - New or Updated Fiscal Week\SQL - Start LaborHours_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
784,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHours_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
785,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHours_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
786,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - LaborHours_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
787,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - ReportedLaborHoursChildcare_Plan\Foreach - New or Updated Fiscal Week\SQL - End ReportedLaborHoursChildcare_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
788,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - ReportedLaborHoursChildcare_Plan\Foreach - New or Updated Fiscal Week\SQL - Start ReportedLaborHoursChildcare_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
789,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - ReportedLaborHoursChildcare_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
790,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - ReportedLaborHoursChildcare_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
791,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - ReportedLaborHoursChildcare_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
792,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - ReportedLaborHoursRegular_Plan\Foreach - New or Updated Fiscal Week\SQL - End ReportedLaborHoursRegulare_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
793,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - ReportedLaborHoursRegular_Plan\Foreach - New or Updated Fiscal Week\SQL - Start ReportedLaborHoursRegular_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
794,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - ReportedLaborHoursRegular_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
795,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - ReportedLaborHoursRegular_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
796,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - ReportedLaborHoursRegular_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
797,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - ReportedLaborHours_Plan\Foreach - New or Updated Fiscal Week\SQL - End ReportedLaborHours_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
798,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - ReportedLaborHours_Plan\Foreach - New or Updated Fiscal Week\SQL - Start ReportedLaborHours_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
799,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - ReportedLaborHours_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
800,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - ReportedLaborHours_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
801,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - ReportedLaborHours_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
802,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - TotalLaborHours_Plan\Foreach - New or Updated Fiscal Week\SQL - End TotalLaborHours_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
803,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - TotalLaborHours_Plan\Foreach - New or Updated Fiscal Week\SQL - Start TotalLaborHours_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
804,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - TotalLaborHours_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
805,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - TotalLaborHours_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
806,Package\Seq - GLBalancePlanAllocation_LaborHours Measures\Seq - TotalLaborHours_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 2
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 2
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
807,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryChildcareOvertime_Plan\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryChildcareOvertime_Plan  Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
808,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryChildcareOvertime_Plan\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalaryChildcareOvertime_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
809,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryChildcareOvertime_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
810,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryChildcareOvertime_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
811,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryChildcareOvertime_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
812,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryChildcareRegular_Plan\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryChildcareRegular_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
813,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryChildcareRegular_Plan\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalaryChildcareRegular_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
814,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryChildcareRegular_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
815,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryChildcareRegular_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
816,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryChildcareRegular_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
817,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryChildcare_Plan\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryChildcare_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
818,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryChildcare_Plan\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalaryChildcare_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
819,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryChildcare_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
820,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryChildcare_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
821,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryChildcare_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
822,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryManagementAndAdmin_Plan\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryManagementAndAdmin_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
823,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryManagementAndAdmin_Plan\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalaryManagementAndAdmin_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
824,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryManagementAndAdmin_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
825,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryManagementAndAdmin_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
826,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryManagementAndAdmin_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
827,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryOperatingOvertime_Plan\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryOperatingOvertime_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
828,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryOperatingOvertime_Plan\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalaryOperatingOvertime_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
829,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryOperatingOvertime_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
830,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryOperatingOvertime_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
831,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryOperatingOvertime_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
832,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryOperatingRegular_Plan\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryOperatingRegular_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
833,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryOperatingRegular_Plan\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalaryOperatingRegular_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
834,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryOperatingRegular_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
835,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryOperatingRegular_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
836,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryOperatingRegular_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
837,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryOperating_Plan\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryOperating_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
838,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryOperating_Plan\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalaryOperating_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
839,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryOperating_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
840,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryOperating_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
841,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryOperating_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
842,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryOvertime_Plan\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryOvertime_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
843,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryOvertime_Plan\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalaryOvertime_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
844,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryOvertime_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
845,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryOvertime_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
846,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryOvertime_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
847,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryPaidTimeOff_Plan\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryPaidTimeOff_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
848,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryPaidTimeOff_Plan\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalaryPaidTimeOff_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
849,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryPaidTimeOff_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
850,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryPaidTimeOff_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
851,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryPaidTimeOff_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
852,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryRegular_Plan\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryRegular_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
853,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryRegular_Plan\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalaryRegular_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
854,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryRegular_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
855,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryRegular_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
856,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryRegular_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
857,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalarySpecialProgramsOvertime_Plan\Foreach - New or Updated Fiscal Week\SQL - End LaborSalarySpecialProgramsOvertime_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
858,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalarySpecialProgramsOvertime_Plan\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalarySpecialProgramsOvertime_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
859,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalarySpecialProgramsOvertime_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
860,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalarySpecialProgramsOvertime_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
861,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalarySpecialProgramsOvertime_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
862,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalarySpecialProgramsRegular_Plan\Foreach - New or Updated Fiscal Week\SQL - End LaborSalarySpecialProgramsRegular_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
863,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalarySpecialProgramsRegular_Plan\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalarySpecialProgramsRegular_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
864,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalarySpecialProgramsRegular_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
865,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalarySpecialProgramsRegular_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
866,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalarySpecialProgramsRegular_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
867,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalarySpecialPrograms_Plan\Foreach - New or Updated Fiscal Week\SQL - End LaborSalarySpecialPrograms_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
868,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalarySpecialPrograms_Plan\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalarySpecialPrograms_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
869,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalarySpecialPrograms_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
870,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalarySpecialPrograms_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
871,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalarySpecialPrograms_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
872,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryTotalDirect_Plan\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryTotalDirect_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
873,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryTotalDirect_Plan\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalaryTotalDirect_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
874,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryTotalDirect_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
875,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryTotalDirect_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
876,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryTotalDirect_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000700%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000700%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
877,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryTotalFringeBenefits_Plan\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryTotalFringeBenefits_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
878,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryTotalFringeBenefits_Plan\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalaryTotalFringeBenefits_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
879,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryTotalFringeBenefits_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
880,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryTotalFringeBenefits_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
881,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryTotalFringeBenefits_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000800%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9200.000800%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
882,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryTotalSalariesandFringeBenefits_Plan\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryTotalSalariesandFringeBenefits_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
883,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryTotalSalariesandFringeBenefits_Plan\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalaryTotalSalariesandFringeBenefits_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
884,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryTotalSalariesandFringeBenefits_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
885,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryTotalSalariesandFringeBenefits_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
886,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryTotalSalariesandFringeBenefits_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
887,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryTrainingOvertime_Plan\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryTrainingOvertime_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
888,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryTrainingOvertime_Plan\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalaryTrainingOvertime_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
889,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryTrainingOvertime_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
890,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryTrainingOvertime_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
891,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryTrainingOvertime_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
892,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryTrainingRegular_Plan\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryTrainingRegular_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
893,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryTrainingRegular_Plan\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalaryTrainingRegular_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
894,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryTrainingRegular_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
895,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryTrainingRegular_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
896,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryTrainingRegular_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
897,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryTraining_Plan\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryTraining_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
898,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryTraining_Plan\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalaryTraining_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
899,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryTraining_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
900,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryTraining_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
901,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalaryTraining_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
902,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalary_Plan\Foreach - New or Updated Fiscal Week\SQL - End LaborSalary_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
903,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalary_Plan\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalary_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
904,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalary_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
905,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalary_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
906,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - LaborSalary_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
907,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - ReportedLaborSalariesOvertimePremium_Plan\Foreach - New or Updated Fiscal Week\SQL - End ReportedLaborSalariesOvertimePremium_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
908,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - ReportedLaborSalariesOvertimePremium_Plan\Foreach - New or Updated Fiscal Week\SQL - Start ReportedLaborSalariesOvertimePremium_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
909,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - ReportedLaborSalariesOvertimePremium_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
910,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - ReportedLaborSalariesOvertimePremium_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
911,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - ReportedLaborSalariesOvertimePremium_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
912,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - ReportedLaborSalaryChildcare_Plan\Foreach - New or Updated Fiscal Week\SQL - End ReportedLaborSalaryChildcare_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
913,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - ReportedLaborSalaryChildcare_Plan\Foreach - New or Updated Fiscal Week\SQL - Start ReportedLaborSalaryChildcare_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
914,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - ReportedLaborSalaryChildcare_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
915,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - ReportedLaborSalaryChildcare_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
916,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - ReportedLaborSalaryChildcare_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
917,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - ReportedLaborSalaryOperating_Plan\Foreach - New or Updated Fiscal Week\SQL - End ReportedLaborSalaryOperating_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
918,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - ReportedLaborSalaryOperating_Plan\Foreach - New or Updated Fiscal Week\SQL - Start ReportedLaborSalaryOperating_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
919,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - ReportedLaborSalaryOperating_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
920,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - ReportedLaborSalaryOperating_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
921,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - ReportedLaborSalaryOperating_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
922,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - ReportedLaborSalaryRegular_Plan\Foreach - New or Updated Fiscal Week\SQL - End ReportedLaborSalaryRegular_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
923,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - ReportedLaborSalaryRegular_Plan\Foreach - New or Updated Fiscal Week\SQL - Start ReportedLaborSalaryRegular_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
924,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - ReportedLaborSalaryRegular_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
925,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - ReportedLaborSalaryRegular_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
926,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - ReportedLaborSalaryRegular_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
927,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - ReportedLaborSalarySpecialPrograms_Plan\Foreach - New or Updated Fiscal Week\SQL - End ReportedLaborSalarySpecialPrograms_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
928,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - ReportedLaborSalarySpecialPrograms_Plan\Foreach - New or Updated Fiscal Week\SQL - Start ReportedLaborSalarySpecialPrograms_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
929,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - ReportedLaborSalarySpecialPrograms_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
930,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - ReportedLaborSalarySpecialPrograms_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
931,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - ReportedLaborSalarySpecialPrograms_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
932,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - ReportedLaborSalaryTraining_Plan\Foreach - New or Updated Fiscal Week\SQL - End ReportedLaborSalaryTraining_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
933,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - ReportedLaborSalaryTraining_Plan\Foreach - New or Updated Fiscal Week\SQL - Start ReportedLaborSalaryTraining_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
934,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - ReportedLaborSalaryTraining_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
935,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - ReportedLaborSalaryTraining_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
936,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - ReportedLaborSalaryTraining_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
937,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - ReportedLaborSalary_Plan\Foreach - New or Updated Fiscal Week\SQL - End ReportedLaborSalary_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
938,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - ReportedLaborSalary_Plan\Foreach - New or Updated Fiscal Week\SQL - Start ReportedLaborSalary_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
939,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - ReportedLaborSalary_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
940,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - ReportedLaborSalary_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
941,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - ReportedLaborSalary_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
942,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - TotalLaborSalaries_Plan\Foreach - New or Updated Fiscal Week\SQL - End TotalLaborSalaries_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
943,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - TotalLaborSalaries_Plan\Foreach - New or Updated Fiscal Week\SQL - Start TotalLaborSalaries_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
944,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - TotalLaborSalaries_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
945,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - TotalLaborSalaries_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
946,Package\Seq - GLBalancePlanAllocation_LaborSalary Measures\Seq - TotalLaborSalaries_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN [model].vAccountSubaccount (NOLOCK) asa
        ON asa.AccountSubaccountKey = f.AccountSubAccountKey
           AND asa.[Field Path] LIKE '%9300.000300%'
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
947,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - BadDebt_Plan\Foreach - New or Updated Fiscal Week\SQL - End BadDebt_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
948,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - BadDebt_Plan\Foreach - New or Updated Fiscal Week\SQL - Start BadDebt_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
949,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - BadDebt_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
950,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - BadDebt_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
951,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - BadDebt_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
952,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - ChargeOffAverage_Plan\Foreach - New or Updated Fiscal Week\SQL - End ChargeOffAverage_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
953,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - ChargeOffAverage_Plan\Foreach - New or Updated Fiscal Week\SQL - Start ChargeOffAverage_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
954,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - ChargeOffAverage_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
955,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - ChargeOffAverage_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
956,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - ChargeOffAverage_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
957,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - ChargeOff_Plan\Foreach - New or Updated Fiscal Week\SQL - End ChargeOff_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
958,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - ChargeOff_Plan\Foreach - New or Updated Fiscal Week\SQL - Start ChargeOff_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
959,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - ChargeOff_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
960,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - ChargeOff_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
961,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - ChargeOff_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
962,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountCareSelect_Plan\Foreach - New or Updated Fiscal Week\SQL - End DiscountCareSelect_Plan,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
963,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountCareSelect_Plan\Foreach - New or Updated Fiscal Week\SQL - Start DiscountCareSelect_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
964,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountCareSelect_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
965,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountCareSelect_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
966,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountCareSelect_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
967,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountClosedCenterPriceMatch_Plan\Foreach - New or Updated Fiscal Week\SQL - End DiscountClosedCenterPriceMatch_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
968,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountClosedCenterPriceMatch_Plan\Foreach - New or Updated Fiscal Week\SQL - Start DiscountClosedCenterPriceMatch_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
969,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountClosedCenterPriceMatch_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
970,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountClosedCenterPriceMatch_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
971,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountClosedCenterPriceMatch_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
972,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountDMApproved_Plan\Foreach - New or Updated Fiscal Week\SQL - End DiscountDMApproved_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
973,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountDMApproved_Plan\Foreach - New or Updated Fiscal Week\SQL - Start DiscountDMApproved_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
974,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountDMApproved_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
975,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountDMApproved_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
976,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountDMApproved_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
977,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountDiscretionaryPctTuitionPP_Plan\Foreach - New or Updated Fiscal Week\SQL - End DiscountDiscretionaryPctTuitionPP_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
978,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountDiscretionaryPctTuitionPP_Plan\Foreach - New or Updated Fiscal Week\SQL - Start DiscountDiscretionaryPctTuitionPP_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
979,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountDiscretionaryPctTuitionPP_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
980,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountDiscretionaryPctTuitionPP_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
981,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountDiscretionaryPctTuitionPP_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
982,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountDiscretionaryPrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - End DiscountDiscretionaryPrivatePay_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
983,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountDiscretionaryPrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - Start DiscountDiscretionaryPrivatePay_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
984,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountDiscretionaryPrivatePay_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
985,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountDiscretionaryPrivatePay_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
986,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountDiscretionaryPrivatePay_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
987,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountDiscretionary_Plan\Foreach - New or Updated Fiscal Week\SQL - End DiscountDiscretionary_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
988,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountDiscretionary_Plan\Foreach - New or Updated Fiscal Week\SQL - Start DiscountDiscretionary_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
989,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountDiscretionary_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
990,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountDiscretionary_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
991,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountDiscretionary_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
992,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountFamily_Plan\Foreach - New or Updated Fiscal Week\SQL - End DiscountFamily_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
993,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountFamily_Plan\Foreach - New or Updated Fiscal Week\SQL - Start DiscountFamily_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
994,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountFamily_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
995,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountFamily_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
996,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountFamily_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
997,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountFees_Plan\Foreach - New or Updated Fiscal Week\SQL - End DiscountFees_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
998,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountFees_Plan\Foreach - New or Updated Fiscal Week\SQL - Start DiscountFees_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
999,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountFees_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1000,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountFees_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1001,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountFees_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1002,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountFreeDay_Plan\Foreach - New or Updated Fiscal Week\SQL - End DiscountFreeDay_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1003,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountFreeDay_Plan\Foreach - New or Updated Fiscal Week\SQL - Start DiscountFreeDay_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1004,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountFreeDay_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1005,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountFreeDay_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1006,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountFreeDay_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1007,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountGiftOfEducation_Plan\Foreach - New or Updated Fiscal Week\SQL - End DiscountGiftOfEducation_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1008,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountGiftOfEducation_Plan\Foreach - New or Updated Fiscal Week\SQL - Start DiscountGiftOfEducation_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1009,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountGiftOfEducation_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1010,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountGiftOfEducation_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1011,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountGiftOfEducation_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1012,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountNationalMarketing_Plan\Foreach - New or Updated Fiscal Week\SQL - End DiscountNationalMarketing_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1013,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountNationalMarketing_Plan\Foreach - New or Updated Fiscal Week\SQL - Start DiscountNationalMarketing_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1014,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountNationalMarketing_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1015,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountNationalMarketing_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1016,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountNationalMarketing_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1017,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountNationalTuition_Plan\Foreach - New or Updated Fiscal Week\SQL - End DiscountNationalTuition_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1018,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountNationalTuition_Plan\Foreach - New or Updated Fiscal Week\SQL - Start DiscountNationalTuition_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1019,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountNationalTuition_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1020,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountNationalTuition_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1021,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountNationalTuition_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1022,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountOther_Plan\Foreach - New or Updated Fiscal Week\SQL - End DiscountOther_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1023,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountOther_Plan\Foreach - New or Updated Fiscal Week\SQL - Start DiscountOther_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1024,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountOther_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1025,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountOther_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1026,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountOther_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1027,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountPPPctTuitionPP_Plan\Foreach - New or Updated Fiscal Week\SQL - End DiscountPPPctTuitionPP_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1028,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountPPPctTuitionPP_Plan\Foreach - New or Updated Fiscal Week\SQL - Start DiscountPPPctTuitionPP_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1029,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountPPPctTuitionPP_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1030,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountPPPctTuitionPP_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1031,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountPPPctTuitionPP_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1032,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountPrimary_Plan\Foreach - New or Updated Fiscal Week\SQL - End DiscountPrimary_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1033,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountPrimary_Plan\Foreach - New or Updated Fiscal Week\SQL - Start DiscountPrimary_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1034,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountPrimary_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1035,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountPrimary_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1036,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountPrimary_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1037,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountPrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - End DiscountPrivatePay_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1038,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountPrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - Start DiscountPrivatePay_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1039,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountPrivatePay_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1040,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountPrivatePay_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1041,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountPrivatePay_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1042,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountPromotion_Plan\Foreach - New or Updated Fiscal Week\SQL - End DiscountPromotion_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1043,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountPromotion_Plan\Foreach - New or Updated Fiscal Week\SQL - Start DiscountPromotion_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1044,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountPromotion_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1045,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountPromotion_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1046,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountPromotion_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1047,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountReferral_Plan\Foreach - New or Updated Fiscal Week\SQL - End DiscountReferral_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1048,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountReferral_Plan\Foreach - New or Updated Fiscal Week\SQL - Start DiscountReferral_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1049,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountReferral_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1050,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountReferral_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1051,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountReferral_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1052,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountSpecialPrograms_Plan\Foreach - New or Updated Fiscal Week\SQL - End DiscountSpecialPrograms_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1053,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountSpecialPrograms_Plan\Foreach - New or Updated Fiscal Week\SQL - Start DiscountSpecialPrograms_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1054,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountSpecialPrograms_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1055,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountSpecialPrograms_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1056,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountSpecialPrograms_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1057,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountStaff_Plan\Foreach - New or Updated Fiscal Week\SQL - End DiscountStaff_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1058,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountStaff_Plan\Foreach - New or Updated Fiscal Week\SQL - Start DiscountStaff_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1059,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountStaff_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1060,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountStaff_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1061,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountStaff_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1062,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountSubsidyPctTuitionSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - End DiscountSubsidyPctTuitionSubsidy_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1063,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountSubsidyPctTuitionSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - Start DiscountSubsidyPctTuitionSubsidy_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1064,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountSubsidyPctTuitionSubsidy_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1065,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountSubsidyPctTuitionSubsidy_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1066,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountSubsidyPctTuitionSubsidy_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1067,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - End DiscountSubsidy_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1068,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - Start DiscountSubsidy_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1069,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountSubsidy_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1070,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountSubsidy_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1071,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountSubsidy_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1072,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountTieredTuition_Plan\Foreach - New or Updated Fiscal Week\SQL - End DiscountTieredTuition_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1073,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountTieredTuition_Plan\Foreach - New or Updated Fiscal Week\SQL - Start DiscountTieredTuition_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1074,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountTieredTuition_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1075,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountTieredTuition_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1076,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountTieredTuition_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1077,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountTotalTuitionPctTuition_Plan\Foreach - New or Updated Fiscal Week\SQL - End DiscountTotalTuitionPctTuition_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1078,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountTotalTuitionPctTuition_Plan\Foreach - New or Updated Fiscal Week\SQL - Start DiscountTotalTuitionPctTuition_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1079,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountTotalTuitionPctTuition_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1080,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountTotalTuitionPctTuition_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1081,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountTotalTuitionPctTuition_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1082,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountTotalTuition_Plan\Foreach - New or Updated Fiscal Week\SQL - End DiscountTotalTuition_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1083,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountTotalTuition_Plan\Foreach - New or Updated Fiscal Week\SQL - Start DiscountTotalTuition_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1084,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountTotalTuition_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1085,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountTotalTuition_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1086,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountTotalTuition_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1087,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountTotal_Plan\Foreach - New or Updated Fiscal Week\SQL - End DiscountTotal_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1088,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountTotal_Plan\Foreach - New or Updated Fiscal Week\SQL - Start DiscountTotal_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1089,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountTotal_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1090,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountTotal_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1091,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - DiscountTotal_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1092,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - FeesEducation_Plan\Foreach - New or Updated Fiscal Week\SQL - End FeesEducation_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1093,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - FeesEducation_Plan\Foreach - New or Updated Fiscal Week\SQL - Start FeesEducation_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1094,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - FeesEducation_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1095,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - FeesEducation_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1096,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - FeesEducation_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1097,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - FeesRegistration_Plan\Foreach - New or Updated Fiscal Week\SQL - End FeesRegistration_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1098,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - FeesRegistration_Plan\Foreach - New or Updated Fiscal Week\SQL - Start FeesRegistration_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1099,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - FeesRegistration_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1100,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - FeesRegistration_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1101,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - FeesRegistration_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1102,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - FeesReservation_Plan\Foreach - New or Updated Fiscal Week\SQL - End FeesReservation_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1103,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - FeesReservation_Plan\Foreach - New or Updated Fiscal Week\SQL - Start FeesReservation_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1104,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - FeesReservation_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1105,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - FeesReservation_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1106,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - FeesReservation_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1107,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - FeesRevenue_Plan\Foreach - New or Updated Fiscal Week\SQL - End FeesRevenue_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1108,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - FeesRevenue_Plan\Foreach - New or Updated Fiscal Week\SQL - Start FeesRevenue_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1109,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - FeesRevenue_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1110,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - FeesRevenue_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1111,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - FeesRevenue_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1112,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - LaborSalaryPctNetRevenue_Plan\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryPctNetRevenue_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1113,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - LaborSalaryPctNetRevenue_Plan\Foreach - New or Updated Fiscal Week\SQL - Labor Salary Pct Net Revenue_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1114,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - LaborSalaryPctNetRevenue_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1115,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - LaborSalaryPctNetRevenue_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1116,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - LaborSalaryPctNetRevenue_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1117,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetAverageRatePrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - End NetAverageRatePrivatePay_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1118,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetAverageRatePrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - Start NetAverageRatePrivatePay_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1119,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetAverageRatePrivatePay_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1120,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetAverageRatePrivatePay_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1121,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetAverageRatePrivatePay_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1122,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetAverageRateSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - End NetAverageRateSubsidy_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1123,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetAverageRateSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - Start NetAverageRateSubsidy_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1124,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetAverageRateSubsidy_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1125,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetAverageRateSubsidy_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1126,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetAverageRateSubsidy_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1127,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetAverageRate_Plan\Foreach - New or Updated Fiscal Week\SQL - End NetAverageRate_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1128,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetAverageRate_Plan\Foreach - New or Updated Fiscal Week\SQL - Start NetAverageRate_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1129,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetAverageRate_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1130,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetAverageRate_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1131,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetAverageRate_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1132,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetFees_Plan\Foreach - New or Updated Fiscal Week\SQL - End NetFees_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1133,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetFees_Plan\Foreach - New or Updated Fiscal Week\SQL - Start NetFees_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1134,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetFees_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1135,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetFees_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1136,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetFees_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1137,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetRevenue_Plan\Foreach - New or Updated Fiscal Week\SQL - End NetRevenue_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1138,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetRevenue_Plan\Foreach - New or Updated Fiscal Week\SQL - Start NetRevenue_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1139,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetRevenue_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1140,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetRevenue_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1141,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetRevenue_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1142,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetSpecialPrograms_Plan\Foreach - New or Updated Fiscal Week\SQL - End NetSpecialPrograms_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1143,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetSpecialPrograms_Plan\Foreach - New or Updated Fiscal Week\SQL - Start NetSpecialPrograms_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1144,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetSpecialPrograms_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1145,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetSpecialPrograms_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1146,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetSpecialPrograms_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1147,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetTuitionPrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - End NetTuitionPrivatePay_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1148,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetTuitionPrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - Start NetTuitionPrivatePay_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1149,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetTuitionPrivatePay_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1150,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetTuitionPrivatePay_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1151,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetTuitionPrivatePay_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1152,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetTuitionSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - End NetTuitionSubsidy_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1153,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetTuitionSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - Start NetTuitionSubsidy_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1154,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetTuitionSubsidy_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1155,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetTuitionSubsidy_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1156,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetTuitionSubsidy_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1157,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetTuition_Plan\Foreach - New or Updated Fiscal Week\SQL - End NetTuition_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1158,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetTuition_Plan\Foreach - New or Updated Fiscal Week\SQL - Start NetTuition_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1159,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetTuition_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1160,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetTuition_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1161,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - NetTuition_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1162,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - Recovery_Plan\Foreach - New or Updated Fiscal Week\SQL - End Recovery_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1163,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - Recovery_Plan\Foreach - New or Updated Fiscal Week\SQL - Start Recovery_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1164,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - Recovery_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1165,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - Recovery_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1166,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - Recovery_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1167,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueActivities_Plan\Foreach - New or Updated Fiscal Week\SQL - End RevenueActivities_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1168,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueActivities_Plan\Foreach - New or Updated Fiscal Week\SQL - Start RevenueActivities_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1169,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueActivities_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1170,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueActivities_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1171,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueActivities_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1172,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueEPManagementFee_Plan\Foreach - New or Updated Fiscal Week\SQL - End RevenueEPManagementFee_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1173,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueEPManagementFee_Plan\Foreach - New or Updated Fiscal Week\SQL - Start RevenueEPManagementFee_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1174,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueEPManagementFee_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1175,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueEPManagementFee_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1176,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueEPManagementFee_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1177,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueFieldTrips_Plan\Foreach - New or Updated Fiscal Week\SQL - End RevenueFieldTrips_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1178,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueFieldTrips_Plan\Foreach - New or Updated Fiscal Week\SQL - Start RevenueFieldTrips_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1179,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueFieldTrips_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1180,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueFieldTrips_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1181,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueFieldTrips_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1182,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueHeadStart_Plan\Foreach - New or Updated Fiscal Week\SQL - End RevenueHeadStart_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1183,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueHeadStart_Plan\Foreach - New or Updated Fiscal Week\SQL - Start RevenueHeadStart_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1184,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueHeadStart_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1185,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueHeadStart_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1186,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueHeadStart_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1187,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueKLCStore_Plan\Foreach - New or Updated Fiscal Week\SQL - End RevenueKLCStore_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1188,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueKLCStore_Plan\Foreach - New or Updated Fiscal Week\SQL - Start RevenueKLCStore_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1189,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueKLCStore_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1190,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueKLCStore_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1191,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueKLCStore_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1192,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueLatePayment_Plan\Foreach - New or Updated Fiscal Week\SQL - End RevenueLatePayment_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1193,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueLatePayment_Plan\Foreach - New or Updated Fiscal Week\SQL - Start RevenueLatePayment_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1194,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueLatePayment_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1195,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueLatePayment_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1196,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueLatePayment_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1197,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueLatePickup_Plan\Foreach - New or Updated Fiscal Week\SQL - End RevenueLatePickup_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1198,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueLatePickup_Plan\Foreach - New or Updated Fiscal Week\SQL - Start RevenueLatePickup_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1199,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueLatePickup_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1200,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueLatePickup_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1201,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueLatePickup_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1202,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueMiscandOther_Plan\Foreach - New or Updated Fiscal Week\SQL - End RevenueMiscandOther_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1203,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueMiscandOther_Plan\Foreach - New or Updated Fiscal Week\SQL - Start RevenueMiscandOther_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1204,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueMiscandOther_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1205,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueMiscandOther_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1206,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueMiscandOther_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1207,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueNationalAccounts_Plan\Foreach - New or Updated Fiscal Week\SQL - End RevenueNationalAccounts_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1208,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueNationalAccounts_Plan\Foreach - New or Updated Fiscal Week\SQL - Start RevenueNationalAccounts_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1209,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueNationalAccounts_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1210,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueNationalAccounts_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1211,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueNationalAccounts_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1212,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueOther_Plan\Foreach - New or Updated Fiscal Week\SQL - End RevenueOther_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1213,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueOther_Plan\Foreach - New or Updated Fiscal Week\SQL - Start RevenueOther_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1214,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueOther_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1215,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueOther_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1216,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueOther_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1217,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenuePrimary_Plan\Foreach - New or Updated Fiscal Week\SQL - End RevenuePrimary_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1218,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenuePrimary_Plan\Foreach - New or Updated Fiscal Week\SQL - Start RevenuePrimary_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1219,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenuePrimary_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1220,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenuePrimary_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1221,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenuePrimary_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1222,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueSpecialServices_Plan\Foreach - New or Updated Fiscal Week\SQL - End RevenueSpecialServices_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1223,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueSpecialServices_Plan\Foreach - New or Updated Fiscal Week\SQL - Start RevenueSpecialServices_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1224,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueSpecialServices_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1225,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueSpecialServices_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1226,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - RevenueSpecialServices_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1227,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TotalMiscellaneousIncome_Plan\Foreach - New or Updated Fiscal Week\SQL - End TotalMiscellaneousIncome_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1228,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TotalMiscellaneousIncome_Plan\Foreach - New or Updated Fiscal Week\SQL - Start TotalMiscellaneousIncome_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1229,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TotalMiscellaneousIncome_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1230,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TotalMiscellaneousIncome_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1231,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TotalMiscellaneousIncome_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1232,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TotalNetMiscAndOtherRevenues_Plan\Foreach - New or Updated Fiscal Week\SQL - End TotalNetMiscAndOtherRevenues_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1233,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TotalNetMiscAndOtherRevenues_Plan\Foreach - New or Updated Fiscal Week\SQL - Start TotalNetMiscAndOtherRevenues_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1234,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TotalNetMiscAndOtherRevenues_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1235,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TotalNetMiscAndOtherRevenues_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1236,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TotalNetMiscAndOtherRevenues_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1237,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionAdjustmentsPrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - End TuitionAdjustmentsPrivatePay_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1238,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionAdjustmentsPrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - Start TuitionAdjustmentsPrivatePay_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1239,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionAdjustmentsPrivatePay_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1240,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionAdjustmentsPrivatePay_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1241,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionAdjustmentsPrivatePay_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1242,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionAdjustmentsSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - End TuitionAdjustmentsSubsidy_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1243,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionAdjustmentsSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - Start TuitionAdjustmentsSubsidy_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1244,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionAdjustmentsSubsidy_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1245,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionAdjustmentsSubsidy_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1246,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionAdjustmentsSubsidy_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1247,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionAdjustments_Plan\Foreach - New or Updated Fiscal Week\SQL - End TuitionAdjustments_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1248,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionAdjustments_Plan\Foreach - New or Updated Fiscal Week\SQL - Start TuitionAdjustments_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1249,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionAdjustments_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1250,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionAdjustments_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1251,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionAdjustments_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1252,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionDiscount_Plan\Foreach - New or Updated Fiscal Week\SQL - End TuitionDiscount_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1253,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionDiscount_Plan\Foreach - New or Updated Fiscal Week\SQL - Start TuitionDiscount_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1254,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionDiscount_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1255,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionDiscount_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1256,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionDiscount_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1257,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionFivesPrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - End TuitionFivesPrivatePay_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1258,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionFivesPrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - Start TuitionFivesPrivatePay_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1259,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionFivesPrivatePay_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1260,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionFivesPrivatePay_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1261,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionFivesPrivatePay_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1262,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionFivesSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - End TuitionFivesSubsidy_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1263,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionFivesSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - Start TuitionFivesSubsidy_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1264,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionFivesSubsidy_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1265,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionFivesSubsidy_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1266,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionFivesSubsidy_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1267,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionFives_Plan\Foreach - New or Updated Fiscal Week\SQL - End TuitionFives_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1268,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionFives_Plan\Foreach - New or Updated Fiscal Week\SQL - Start TuitionFives_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1269,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionFives_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1270,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionFives_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1271,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionFives_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1272,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionFoursPrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - End TuitionFoursPrivatePay_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1273,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionFoursPrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - Start TuitionFoursPrivatePay_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1274,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionFoursPrivatePay_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1275,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionFoursPrivatePay_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1276,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionFoursPrivatePay_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1277,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionFoursSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - End TuitionFoursSubsidy_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1278,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionFoursSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - Start TuitionFoursSubsidy_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1279,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionFoursSubsidy_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1280,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionFoursSubsidy_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1281,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionFoursSubsidy_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1282,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionFours_Plan\Foreach - New or Updated Fiscal Week\SQL - End TuitionFours_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1283,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionFours_Plan\Foreach - New or Updated Fiscal Week\SQL - Start TuitionFours_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1284,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionFours_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1285,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionFours_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1286,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionFours_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1287,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionHourlyDropInPP_Plan\Foreach - New or Updated Fiscal Week\SQL - End TuitionHourlyDropInPP_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1288,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionHourlyDropInPP_Plan\Foreach - New or Updated Fiscal Week\SQL - Start TuitionHourlyDropInPP_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1289,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionHourlyDropInPP_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1290,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionHourlyDropInPP_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1291,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionHourlyDropInPP_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1292,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionHourlyDropInSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - End TuitionHourlyDropInSubsidy_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1293,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionHourlyDropInSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - Start TuitionHourlyDropInSubsidy_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1294,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionHourlyDropInSubsidy_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1295,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionHourlyDropInSubsidy_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1296,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionHourlyDropInSubsidy_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1297,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionHourlyDropIn_Plan\Foreach - New or Updated Fiscal Week\SQL - End TuitionHourlyDropIn_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1298,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionHourlyDropIn_Plan\Foreach - New or Updated Fiscal Week\SQL - Start TuitionHourlyDropIn_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1299,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionHourlyDropIn_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1300,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionHourlyDropIn_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1301,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionHourlyDropIn_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1302,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionInfantPrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - End TuitionInfantPrivatePay_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1303,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionInfantPrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - Start TuitionInfantPrivatePay_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1304,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionInfantPrivatePay_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1305,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionInfantPrivatePay_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1306,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionInfantPrivatePay_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1307,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionInfantSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - End TuitionInfantSubsidy_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1308,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionInfantSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - Start TuitionInfantSubsidy_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1309,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionInfantSubsidy_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1310,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionInfantSubsidy_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1311,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionInfantSubsidy_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1312,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionInfant_Plan\Foreach - New or Updated Fiscal Week\SQL - End TuitionInfant_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1313,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionInfant_Plan\Foreach - New or Updated Fiscal Week\SQL - Start TuitionInfant_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1314,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionInfant_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1315,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionInfant_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1316,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionInfant_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1317,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionKindergartenPrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - End TuitionKindergartenPrivatePay_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1318,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionKindergartenPrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - Start TuitionKindergartenPrivatePay_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1319,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionKindergartenPrivatePay_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1320,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionKindergartenPrivatePay_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1321,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionKindergartenPrivatePay_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1322,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionKindergartenSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - End TuitionKindergartenSubsidy_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1323,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionKindergartenSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - Start TuitionKindergartenSubsidy_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1324,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionKindergartenSubsidy_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1325,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionKindergartenSubsidy_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1326,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionKindergartenSubsidy_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1327,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionKindergarten_Plan\Foreach - New or Updated Fiscal Week\SQL - End TuitionKindergarten_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1328,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionKindergarten_Plan\Foreach - New or Updated Fiscal Week\SQL - Start TuitionKindergarten_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1329,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionKindergarten_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1330,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionKindergarten_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1331,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionKindergarten_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1332,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionMultiagePrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - End TuitionMultiagePrivatePay_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1333,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionMultiagePrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - Start TuitionMultiagePrivatePay_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1334,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionMultiagePrivatePay_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1335,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionMultiagePrivatePay_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1336,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionMultiagePrivatePay_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1337,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionMultiageSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - End TuitionMultiageSubsidy_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1338,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionMultiageSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - Start TuitionMultiageSubsidy_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1339,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionMultiageSubsidy_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1340,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionMultiageSubsidy_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1341,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionMultiageSubsidy_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1342,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionMultiage_Plan\Foreach - New or Updated Fiscal Week\SQL - End TuitionMultiage_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1343,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionMultiage_Plan\Foreach - New or Updated Fiscal Week\SQL - Start TuitionMultiage_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1344,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionMultiage_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1345,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionMultiage_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1346,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionMultiage_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1347,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionSchoolagePrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - End TuitionSchoolagePrivatePay_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1348,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionSchoolagePrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - Start TuitionSchoolagePrivatePay_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1349,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionSchoolagePrivatePay_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1350,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionSchoolagePrivatePay_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1351,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionSchoolagePrivatePay_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1352,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionSchoolageSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - End TuitionSchoolageSubsidy_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1353,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionSchoolageSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - Start TuitionSchoolageSubsidy_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1354,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionSchoolageSubsidy_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1355,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionSchoolageSubsidy_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1356,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionSchoolageSubsidy_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1357,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionSchoolage_Plan\Foreach - New or Updated Fiscal Week\SQL - End TuitionSchoolage_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1358,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionSchoolage_Plan\Foreach - New or Updated Fiscal Week\SQL - Start TuitionSchoolage_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1359,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionSchoolage_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1360,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionSchoolage_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1361,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionSchoolage_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1362,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionSpecialPrograms_Plan\Foreach - New or Updated Fiscal Week\SQL - End TuitionSpecialPrograms_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1363,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionSpecialPrograms_Plan\Foreach - New or Updated Fiscal Week\SQL - Start TuitionSpecialPrograms_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1364,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionSpecialPrograms_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1365,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionSpecialPrograms_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1366,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionSpecialPrograms_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1367,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionThreesPrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - End TuitionThreesPrivatePay_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1368,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionThreesPrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - Start TuitionThreesPrivatePay_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1369,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionThreesPrivatePay_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1370,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionThreesPrivatePay_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1371,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionThreesPrivatePay_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1372,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionThreesSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - End TuitionThreesSubsidy_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1373,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionThreesSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - Start TuitionThreesSubsidy_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1374,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionThreesSubsidy_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1375,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionThreesSubsidy_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1376,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionThreesSubsidy_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1377,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionThrees_Plan\Foreach - New or Updated Fiscal Week\SQL - End TuitionThrees_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1378,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionThrees_Plan\Foreach - New or Updated Fiscal Week\SQL - Start TuitionThrees_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1379,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionThrees_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1380,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionThrees_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1381,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionThrees_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1382,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionToddlerPrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - End TuitionToddlerPrivatePay_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1383,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionToddlerPrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - Start TuitionToddlerPrivatePay_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1384,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionToddlerPrivatePay_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1385,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionToddlerPrivatePay_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1386,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionToddlerPrivatePay_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1387,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionToddlerSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - End TuitionToddlerSubsidy_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1388,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionToddlerSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - Start TuitionToddlerSubsidy_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1389,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionToddlerSubsidy_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1390,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionToddlerSubsidy_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1391,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionToddlerSubsidy_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1392,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionToddler_Plan\Foreach - New or Updated Fiscal Week\SQL - End TuitionToddler_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1393,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionToddler_Plan\Foreach - New or Updated Fiscal Week\SQL - Start TuitionToddler_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1394,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionToddler_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1395,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionToddler_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1396,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionToddler_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1397,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionTotalPrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - End TuitionTotalPrivatePay_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1398,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionTotalPrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - Start TuitionTotalPrivatePay_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1399,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionTotalPrivatePay_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1400,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionTotalPrivatePay_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1401,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionTotalPrivatePay_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1402,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionTotalSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - End TuitionTotalSubsidy_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1403,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionTotalSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - Start TuitionTotalSubsidy_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1404,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionTotalSubsidy_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1405,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionTotalSubsidy_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1406,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionTotalSubsidy_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1407,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionTotal_Plan\Foreach - New or Updated Fiscal Week\SQL - End TuitionTotal_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1408,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionTotal_Plan\Foreach - New or Updated Fiscal Week\SQL - Start TuitionTotal_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1409,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionTotal_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1410,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionTotal_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1411,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionTotal_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1412,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionTwosPrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - End TuitionTwosPrivatePay_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1413,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionTwosPrivatePay_Plan\Foreach - New or Updated Fiscal Week\SQL - Start TuitionTwosPrivatePay_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1414,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionTwosPrivatePay_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1415,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionTwosPrivatePay_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1416,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionTwosPrivatePay_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1417,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionTwosSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - End TuitionTwosSubsidy_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1418,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionTwosSubsidy_Plan\Foreach - New or Updated Fiscal Week\SQL - Start TuitionTwosSubsidy_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1419,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionTwosSubsidy_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1420,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionTwosSubsidy_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1421,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionTwosSubsidy_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1422,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionTwos_Plan\Foreach - New or Updated Fiscal Week\SQL - End TuitionTwos_Plan Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1423,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionTwos_Plan\Foreach - New or Updated Fiscal Week\SQL - Start TuitionTwos_Plan Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1424,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionTwos_Plan\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Plan';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1425,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionTwos_Plan\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1426,Package\Seq - GLBalancePlanAllocation_NetRevenue Measures\Seq - TuitionTwos_Plan\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
      AND f.GlMetricTypeKey = 1
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactGLBalancePlanAllocation(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
         AND f.GlMetricTypeKey = 1
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1427,Package\Seq - LaborHours Measures\Reported_LaborHoursRegular_Actual\Foreach - New or Updated Fiscal Week\SQL - End ReportedLaborHoursRegular Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1428,Package\Seq - LaborHours Measures\Reported_LaborHoursRegular_Actual\Foreach - New or Updated Fiscal Week\SQL - Start ReportedLaborHoursRegular Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1429,Package\Seq - LaborHours Measures\Reported_LaborHoursRegular_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1430,Package\Seq - LaborHours Measures\Reported_LaborHoursRegular_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1431,Package\Seq - LaborHours Measures\Reported_LaborHoursRegular_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1432,Package\Seq - LaborHours Measures\Reported_LaborHoursRegular_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1433,Package\Seq - LaborHours Measures\Reported_LaborSalaryRegular_Actual\Foreach - New or Updated Fiscal Week\SQL - End ReportedLaborSalaryRegular Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1434,Package\Seq - LaborHours Measures\Reported_LaborSalaryRegular_Actual\Foreach - New or Updated Fiscal Week\SQL - Start ReportedLaborSalaryRegular Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1435,Package\Seq - LaborHours Measures\Reported_LaborSalaryRegular_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1436,Package\Seq - LaborHours Measures\Reported_LaborSalaryRegular_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1437,Package\Seq - LaborHours Measures\Reported_LaborSalaryRegular_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1438,Package\Seq - LaborHours Measures\Reported_LaborSalaryRegular_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1439,Package\Seq - LaborHours Measures\Reported_Labor_Hours\Foreach - New or Updated Fiscal Week\SQL - End ReportedLaborHours Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1440,Package\Seq - LaborHours Measures\Reported_Labor_Hours\Foreach - New or Updated Fiscal Week\SQL - Start ReportedLaborHours Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1441,Package\Seq - LaborHours Measures\Reported_Labor_Hours\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1442,Package\Seq - LaborHours Measures\Reported_Labor_Hours\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1443,Package\Seq - LaborHours Measures\Reported_Labor_Hours\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1444,Package\Seq - LaborHours Measures\Reported_Labor_Hours\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1445,Package\Seq - LaborHours Measures\Reported_Labor_Salary\Foreach - New or Updated Fiscal Week\SQL - End ReportedLaborSalary Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1446,Package\Seq - LaborHours Measures\Reported_Labor_Salary\Foreach - New or Updated Fiscal Week\SQL - Start ReportedLaborSalary Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1447,Package\Seq - LaborHours Measures\Reported_Labor_Salary\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1448,Package\Seq - LaborHours Measures\Reported_Labor_Salary\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1449,Package\Seq - LaborHours Measures\Reported_Labor_Salary\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1450,Package\Seq - LaborHours Measures\Reported_Labor_Salary\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1451,Package\Seq - LaborHours Measures\Reported_Labor_Salary_Childcare\Foreach - New or Updated Fiscal Week\SQL - End ReportedLaborSalaryChildCare Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1452,Package\Seq - LaborHours Measures\Reported_Labor_Salary_Childcare\Foreach - New or Updated Fiscal Week\SQL - Start ReportedLaborSalaryChildCare Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1453,Package\Seq - LaborHours Measures\Reported_Labor_Salary_Childcare\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1454,Package\Seq - LaborHours Measures\Reported_Labor_Salary_Childcare\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1455,Package\Seq - LaborHours Measures\Reported_Labor_Salary_Childcare\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1456,Package\Seq - LaborHours Measures\Reported_Labor_Salary_Childcare\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1457,Package\Seq - LaborHours Measures\Reported_Labor_Salary_Operating\Foreach - New or Updated Fiscal Week\SQL - End ReportedLaborSalaryOperating Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1458,Package\Seq - LaborHours Measures\Reported_Labor_Salary_Operating\Foreach - New or Updated Fiscal Week\SQL - Start ReportedLaborSalaryOperating Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1459,Package\Seq - LaborHours Measures\Reported_Labor_Salary_Operating\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1460,Package\Seq - LaborHours Measures\Reported_Labor_Salary_Operating\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1461,Package\Seq - LaborHours Measures\Reported_Labor_Salary_Operating\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1462,Package\Seq - LaborHours Measures\Reported_Labor_Salary_Operating\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1463,Package\Seq - LaborHours Measures\Reported_Labor_Salary_Special_Program\Foreach - New or Updated Fiscal Week\SQL - End ReportedLaborSalarySpecialProgram Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1464,Package\Seq - LaborHours Measures\Reported_Labor_Salary_Special_Program\Foreach - New or Updated Fiscal Week\SQL - Start ReportedLaborSalarySpecialProgram Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1465,Package\Seq - LaborHours Measures\Reported_Labor_Salary_Special_Program\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1466,Package\Seq - LaborHours Measures\Reported_Labor_Salary_Special_Program\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1467,Package\Seq - LaborHours Measures\Reported_Labor_Salary_Special_Program\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1468,Package\Seq - LaborHours Measures\Reported_Labor_Salary_Special_Program\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1469,Package\Seq - LaborHours Measures\Reported_Labor_Salary_Training\Foreach - New or Updated Fiscal Week\SQL - End ReportedLaborSalaryTraining Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1470,Package\Seq - LaborHours Measures\Reported_Labor_Salary_Training\Foreach - New or Updated Fiscal Week\SQL - Start ReportedLaborSalaryTraining Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1471,Package\Seq - LaborHours Measures\Reported_Labor_Salary_Training\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1472,Package\Seq - LaborHours Measures\Reported_Labor_Salary_Training\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1473,Package\Seq - LaborHours Measures\Reported_Labor_Salary_Training\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1474,Package\Seq - LaborHours Measures\Reported_Labor_Salary_Training\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1475,Package\Seq - LaborHours Measures\Reported_Salaries_Overtime_Premium\Foreach - New or Updated Fiscal Week\SQL - End ReportedSalariesOvertimePremium Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1476,Package\Seq - LaborHours Measures\Reported_Salaries_Overtime_Premium\Foreach - New or Updated Fiscal Week\SQL - Start ReportedSalariesOvertimePremium Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1477,Package\Seq - LaborHours Measures\Reported_Salaries_Overtime_Premium\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1478,Package\Seq - LaborHours Measures\Reported_Salaries_Overtime_Premium\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1479,Package\Seq - LaborHours Measures\Reported_Salaries_Overtime_Premium\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1480,Package\Seq - LaborHours Measures\Reported_Salaries_Overtime_Premium\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1481,Package\Seq - LaborHours Measures\Reported_Wage_Rate_Base\Foreach - New or Updated Fiscal Week\SQL - End ReportedWageRateBase Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1482,Package\Seq - LaborHours Measures\Reported_Wage_Rate_Base\Foreach - New or Updated Fiscal Week\SQL - Start ReportedWageRateBase Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1483,Package\Seq - LaborHours Measures\Reported_Wage_Rate_Base\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1484,Package\Seq - LaborHours Measures\Reported_Wage_Rate_Base\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1485,Package\Seq - LaborHours Measures\Reported_Wage_Rate_Base\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1486,Package\Seq - LaborHours Measures\Reported_Wage_Rate_Base\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1487,Package\Seq - LaborHours Measures\Seq - LaborHoursChildcareOvertime_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursChildcareOvertime_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1488,Package\Seq - LaborHours Measures\Seq - LaborHoursChildcareOvertime_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursChildcareOvertime_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1489,Package\Seq - LaborHours Measures\Seq - LaborHoursChildcareOvertime_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1490,Package\Seq - LaborHours Measures\Seq - LaborHoursChildcareOvertime_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1491,Package\Seq - LaborHours Measures\Seq - LaborHoursChildcareOvertime_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1492,Package\Seq - LaborHours Measures\Seq - LaborHoursChildcareOvertime_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1493,Package\Seq - LaborHours Measures\Seq - LaborHoursChildcareOvertime_Target\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursChildcareOvertime_Target Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1494,Package\Seq - LaborHours Measures\Seq - LaborHoursChildcareOvertime_Target\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursChildcareOvertime_Target Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1495,Package\Seq - LaborHours Measures\Seq - LaborHoursChildcareOvertime_Target\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Target';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1496,Package\Seq - LaborHours Measures\Seq - LaborHoursChildcareOvertime_Target\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1497,Package\Seq - LaborHours Measures\Seq - LaborHoursChildcareOvertime_Target\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1498,Package\Seq - LaborHours Measures\Seq - LaborHoursChildcareRegular_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursChildcareRegular_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1499,Package\Seq - LaborHours Measures\Seq - LaborHoursChildcareRegular_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursChildcareRegular_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1500,Package\Seq - LaborHours Measures\Seq - LaborHoursChildcareRegular_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1501,Package\Seq - LaborHours Measures\Seq - LaborHoursChildcareRegular_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1502,Package\Seq - LaborHours Measures\Seq - LaborHoursChildcareRegular_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1503,Package\Seq - LaborHours Measures\Seq - LaborHoursChildcareRegular_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1504,Package\Seq - LaborHours Measures\Seq - LaborHoursChildcareRegular_Target\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursChildcareRegular_Target Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1505,Package\Seq - LaborHours Measures\Seq - LaborHoursChildcareRegular_Target\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursChildcareRegular_Target Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1506,Package\Seq - LaborHours Measures\Seq - LaborHoursChildcareRegular_Target\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Target';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1507,Package\Seq - LaborHours Measures\Seq - LaborHoursChildcareRegular_Target\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1508,Package\Seq - LaborHours Measures\Seq - LaborHoursChildcareRegular_Target\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1509,Package\Seq - LaborHours Measures\Seq - LaborHoursChildcare_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursChildcare_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1510,Package\Seq - LaborHours Measures\Seq - LaborHoursChildcare_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursChildcare_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1511,Package\Seq - LaborHours Measures\Seq - LaborHoursChildcare_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1512,Package\Seq - LaborHours Measures\Seq - LaborHoursChildcare_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1513,Package\Seq - LaborHours Measures\Seq - LaborHoursChildcare_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1514,Package\Seq - LaborHours Measures\Seq - LaborHoursChildcare_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1515,Package\Seq - LaborHours Measures\Seq - LaborHoursChildcare_Target\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursChildcare_Target Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1516,Package\Seq - LaborHours Measures\Seq - LaborHoursChildcare_Target\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursChildcare_Target Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1517,Package\Seq - LaborHours Measures\Seq - LaborHoursChildcare_Target\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Target';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1518,Package\Seq - LaborHours Measures\Seq - LaborHoursChildcare_Target\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1519,Package\Seq - LaborHours Measures\Seq - LaborHoursChildcare_Target\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1520,Package\Seq - LaborHours Measures\Seq - LaborHoursManagementAndAdmin_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursManagementAndAdmin_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1521,Package\Seq - LaborHours Measures\Seq - LaborHoursManagementAndAdmin_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursManagementAndAdmin_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1522,Package\Seq - LaborHours Measures\Seq - LaborHoursManagementAndAdmin_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1523,Package\Seq - LaborHours Measures\Seq - LaborHoursManagementAndAdmin_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1524,Package\Seq - LaborHours Measures\Seq - LaborHoursManagementAndAdmin_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1525,Package\Seq - LaborHours Measures\Seq - LaborHoursManagementAndAdmin_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1526,Package\Seq - LaborHours Measures\Seq - LaborHoursManagementAndAdmin_Target\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursManagementAndAdmin_Target Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1527,Package\Seq - LaborHours Measures\Seq - LaborHoursManagementAndAdmin_Target\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursManagementAndAdmin_Target Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1528,Package\Seq - LaborHours Measures\Seq - LaborHoursManagementAndAdmin_Target\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Target';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1529,Package\Seq - LaborHours Measures\Seq - LaborHoursManagementAndAdmin_Target\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1530,Package\Seq - LaborHours Measures\Seq - LaborHoursManagementAndAdmin_Target\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1531,Package\Seq - LaborHours Measures\Seq - LaborHoursOperatingOvertime_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursOperatingOvertime_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1532,Package\Seq - LaborHours Measures\Seq - LaborHoursOperatingOvertime_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursOperatingOvertime_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1533,Package\Seq - LaborHours Measures\Seq - LaborHoursOperatingOvertime_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1534,Package\Seq - LaborHours Measures\Seq - LaborHoursOperatingOvertime_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1535,Package\Seq - LaborHours Measures\Seq - LaborHoursOperatingOvertime_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1536,Package\Seq - LaborHours Measures\Seq - LaborHoursOperatingOvertime_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1537,Package\Seq - LaborHours Measures\Seq - LaborHoursOperatingOvertime_Target\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursOperatingOvertime_Target Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1538,Package\Seq - LaborHours Measures\Seq - LaborHoursOperatingOvertime_Target\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursOperatingOvertime_Target Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1539,Package\Seq - LaborHours Measures\Seq - LaborHoursOperatingOvertime_Target\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Target';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1540,Package\Seq - LaborHours Measures\Seq - LaborHoursOperatingOvertime_Target\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1541,Package\Seq - LaborHours Measures\Seq - LaborHoursOperatingOvertime_Target\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1542,Package\Seq - LaborHours Measures\Seq - LaborHoursOperatingRegular_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursOperatingRegular_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1543,Package\Seq - LaborHours Measures\Seq - LaborHoursOperatingRegular_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursOperatingRegular_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1544,Package\Seq - LaborHours Measures\Seq - LaborHoursOperatingRegular_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1545,Package\Seq - LaborHours Measures\Seq - LaborHoursOperatingRegular_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1546,Package\Seq - LaborHours Measures\Seq - LaborHoursOperatingRegular_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1547,Package\Seq - LaborHours Measures\Seq - LaborHoursOperatingRegular_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1548,Package\Seq - LaborHours Measures\Seq - LaborHoursOperatingRegular_Target\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursOperatingRegular_Target Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1549,Package\Seq - LaborHours Measures\Seq - LaborHoursOperatingRegular_Target\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursOperatingRegular_Target Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1550,Package\Seq - LaborHours Measures\Seq - LaborHoursOperatingRegular_Target\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Target';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1551,Package\Seq - LaborHours Measures\Seq - LaborHoursOperatingRegular_Target\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1552,Package\Seq - LaborHours Measures\Seq - LaborHoursOperatingRegular_Target\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1553,Package\Seq - LaborHours Measures\Seq - LaborHoursOperating_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursOperating_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1554,Package\Seq - LaborHours Measures\Seq - LaborHoursOperating_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursOperating_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1555,Package\Seq - LaborHours Measures\Seq - LaborHoursOperating_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1556,Package\Seq - LaborHours Measures\Seq - LaborHoursOperating_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1557,Package\Seq - LaborHours Measures\Seq - LaborHoursOperating_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1558,Package\Seq - LaborHours Measures\Seq - LaborHoursOperating_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1559,Package\Seq - LaborHours Measures\Seq - LaborHoursOperating_Target\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursOperating_Target Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1560,Package\Seq - LaborHours Measures\Seq - LaborHoursOperating_Target\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursOperating_Target Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1561,Package\Seq - LaborHours Measures\Seq - LaborHoursOperating_Target\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Target';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1562,Package\Seq - LaborHours Measures\Seq - LaborHoursOperating_Target\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1563,Package\Seq - LaborHours Measures\Seq - LaborHoursOperating_Target\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1564,Package\Seq - LaborHours Measures\Seq - LaborHoursOvertime_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursOvertime_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1565,Package\Seq - LaborHours Measures\Seq - LaborHoursOvertime_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursOvertime_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1566,Package\Seq - LaborHours Measures\Seq - LaborHoursOvertime_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1567,Package\Seq - LaborHours Measures\Seq - LaborHoursOvertime_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1568,Package\Seq - LaborHours Measures\Seq - LaborHoursOvertime_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1569,Package\Seq - LaborHours Measures\Seq - LaborHoursOvertime_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1570,Package\Seq - LaborHours Measures\Seq - LaborHoursOvertime_Target\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursOvertime_Target Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1571,Package\Seq - LaborHours Measures\Seq - LaborHoursOvertime_Target\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursOvertime_Target Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1572,Package\Seq - LaborHours Measures\Seq - LaborHoursOvertime_Target\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Target';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1573,Package\Seq - LaborHours Measures\Seq - LaborHoursOvertime_Target\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1574,Package\Seq - LaborHours Measures\Seq - LaborHoursOvertime_Target\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1575,Package\Seq - LaborHours Measures\Seq - LaborHoursPaidTimeOff_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursPaidTimeOff_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1576,Package\Seq - LaborHours Measures\Seq - LaborHoursPaidTimeOff_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursPaidTimeOff_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1577,Package\Seq - LaborHours Measures\Seq - LaborHoursPaidTimeOff_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1578,Package\Seq - LaborHours Measures\Seq - LaborHoursPaidTimeOff_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1579,Package\Seq - LaborHours Measures\Seq - LaborHoursPaidTimeOff_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1580,Package\Seq - LaborHours Measures\Seq - LaborHoursPaidTimeOff_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1581,Package\Seq - LaborHours Measures\Seq - LaborHoursPaidTimeOff_Target\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursPaidTimeOff_Target Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1582,Package\Seq - LaborHours Measures\Seq - LaborHoursPaidTimeOff_Target\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursPaidTimeOff_Target Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1583,Package\Seq - LaborHours Measures\Seq - LaborHoursPaidTimeOff_Target\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Target';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1584,Package\Seq - LaborHours Measures\Seq - LaborHoursPaidTimeOff_Target\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1585,Package\Seq - LaborHours Measures\Seq - LaborHoursPaidTimeOff_Target\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1586,Package\Seq - LaborHours Measures\Seq - LaborHoursRegular_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursRegular_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1587,Package\Seq - LaborHours Measures\Seq - LaborHoursRegular_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursRegular_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1588,Package\Seq - LaborHours Measures\Seq - LaborHoursRegular_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1589,Package\Seq - LaborHours Measures\Seq - LaborHoursRegular_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1590,Package\Seq - LaborHours Measures\Seq - LaborHoursRegular_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1591,Package\Seq - LaborHours Measures\Seq - LaborHoursRegular_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1592,Package\Seq - LaborHours Measures\Seq - LaborHoursSpecialProgramsMemo_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursSpecialProgramsMemo_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1593,Package\Seq - LaborHours Measures\Seq - LaborHoursSpecialProgramsMemo_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursSpecialProgramsMemo_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1594,Package\Seq - LaborHours Measures\Seq - LaborHoursSpecialProgramsMemo_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1595,Package\Seq - LaborHours Measures\Seq - LaborHoursSpecialProgramsMemo_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1596,Package\Seq - LaborHours Measures\Seq - LaborHoursSpecialProgramsMemo_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1597,Package\Seq - LaborHours Measures\Seq - LaborHoursSpecialProgramsMemo_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1598,Package\Seq - LaborHours Measures\Seq - LaborHoursSpecialProgramsMemo_Target\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursSpecialProgramsMemo_Target Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1599,Package\Seq - LaborHours Measures\Seq - LaborHoursSpecialProgramsMemo_Target\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursSpecialProgramsMemo_Target Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1600,Package\Seq - LaborHours Measures\Seq - LaborHoursSpecialProgramsMemo_Target\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Target';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1601,Package\Seq - LaborHours Measures\Seq - LaborHoursSpecialProgramsMemo_Target\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1602,Package\Seq - LaborHours Measures\Seq - LaborHoursSpecialProgramsMemo_Target\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1603,Package\Seq - LaborHours Measures\Seq - LaborHoursSpecialProgramsOvertime_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursSpecialProgramsOvertime_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1604,Package\Seq - LaborHours Measures\Seq - LaborHoursSpecialProgramsOvertime_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursSpecialProgramsOvertime_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1605,Package\Seq - LaborHours Measures\Seq - LaborHoursSpecialProgramsOvertime_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1606,Package\Seq - LaborHours Measures\Seq - LaborHoursSpecialProgramsOvertime_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1607,Package\Seq - LaborHours Measures\Seq - LaborHoursSpecialProgramsOvertime_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1608,Package\Seq - LaborHours Measures\Seq - LaborHoursSpecialProgramsOvertime_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1609,Package\Seq - LaborHours Measures\Seq - LaborHoursSpecialProgramsOvertime_Target\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursSpecialProgramsOvertime_Target Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1610,Package\Seq - LaborHours Measures\Seq - LaborHoursSpecialProgramsOvertime_Target\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursSpecialProgramsOvertime_Target Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1611,Package\Seq - LaborHours Measures\Seq - LaborHoursSpecialProgramsOvertime_Target\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Target';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1612,Package\Seq - LaborHours Measures\Seq - LaborHoursSpecialProgramsOvertime_Target\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1613,Package\Seq - LaborHours Measures\Seq - LaborHoursSpecialProgramsOvertime_Target\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1614,Package\Seq - LaborHours Measures\Seq - LaborHoursSpecialProgramsRegular_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursSpecialProgramsRegular_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1615,Package\Seq - LaborHours Measures\Seq - LaborHoursSpecialProgramsRegular_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursSpecialProgramsRegular_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1616,Package\Seq - LaborHours Measures\Seq - LaborHoursSpecialProgramsRegular_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1617,Package\Seq - LaborHours Measures\Seq - LaborHoursSpecialProgramsRegular_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1618,Package\Seq - LaborHours Measures\Seq - LaborHoursSpecialProgramsRegular_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1619,Package\Seq - LaborHours Measures\Seq - LaborHoursSpecialProgramsRegular_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1620,Package\Seq - LaborHours Measures\Seq - LaborHoursSpecialProgramsRegular_Target\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursSpecialProgramsRegular_Target Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1621,Package\Seq - LaborHours Measures\Seq - LaborHoursSpecialProgramsRegular_Target\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursSpecialProgramsRegular_Target Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1622,Package\Seq - LaborHours Measures\Seq - LaborHoursSpecialProgramsRegular_Target\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Target';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1623,Package\Seq - LaborHours Measures\Seq - LaborHoursSpecialProgramsRegular_Target\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1624,Package\Seq - LaborHours Measures\Seq - LaborHoursSpecialProgramsRegular_Target\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1625,Package\Seq - LaborHours Measures\Seq - LaborHoursTotalDirect_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursTotalDirect_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1626,Package\Seq - LaborHours Measures\Seq - LaborHoursTotalDirect_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursTotalDirect_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1627,Package\Seq - LaborHours Measures\Seq - LaborHoursTotalDirect_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1628,Package\Seq - LaborHours Measures\Seq - LaborHoursTotalDirect_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1629,Package\Seq - LaborHours Measures\Seq - LaborHoursTotalDirect_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1630,Package\Seq - LaborHours Measures\Seq - LaborHoursTotalDirect_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1631,Package\Seq - LaborHours Measures\Seq - LaborHoursTotalDirect_Target\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursTotalDirect_Target Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1632,Package\Seq - LaborHours Measures\Seq - LaborHoursTotalDirect_Target\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursTotalDirect_Target Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1633,Package\Seq - LaborHours Measures\Seq - LaborHoursTotalDirect_Target\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Target';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1634,Package\Seq - LaborHours Measures\Seq - LaborHoursTotalDirect_Target\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1635,Package\Seq - LaborHours Measures\Seq - LaborHoursTotalDirect_Target\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1636,Package\Seq - LaborHours Measures\Seq - LaborHoursTotalFringeBenefits_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursTotalFringeBenefits_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1637,Package\Seq - LaborHours Measures\Seq - LaborHoursTotalFringeBenefits_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursTotalFringeBenefits_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1638,Package\Seq - LaborHours Measures\Seq - LaborHoursTotalFringeBenefits_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1639,Package\Seq - LaborHours Measures\Seq - LaborHoursTotalFringeBenefits_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1640,Package\Seq - LaborHours Measures\Seq - LaborHoursTotalFringeBenefits_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1641,Package\Seq - LaborHours Measures\Seq - LaborHoursTotalFringeBenefits_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1642,Package\Seq - LaborHours Measures\Seq - LaborHoursTotalFringeBenefits_Target\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursTotalFringeBenefits_Target Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1643,Package\Seq - LaborHours Measures\Seq - LaborHoursTotalFringeBenefits_Target\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursTotalFringeBenefits_Target Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1644,Package\Seq - LaborHours Measures\Seq - LaborHoursTotalFringeBenefits_Target\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Target';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1645,Package\Seq - LaborHours Measures\Seq - LaborHoursTotalFringeBenefits_Target\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1646,Package\Seq - LaborHours Measures\Seq - LaborHoursTotalFringeBenefits_Target\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1647,Package\Seq - LaborHours Measures\Seq - LaborHoursTotalSalariesandFringeBenefits_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursTotalSalariesandFringeBenefits_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1648,Package\Seq - LaborHours Measures\Seq - LaborHoursTotalSalariesandFringeBenefits_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursTotalSalariesandFringeBenefits_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1649,Package\Seq - LaborHours Measures\Seq - LaborHoursTotalSalariesandFringeBenefits_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1650,Package\Seq - LaborHours Measures\Seq - LaborHoursTotalSalariesandFringeBenefits_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1651,Package\Seq - LaborHours Measures\Seq - LaborHoursTotalSalariesandFringeBenefits_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1652,Package\Seq - LaborHours Measures\Seq - LaborHoursTotalSalariesandFringeBenefits_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1653,Package\Seq - LaborHours Measures\Seq - LaborHoursTotalSalariesandFringeBenefits_Target\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursTotalSalariesandFringeBenefits_Target Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1654,Package\Seq - LaborHours Measures\Seq - LaborHoursTotalSalariesandFringeBenefits_Target\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursTotalSalariesandFringeBenefits_Target Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1655,Package\Seq - LaborHours Measures\Seq - LaborHoursTotalSalariesandFringeBenefits_Target\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Target';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1656,Package\Seq - LaborHours Measures\Seq - LaborHoursTotalSalariesandFringeBenefits_Target\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1657,Package\Seq - LaborHours Measures\Seq - LaborHoursTotalSalariesandFringeBenefits_Target\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1658,Package\Seq - LaborHours Measures\Seq - LaborHoursTrainingOvertime_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursTrainingOvertime_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1659,Package\Seq - LaborHours Measures\Seq - LaborHoursTrainingOvertime_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursvOvertime_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1660,Package\Seq - LaborHours Measures\Seq - LaborHoursTrainingOvertime_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1661,Package\Seq - LaborHours Measures\Seq - LaborHoursTrainingOvertime_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1662,Package\Seq - LaborHours Measures\Seq - LaborHoursTrainingOvertime_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1663,Package\Seq - LaborHours Measures\Seq - LaborHoursTrainingOvertime_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1664,Package\Seq - LaborHours Measures\Seq - LaborHoursTrainingOvertime_Target\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursTrainingOvertime_Target Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1665,Package\Seq - LaborHours Measures\Seq - LaborHoursTrainingOvertime_Target\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursTrainingOvertime_Target Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1666,Package\Seq - LaborHours Measures\Seq - LaborHoursTrainingOvertime_Target\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Target';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1667,Package\Seq - LaborHours Measures\Seq - LaborHoursTrainingOvertime_Target\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1668,Package\Seq - LaborHours Measures\Seq - LaborHoursTrainingOvertime_Target\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1669,Package\Seq - LaborHours Measures\Seq - LaborHoursTrainingRegular_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursTrainingRegular_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1670,Package\Seq - LaborHours Measures\Seq - LaborHoursTrainingRegular_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursTrainingRegular_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1671,Package\Seq - LaborHours Measures\Seq - LaborHoursTrainingRegular_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1672,Package\Seq - LaborHours Measures\Seq - LaborHoursTrainingRegular_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1673,Package\Seq - LaborHours Measures\Seq - LaborHoursTrainingRegular_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1674,Package\Seq - LaborHours Measures\Seq - LaborHoursTrainingRegular_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1675,Package\Seq - LaborHours Measures\Seq - LaborHoursTrainingRegular_Target\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursTrainingRegular_Target Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1676,Package\Seq - LaborHours Measures\Seq - LaborHoursTrainingRegular_Target\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursTrainingRegular_Target Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1677,Package\Seq - LaborHours Measures\Seq - LaborHoursTrainingRegular_Target\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Target';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1678,Package\Seq - LaborHours Measures\Seq - LaborHoursTrainingRegular_Target\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1679,Package\Seq - LaborHours Measures\Seq - LaborHoursTrainingRegular_Target\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1680,Package\Seq - LaborHours Measures\Seq - LaborHoursTraining_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursTraining_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1681,Package\Seq - LaborHours Measures\Seq - LaborHoursTraining_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursTraining_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1682,Package\Seq - LaborHours Measures\Seq - LaborHoursTraining_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1683,Package\Seq - LaborHours Measures\Seq - LaborHoursTraining_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1684,Package\Seq - LaborHours Measures\Seq - LaborHoursTraining_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1685,Package\Seq - LaborHours Measures\Seq - LaborHoursTraining_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1686,Package\Seq - LaborHours Measures\Seq - LaborHoursTraining_Target\Foreach - New or Updated Fiscal Week\SQL - End LaborHoursTraining_Target Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1687,Package\Seq - LaborHours Measures\Seq - LaborHoursTraining_Target\Foreach - New or Updated Fiscal Week\SQL - Start LaborHoursTraining_Target Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1688,Package\Seq - LaborHours Measures\Seq - LaborHoursTraining_Target\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Target';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1689,Package\Seq - LaborHours Measures\Seq - LaborHoursTraining_Target\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1690,Package\Seq - LaborHours Measures\Seq - LaborHoursTraining_Target\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1691,Package\Seq - LaborHours Measures\Seq - LaborHours_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborHours_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1692,Package\Seq - LaborHours Measures\Seq - LaborHours_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborHours_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1693,Package\Seq - LaborHours Measures\Seq - LaborHours_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1694,Package\Seq - LaborHours Measures\Seq - LaborHours_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1695,Package\Seq - LaborHours Measures\Seq - LaborHours_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1696,Package\Seq - LaborHours Measures\Seq - LaborHours_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1697,Package\Seq - LaborHours Measures\Seq - LaborHours_Target\Foreach - New or Updated Fiscal Week\SQL - End LaborHours_Target Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1698,Package\Seq - LaborHours Measures\Seq - LaborHours_Target\Foreach - New or Updated Fiscal Week\SQL - Start LaborHours_Target Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1699,Package\Seq - LaborHours Measures\Seq - LaborHours_Target\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Target';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1700,Package\Seq - LaborHours Measures\Seq - LaborHours_Target\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1701,Package\Seq - LaborHours Measures\Seq - LaborHours_Target\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1702,Package\Seq - LaborHours Measures\Seq - LaborSalaryChildcareOvertime_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryChildcareOvertime_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1703,Package\Seq - LaborHours Measures\Seq - LaborSalaryChildcareOvertime_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalaryChildcareOvertime_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1704,Package\Seq - LaborHours Measures\Seq - LaborSalaryChildcareOvertime_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1705,Package\Seq - LaborHours Measures\Seq - LaborSalaryChildcareOvertime_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1706,Package\Seq - LaborHours Measures\Seq - LaborSalaryChildcareOvertime_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1707,Package\Seq - LaborHours Measures\Seq - LaborSalaryChildcareOvertime_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1708,Package\Seq - LaborHours Measures\Seq - LaborSalaryChildcare_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryChildcare_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1709,Package\Seq - LaborHours Measures\Seq - LaborSalaryChildcare_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalaryChildcare_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1710,Package\Seq - LaborHours Measures\Seq - LaborSalaryChildcare_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1711,Package\Seq - LaborHours Measures\Seq - LaborSalaryChildcare_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1712,Package\Seq - LaborHours Measures\Seq - LaborSalaryChildcare_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1713,Package\Seq - LaborHours Measures\Seq - LaborSalaryChildcare_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1714,Package\Seq - LaborHours Measures\Seq - LaborSalaryManagementAndAdmin_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryManagementAndAdmin_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1715,Package\Seq - LaborHours Measures\Seq - LaborSalaryManagementAndAdmin_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalaryManagementAndAdmin_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1716,Package\Seq - LaborHours Measures\Seq - LaborSalaryManagementAndAdmin_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1717,Package\Seq - LaborHours Measures\Seq - LaborSalaryManagementAndAdmin_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1718,Package\Seq - LaborHours Measures\Seq - LaborSalaryManagementAndAdmin_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1719,Package\Seq - LaborHours Measures\Seq - LaborSalaryManagementAndAdmin_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1720,Package\Seq - LaborHours Measures\Seq - LaborSalaryOperatingOvertime_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryOperatingOvertime_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1721,Package\Seq - LaborHours Measures\Seq - LaborSalaryOperatingOvertime_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalaryOperatingOvertime_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1722,Package\Seq - LaborHours Measures\Seq - LaborSalaryOperatingOvertime_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1723,Package\Seq - LaborHours Measures\Seq - LaborSalaryOperatingOvertime_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1724,Package\Seq - LaborHours Measures\Seq - LaborSalaryOperatingOvertime_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1725,Package\Seq - LaborHours Measures\Seq - LaborSalaryOperatingOvertime_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1726,Package\Seq - LaborHours Measures\Seq - LaborSalaryOperatingRegular_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryOperatingRegular_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1727,Package\Seq - LaborHours Measures\Seq - LaborSalaryOperatingRegular_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalaryOperatingRegular_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1728,Package\Seq - LaborHours Measures\Seq - LaborSalaryOperatingRegular_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1729,Package\Seq - LaborHours Measures\Seq - LaborSalaryOperatingRegular_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1730,Package\Seq - LaborHours Measures\Seq - LaborSalaryOperatingRegular_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1731,Package\Seq - LaborHours Measures\Seq - LaborSalaryOperatingRegular_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1732,Package\Seq - LaborHours Measures\Seq - LaborSalaryOperating_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryOperating_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1733,Package\Seq - LaborHours Measures\Seq - LaborSalaryOperating_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalaryOperating_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1734,Package\Seq - LaborHours Measures\Seq - LaborSalaryOperating_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1735,Package\Seq - LaborHours Measures\Seq - LaborSalaryOperating_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1736,Package\Seq - LaborHours Measures\Seq - LaborSalaryOperating_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1737,Package\Seq - LaborHours Measures\Seq - LaborSalaryOperating_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1738,Package\Seq - LaborHours Measures\Seq - LaborSalarySpecialProgramsOvertime_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborSalarySpecialProgramsOvertime_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1739,Package\Seq - LaborHours Measures\Seq - LaborSalarySpecialProgramsOvertime_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalarySpecialProgramsOvertime_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1740,Package\Seq - LaborHours Measures\Seq - LaborSalarySpecialProgramsOvertime_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1741,Package\Seq - LaborHours Measures\Seq - LaborSalarySpecialProgramsOvertime_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1742,Package\Seq - LaborHours Measures\Seq - LaborSalarySpecialProgramsOvertime_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1743,Package\Seq - LaborHours Measures\Seq - LaborSalarySpecialProgramsOvertime_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1744,Package\Seq - LaborHours Measures\Seq - LaborSalarySpecialProgramsRegular_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborSalarySpecialProgramsRegular_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1745,Package\Seq - LaborHours Measures\Seq - LaborSalarySpecialProgramsRegular_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalarySpecialProgramsRegular_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1746,Package\Seq - LaborHours Measures\Seq - LaborSalarySpecialProgramsRegular_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1747,Package\Seq - LaborHours Measures\Seq - LaborSalarySpecialProgramsRegular_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1748,Package\Seq - LaborHours Measures\Seq - LaborSalarySpecialProgramsRegular_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1749,Package\Seq - LaborHours Measures\Seq - LaborSalarySpecialProgramsRegular_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1750,Package\Seq - LaborHours Measures\Seq - LaborSalarySpecialPrograms_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborSalarySpecialPrograms_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1751,Package\Seq - LaborHours Measures\Seq - LaborSalarySpecialPrograms_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalarySpecialPrograms_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1752,Package\Seq - LaborHours Measures\Seq - LaborSalarySpecialPrograms_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1753,Package\Seq - LaborHours Measures\Seq - LaborSalarySpecialPrograms_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1754,Package\Seq - LaborHours Measures\Seq - LaborSalarySpecialPrograms_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1755,Package\Seq - LaborHours Measures\Seq - LaborSalarySpecialPrograms_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1756,Package\Seq - LaborHours Measures\Seq - LaborSalaryTotalDirect_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryTotalDirect_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1757,Package\Seq - LaborHours Measures\Seq - LaborSalaryTotalDirect_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalaryTotalDirect_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1758,Package\Seq - LaborHours Measures\Seq - LaborSalaryTotalDirect_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1759,Package\Seq - LaborHours Measures\Seq - LaborSalaryTotalDirect_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1760,Package\Seq - LaborHours Measures\Seq - LaborSalaryTotalDirect_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1761,Package\Seq - LaborHours Measures\Seq - LaborSalaryTotalDirect_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1762,Package\Seq - LaborHours Measures\Seq - LaborSalaryTotalFringeBenefits_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryTotalFringeBenefits_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1763,Package\Seq - LaborHours Measures\Seq - LaborSalaryTotalFringeBenefits_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalaryTotalFringeBenefits_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1764,Package\Seq - LaborHours Measures\Seq - LaborSalaryTotalFringeBenefits_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1765,Package\Seq - LaborHours Measures\Seq - LaborSalaryTotalFringeBenefits_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1766,Package\Seq - LaborHours Measures\Seq - LaborSalaryTotalFringeBenefits_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1767,Package\Seq - LaborHours Measures\Seq - LaborSalaryTotalFringeBenefits_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1768,Package\Seq - LaborHours Measures\Seq - LaborSalaryTotalSalariesandFringeBenefits_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryTotalSalariesandFringeBenefits_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1769,Package\Seq - LaborHours Measures\Seq - LaborSalaryTotalSalariesandFringeBenefits_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalaryTotalSalariesandFringeBenefits_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1770,Package\Seq - LaborHours Measures\Seq - LaborSalaryTotalSalariesandFringeBenefits_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1771,Package\Seq - LaborHours Measures\Seq - LaborSalaryTotalSalariesandFringeBenefits_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1772,Package\Seq - LaborHours Measures\Seq - LaborSalaryTotalSalariesandFringeBenefits_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1773,Package\Seq - LaborHours Measures\Seq - LaborSalaryTotalSalariesandFringeBenefits_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1774,Package\Seq - LaborHours Measures\Seq - LaborSalaryTrainingOvertime_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryTrainingOvertime_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1775,Package\Seq - LaborHours Measures\Seq - LaborSalaryTrainingOvertime_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalaryTrainingOvertime_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1776,Package\Seq - LaborHours Measures\Seq - LaborSalaryTrainingOvertime_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1777,Package\Seq - LaborHours Measures\Seq - LaborSalaryTrainingOvertime_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1778,Package\Seq - LaborHours Measures\Seq - LaborSalaryTrainingOvertime_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1779,Package\Seq - LaborHours Measures\Seq - LaborSalaryTrainingOvertime_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1780,Package\Seq - LaborHours Measures\Seq - LaborSalaryTrainingRegular_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryTrainingRegular_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1781,Package\Seq - LaborHours Measures\Seq - LaborSalaryTrainingRegular_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalaryTrainingRegular_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1782,Package\Seq - LaborHours Measures\Seq - LaborSalaryTrainingRegular_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1783,Package\Seq - LaborHours Measures\Seq - LaborSalaryTrainingRegular_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1784,Package\Seq - LaborHours Measures\Seq - LaborSalaryTrainingRegular_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1785,Package\Seq - LaborHours Measures\Seq - LaborSalaryTrainingRegular_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1786,Package\Seq - LaborHours Measures\Seq - LaborSalaryTraining_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryTraining_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1787,Package\Seq - LaborHours Measures\Seq - LaborSalaryTraining_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalaryTraining_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1788,Package\Seq - LaborHours Measures\Seq - LaborSalaryTraining_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1789,Package\Seq - LaborHours Measures\Seq - LaborSalaryTraining_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1790,Package\Seq - LaborHours Measures\Seq - LaborSalaryTraining_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1791,Package\Seq - LaborHours Measures\Seq - LaborSalaryTraining_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1792,Package\Seq - LaborHours Measures\Seq - ReportedLaborHoursChildcareOvertime_Actual\Foreach - New or Updated Fiscal Week\SQL - End ReportedLaborHoursChildcareOvertime_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1793,Package\Seq - LaborHours Measures\Seq - ReportedLaborHoursChildcareOvertime_Actual\Foreach - New or Updated Fiscal Week\SQL - Start ReportedLaborHoursChildcareOvertime_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1794,Package\Seq - LaborHours Measures\Seq - ReportedLaborHoursChildcareOvertime_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1795,Package\Seq - LaborHours Measures\Seq - ReportedLaborHoursChildcareOvertime_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1796,Package\Seq - LaborHours Measures\Seq - ReportedLaborHoursChildcareOvertime_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1797,Package\Seq - LaborHours Measures\Seq - ReportedLaborHoursChildcareOvertime_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1798,Package\Seq - LaborHours Measures\Seq - ReportedLaborHoursChildcareRegular_Actual\Foreach - New or Updated Fiscal Week\SQL - End ReportedLaborHoursChildcareRegular_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1799,Package\Seq - LaborHours Measures\Seq - ReportedLaborHoursChildcareRegular_Actual\Foreach - New or Updated Fiscal Week\SQL - Start ReportedLaborHoursChildcareRegular_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1800,Package\Seq - LaborHours Measures\Seq - ReportedLaborHoursChildcareRegular_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1801,Package\Seq - LaborHours Measures\Seq - ReportedLaborHoursChildcareRegular_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1802,Package\Seq - LaborHours Measures\Seq - ReportedLaborHoursChildcareRegular_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1803,Package\Seq - LaborHours Measures\Seq - ReportedLaborHoursChildcareRegular_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1804,Package\Seq - LaborHours Measures\Seq - ReportedLaborHoursChildcare_Target\Foreach - New or Updated Fiscal Week\SQL - End ReportedLaborHoursChildcare_Target Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1805,Package\Seq - LaborHours Measures\Seq - ReportedLaborHoursChildcare_Target\Foreach - New or Updated Fiscal Week\SQL - Start ReportedLaborHoursChildcare_Target Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1806,Package\Seq - LaborHours Measures\Seq - ReportedLaborHoursChildcare_Target\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Target';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1807,Package\Seq - LaborHours Measures\Seq - ReportedLaborHoursChildcare_Target\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1808,Package\Seq - LaborHours Measures\Seq - ReportedLaborHoursChildcare_Target\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1809,Package\Seq - LaborHours Measures\Seq - ReportedLaborHoursOperatingOvertime_Actual\Foreach - New or Updated Fiscal Week\SQL - End ReportedLaborHoursOperatingOvertime_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1810,Package\Seq - LaborHours Measures\Seq - ReportedLaborHoursOperatingOvertime_Actual\Foreach - New or Updated Fiscal Week\SQL - Start ReportedLaborHoursOperatingOvertime_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1811,Package\Seq - LaborHours Measures\Seq - ReportedLaborHoursOperatingOvertime_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1812,Package\Seq - LaborHours Measures\Seq - ReportedLaborHoursOperatingOvertime_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1813,Package\Seq - LaborHours Measures\Seq - ReportedLaborHoursOperatingOvertime_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1814,Package\Seq - LaborHours Measures\Seq - ReportedLaborHoursOperatingOvertime_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1815,Package\Seq - LaborHours Measures\Seq - ReportedLaborHoursOperatingRegular_Actual\Foreach - New or Updated Fiscal Week\SQL - End ReportedLaborHoursOperatingRegular_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1816,Package\Seq - LaborHours Measures\Seq - ReportedLaborHoursOperatingRegular_Actual\Foreach - New or Updated Fiscal Week\SQL - Start ReportedLaborHoursOperatingRegular_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1817,Package\Seq - LaborHours Measures\Seq - ReportedLaborHoursOperatingRegular_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1818,Package\Seq - LaborHours Measures\Seq - ReportedLaborHoursOperatingRegular_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1819,Package\Seq - LaborHours Measures\Seq - ReportedLaborHoursOperatingRegular_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1820,Package\Seq - LaborHours Measures\Seq - ReportedLaborHoursOperatingRegular_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1821,Package\Seq - LaborHours Measures\Seq - ReportedLaborHoursOperating_Actual\Foreach - New or Updated Fiscal Week\SQL - End ReportedLaborHoursOperating_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1822,Package\Seq - LaborHours Measures\Seq - ReportedLaborHoursOperating_Actual\Foreach - New or Updated Fiscal Week\SQL - Start ReportedLaborHoursOperating_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1823,Package\Seq - LaborHours Measures\Seq - ReportedLaborHoursOperating_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1824,Package\Seq - LaborHours Measures\Seq - ReportedLaborHoursOperating_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1825,Package\Seq - LaborHours Measures\Seq - ReportedLaborHoursOperating_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1826,Package\Seq - LaborHours Measures\Seq - ReportedLaborHoursOperating_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1827,Package\Seq - LaborHours Measures\Seq - ReportedLaborHoursRegular_Target\Foreach - New or Updated Fiscal Week\SQL - End ReportedLaborHoursRegular_Target Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1828,Package\Seq - LaborHours Measures\Seq - ReportedLaborHoursRegular_Target\Foreach - New or Updated Fiscal Week\SQL - Start ReportedLaborHoursRegular_Target Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1829,Package\Seq - LaborHours Measures\Seq - ReportedLaborHoursRegular_Target\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Target';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1830,Package\Seq - LaborHours Measures\Seq - ReportedLaborHoursRegular_Target\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1831,Package\Seq - LaborHours Measures\Seq - ReportedLaborHoursRegular_Target\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1832,Package\Seq - LaborHours Measures\Seq - ReportedLaborHours_Target\Foreach - New or Updated Fiscal Week\SQL - End ReportedLaborHours_Target Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1833,Package\Seq - LaborHours Measures\Seq - ReportedLaborHours_Target\Foreach - New or Updated Fiscal Week\SQL - Start ReportedLaborHours_Target Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1834,Package\Seq - LaborHours Measures\Seq - ReportedLaborHours_Target\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Target';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1835,Package\Seq - LaborHours Measures\Seq - ReportedLaborHours_Target\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1836,Package\Seq - LaborHours Measures\Seq - ReportedLaborHours_Target\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1837,Package\Seq - LaborHours Measures\Seq - ReportedLaborSalaryChildcareRegular_Actual\Foreach - New or Updated Fiscal Week\SQL - End ReportedLaborSalaryChildcareRegular_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1838,Package\Seq - LaborHours Measures\Seq - ReportedLaborSalaryChildcareRegular_Actual\Foreach - New or Updated Fiscal Week\SQL - Start ReportedLaborSalaryChildcareRegular_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1839,Package\Seq - LaborHours Measures\Seq - ReportedLaborSalaryChildcareRegular_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1840,Package\Seq - LaborHours Measures\Seq - ReportedLaborSalaryChildcareRegular_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1841,Package\Seq - LaborHours Measures\Seq - ReportedLaborSalaryChildcareRegular_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1842,Package\Seq - LaborHours Measures\Seq - ReportedLaborSalaryChildcareRegular_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1843,Package\Seq - LaborHours Measures\Seq - Reported_Labor_Hours_Childcare\Foreach - New or Updated Fiscal Week\SQL - End ReportedLaborHoursChildCare Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1844,Package\Seq - LaborHours Measures\Seq - Reported_Labor_Hours_Childcare\Foreach - New or Updated Fiscal Week\SQL - Start ReportedLaborHoursChildCare Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1845,Package\Seq - LaborHours Measures\Seq - Reported_Labor_Hours_Childcare\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1846,Package\Seq - LaborHours Measures\Seq - Reported_Labor_Hours_Childcare\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1847,Package\Seq - LaborHours Measures\Seq - Reported_Labor_Hours_Childcare\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1848,Package\Seq - LaborHours Measures\Seq - Reported_Labor_Hours_Childcare\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1849,Package\Seq - LaborHours Measures\Seq - TargetStaffEfficiencyFactor_Actual\Foreach - New or Updated Fiscal Week\SQL - End TargetStaffEfficiencyFactor_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1850,Package\Seq - LaborHours Measures\Seq - TargetStaffEfficiencyFactor_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TargetStaffEfficiencyFactor_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1851,Package\Seq - LaborHours Measures\Seq - TargetStaffEfficiencyFactor_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1852,Package\Seq - LaborHours Measures\Seq - TargetStaffEfficiencyFactor_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1853,Package\Seq - LaborHours Measures\Seq - TargetStaffEfficiencyFactor_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1854,Package\Seq - LaborHours Measures\Seq - TargetStaffEfficiencyFactor_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1855,Package\Seq - LaborHours Measures\Seq - TargetStaffEfficiencyFactor_Target\Foreach - New or Updated Fiscal Week\SQL - End TargetStaffEfficiencyFactor_Target Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1856,Package\Seq - LaborHours Measures\Seq - TargetStaffEfficiencyFactor_Target\Foreach - New or Updated Fiscal Week\SQL - Start TargetStaffEfficiencyFactor_Target Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1857,Package\Seq - LaborHours Measures\Seq - TargetStaffEfficiencyFactor_Target\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Target';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1858,Package\Seq - LaborHours Measures\Seq - TargetStaffEfficiencyFactor_Target\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1859,Package\Seq - LaborHours Measures\Seq - TargetStaffEfficiencyFactor_Target\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1860,Package\Seq - LaborHours Measures\Seq - TotalLaborHours_Actual\Foreach - New or Updated Fiscal Week\SQL - End TotalLaborHours_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1861,Package\Seq - LaborHours Measures\Seq - TotalLaborHours_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TotalLaborHours_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1862,Package\Seq - LaborHours Measures\Seq - TotalLaborHours_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1863,Package\Seq - LaborHours Measures\Seq - TotalLaborHours_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1864,Package\Seq - LaborHours Measures\Seq - TotalLaborHours_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1865,Package\Seq - LaborHours Measures\Seq - TotalLaborHours_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1866,Package\Seq - LaborHours Measures\Seq - TotalLaborHours_Target\Foreach - New or Updated Fiscal Week\SQL - End TotalLaborHours_Target Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1867,Package\Seq - LaborHours Measures\Seq - TotalLaborHours_Target\Foreach - New or Updated Fiscal Week\SQL - Start TotalLaborHours_Target Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1868,Package\Seq - LaborHours Measures\Seq - TotalLaborHours_Target\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Target';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1869,Package\Seq - LaborHours Measures\Seq - TotalLaborHours_Target\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1870,Package\Seq - LaborHours Measures\Seq - TotalLaborHours_Target\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1871,Package\Seq - LaborHours Measures\Seq - TotalLaborSalaries_Actual\Foreach - New or Updated Fiscal Week\SQL - End TotalLaborSalaries_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1872,Package\Seq - LaborHours Measures\Seq - TotalLaborSalaries_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TotalLaborSalaries_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1873,Package\Seq - LaborHours Measures\Seq - TotalLaborSalaries_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1874,Package\Seq - LaborHours Measures\Seq - TotalLaborSalaries_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1875,Package\Seq - LaborHours Measures\Seq - TotalLaborSalaries_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1876,Package\Seq - LaborHours Measures\Seq - TotalLaborSalaries_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborHour(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1877,Package\Seq - LaborSalary Measures\Seq - LaborSalaryChildcareOvertime_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryChildcareOvertime_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1878,Package\Seq - LaborSalary Measures\Seq - LaborSalaryChildcareOvertime_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalaryChildcareOvertime_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1879,Package\Seq - LaborSalary Measures\Seq - LaborSalaryChildcareOvertime_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1880,Package\Seq - LaborSalary Measures\Seq - LaborSalaryChildcareOvertime_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1881,Package\Seq - LaborSalary Measures\Seq - LaborSalaryChildcareOvertime_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1882,Package\Seq - LaborSalary Measures\Seq - LaborSalaryChildcareOvertime_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborSalary(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborSalary(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1883,Package\Seq - LaborSalary Measures\Seq - LaborSalaryChildcare_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryChildcare_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1884,Package\Seq - LaborSalary Measures\Seq - LaborSalaryChildcare_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalaryChildcare_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1885,Package\Seq - LaborSalary Measures\Seq - LaborSalaryChildcare_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1886,Package\Seq - LaborSalary Measures\Seq - LaborSalaryChildcare_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1887,Package\Seq - LaborSalary Measures\Seq - LaborSalaryChildcare_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1888,Package\Seq - LaborSalary Measures\Seq - LaborSalaryChildcare_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborSalary(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborSalary(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1889,Package\Seq - LaborSalary Measures\Seq - LaborSalaryManagementAndAdmin_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryManagementAndAdmin_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1890,Package\Seq - LaborSalary Measures\Seq - LaborSalaryManagementAndAdmin_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalaryManagementAndAdmin_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1891,Package\Seq - LaborSalary Measures\Seq - LaborSalaryManagementAndAdmin_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1892,Package\Seq - LaborSalary Measures\Seq - LaborSalaryManagementAndAdmin_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1893,Package\Seq - LaborSalary Measures\Seq - LaborSalaryManagementAndAdmin_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1894,Package\Seq - LaborSalary Measures\Seq - LaborSalaryManagementAndAdmin_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborSalary(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborSalary(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1895,Package\Seq - LaborSalary Measures\Seq - LaborSalaryOperatingOvertime_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryOperatingOvertime_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1896,Package\Seq - LaborSalary Measures\Seq - LaborSalaryOperatingOvertime_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalaryOperatingOvertime_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1897,Package\Seq - LaborSalary Measures\Seq - LaborSalaryOperatingOvertime_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1898,Package\Seq - LaborSalary Measures\Seq - LaborSalaryOperatingOvertime_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1899,Package\Seq - LaborSalary Measures\Seq - LaborSalaryOperatingOvertime_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1900,Package\Seq - LaborSalary Measures\Seq - LaborSalaryOperatingOvertime_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborSalary(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborSalary(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1901,Package\Seq - LaborSalary Measures\Seq - LaborSalaryOperatingRegular_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryOperatingRegular_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1902,Package\Seq - LaborSalary Measures\Seq - LaborSalaryOperatingRegular_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalaryOperatingRegular_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1903,Package\Seq - LaborSalary Measures\Seq - LaborSalaryOperatingRegular_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1904,Package\Seq - LaborSalary Measures\Seq - LaborSalaryOperatingRegular_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1905,Package\Seq - LaborSalary Measures\Seq - LaborSalaryOperatingRegular_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1906,Package\Seq - LaborSalary Measures\Seq - LaborSalaryOperatingRegular_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborSalary(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborSalary(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1907,Package\Seq - LaborSalary Measures\Seq - LaborSalaryOperating_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryOperating_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1908,Package\Seq - LaborSalary Measures\Seq - LaborSalaryOperating_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalaryOperating_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1909,Package\Seq - LaborSalary Measures\Seq - LaborSalaryOperating_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1910,Package\Seq - LaborSalary Measures\Seq - LaborSalaryOperating_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1911,Package\Seq - LaborSalary Measures\Seq - LaborSalaryOperating_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1912,Package\Seq - LaborSalary Measures\Seq - LaborSalaryOperating_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborSalary(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborSalary(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1913,Package\Seq - LaborSalary Measures\Seq - LaborSalaryOvertime_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryOvertime_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1914,Package\Seq - LaborSalary Measures\Seq - LaborSalaryOvertime_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalaryOvertime_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1915,Package\Seq - LaborSalary Measures\Seq - LaborSalaryOvertime_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1916,Package\Seq - LaborSalary Measures\Seq - LaborSalaryOvertime_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1917,Package\Seq - LaborSalary Measures\Seq - LaborSalaryOvertime_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1918,Package\Seq - LaborSalary Measures\Seq - LaborSalaryOvertime_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborSalary(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborSalary(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1919,Package\Seq - LaborSalary Measures\Seq - LaborSalaryPaidTimeOff_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryPaidTimeOff_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1920,Package\Seq - LaborSalary Measures\Seq - LaborSalaryPaidTimeOff_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalaryPaidTimeOff_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1921,Package\Seq - LaborSalary Measures\Seq - LaborSalaryPaidTimeOff_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1922,Package\Seq - LaborSalary Measures\Seq - LaborSalaryPaidTimeOff_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1923,Package\Seq - LaborSalary Measures\Seq - LaborSalaryPaidTimeOff_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1924,Package\Seq - LaborSalary Measures\Seq - LaborSalaryPaidTimeOff_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborSalary(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborSalary(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1925,Package\Seq - LaborSalary Measures\Seq - LaborSalaryRegular_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryOvertime_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1926,Package\Seq - LaborSalary Measures\Seq - LaborSalaryRegular_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalaryRegular_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1927,Package\Seq - LaborSalary Measures\Seq - LaborSalaryRegular_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1928,Package\Seq - LaborSalary Measures\Seq - LaborSalaryRegular_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1929,Package\Seq - LaborSalary Measures\Seq - LaborSalaryRegular_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1930,Package\Seq - LaborSalary Measures\Seq - LaborSalaryRegular_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborSalary(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborSalary(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1931,Package\Seq - LaborSalary Measures\Seq - LaborSalarySpecialProgramsOvertime_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborSalarySpecialProgramsOvertime_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1932,Package\Seq - LaborSalary Measures\Seq - LaborSalarySpecialProgramsOvertime_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalarySpecialProgramsOvertime_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1933,Package\Seq - LaborSalary Measures\Seq - LaborSalarySpecialProgramsOvertime_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1934,Package\Seq - LaborSalary Measures\Seq - LaborSalarySpecialProgramsOvertime_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1935,Package\Seq - LaborSalary Measures\Seq - LaborSalarySpecialProgramsOvertime_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1936,Package\Seq - LaborSalary Measures\Seq - LaborSalarySpecialProgramsOvertime_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborSalary(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborSalary(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1937,Package\Seq - LaborSalary Measures\Seq - LaborSalarySpecialProgramsRegular_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborSalarySpecialProgramsRegular_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1938,Package\Seq - LaborSalary Measures\Seq - LaborSalarySpecialProgramsRegular_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalarySpecialProgramsRegular_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1939,Package\Seq - LaborSalary Measures\Seq - LaborSalarySpecialProgramsRegular_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1940,Package\Seq - LaborSalary Measures\Seq - LaborSalarySpecialProgramsRegular_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1941,Package\Seq - LaborSalary Measures\Seq - LaborSalarySpecialProgramsRegular_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1942,Package\Seq - LaborSalary Measures\Seq - LaborSalarySpecialProgramsRegular_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborSalary(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborSalary(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1943,Package\Seq - LaborSalary Measures\Seq - LaborSalarySpecialPrograms_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborSalarySpecialPrograms_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1944,Package\Seq - LaborSalary Measures\Seq - LaborSalarySpecialPrograms_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalarySpecialPrograms_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1945,Package\Seq - LaborSalary Measures\Seq - LaborSalarySpecialPrograms_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1946,Package\Seq - LaborSalary Measures\Seq - LaborSalarySpecialPrograms_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1947,Package\Seq - LaborSalary Measures\Seq - LaborSalarySpecialPrograms_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1948,Package\Seq - LaborSalary Measures\Seq - LaborSalarySpecialPrograms_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborSalary(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborSalary(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1949,Package\Seq - LaborSalary Measures\Seq - LaborSalaryTrainingOvertime_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryTrainingOvertime_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1950,Package\Seq - LaborSalary Measures\Seq - LaborSalaryTrainingOvertime_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalaryTrainingOvertime_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1951,Package\Seq - LaborSalary Measures\Seq - LaborSalaryTrainingOvertime_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1952,Package\Seq - LaborSalary Measures\Seq - LaborSalaryTrainingOvertime_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1953,Package\Seq - LaborSalary Measures\Seq - LaborSalaryTrainingOvertime_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1954,Package\Seq - LaborSalary Measures\Seq - LaborSalaryTrainingOvertime_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborSalary(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborSalary(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1955,Package\Seq - LaborSalary Measures\Seq - LaborSalaryTrainingRegular_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryTrainingRegular_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1956,Package\Seq - LaborSalary Measures\Seq - LaborSalaryTrainingRegular_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalaryTrainingRegular_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1957,Package\Seq - LaborSalary Measures\Seq - LaborSalaryTrainingRegular_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1958,Package\Seq - LaborSalary Measures\Seq - LaborSalaryTrainingRegular_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1959,Package\Seq - LaborSalary Measures\Seq - LaborSalaryTrainingRegular_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1960,Package\Seq - LaborSalary Measures\Seq - LaborSalaryTrainingRegular_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborSalary(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborSalary(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1961,Package\Seq - LaborSalary Measures\Seq - LaborSalaryTraining_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryTraining_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1962,Package\Seq - LaborSalary Measures\Seq - LaborSalaryTraining_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalaryTraining_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1963,Package\Seq - LaborSalary Measures\Seq - LaborSalaryTraining_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1964,Package\Seq - LaborSalary Measures\Seq - LaborSalaryTraining_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1965,Package\Seq - LaborSalary Measures\Seq - LaborSalaryTraining_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1966,Package\Seq - LaborSalary Measures\Seq - LaborSalaryTraining_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborSalary(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborSalary(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1967,Package\Seq - LaborSalary Measures\Seq - LaborSalary_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborSalary_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1968,Package\Seq - LaborSalary Measures\Seq - LaborSalary_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalary_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1969,Package\Seq - LaborSalary Measures\Seq - LaborSalary_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1970,Package\Seq - LaborSalary Measures\Seq - LaborSalary_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1971,Package\Seq - LaborSalary Measures\Seq - LaborSalary_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1972,Package\Seq - LaborSalary Measures\Seq - LaborSalary_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborSalary(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborSalary(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1973,Package\Seq - LaborSalary Measures\Seq - ReportedLaborSalaryChildcareRegular_Actual\Foreach - New or Updated Fiscal Week\SQL - End ReportedLaborSalaryChildcareRegular_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1974,Package\Seq - LaborSalary Measures\Seq - ReportedLaborSalaryChildcareRegular_Actual\Foreach - New or Updated Fiscal Week\SQL - Start ReportedLaborSalaryChildcareRegular_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1975,Package\Seq - LaborSalary Measures\Seq - ReportedLaborSalaryChildcareRegular_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1976,Package\Seq - LaborSalary Measures\Seq - ReportedLaborSalaryChildcareRegular_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1977,Package\Seq - LaborSalary Measures\Seq - ReportedLaborSalaryChildcareRegular_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1978,Package\Seq - LaborSalary Measures\Seq - ReportedLaborSalaryChildcareRegular_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborSalary(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborSalary(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1979,Package\Seq - LaborSalary Measures\Seq - TotalLaborSalaries_Actual\Foreach - New or Updated Fiscal Week\SQL - End TotalLaborSalaries_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1980,Package\Seq - LaborSalary Measures\Seq - TotalLaborSalaries_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TotalLaborSalaries_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1981,Package\Seq - LaborSalary Measures\Seq - TotalLaborSalaries_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1982,Package\Seq - LaborSalary Measures\Seq - TotalLaborSalaries_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1983,Package\Seq - LaborSalary Measures\Seq - TotalLaborSalaries_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1984,Package\Seq - LaborSalary Measures\Seq - TotalLaborSalaries_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborSalary(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLaborSalary(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1985,Package\Seq - LeadEvent Measures\Seq - Enrollment_Actual\Foreach - New or Updated Fiscal Week\SQL - End Enrollment_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1986,Package\Seq - LeadEvent Measures\Seq - Enrollment_Actual\Foreach - New or Updated Fiscal Week\SQL - Start Enrollment_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1987,Package\Seq - LeadEvent Measures\Seq - Enrollment_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1988,Package\Seq - LeadEvent Measures\Seq - Enrollment_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1989,Package\Seq - LeadEvent Measures\Seq - Enrollment_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1990,Package\Seq - LeadEvent Measures\Seq - Enrollment_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLeadEvent(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLeadEvent(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1991,Package\Seq - LeadEvent Measures\Seq - Inquiry_Actual\Foreach - New or Updated Fiscal Week\SQL - End Inquiry_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1992,Package\Seq - LeadEvent Measures\Seq - Inquiry_Actual\Foreach - New or Updated Fiscal Week\SQL - Start Inquiry_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1993,Package\Seq - LeadEvent Measures\Seq - Inquiry_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1994,Package\Seq - LeadEvent Measures\Seq - Inquiry_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
1995,Package\Seq - LeadEvent Measures\Seq - Inquiry_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
1996,Package\Seq - LeadEvent Measures\Seq - Inquiry_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLeadEvent(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLeadEvent(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
1997,Package\Seq - LeadEvent Measures\Seq - InquirytoEnrollment_Actual\Foreach - New or Updated Fiscal Week\SQL - End InquirytoEnrollment_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
1998,Package\Seq - LeadEvent Measures\Seq - InquirytoEnrollment_Actual\Foreach - New or Updated Fiscal Week\SQL - Start InquirytoEnrollment_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
1999,Package\Seq - LeadEvent Measures\Seq - InquirytoEnrollment_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2000,Package\Seq - LeadEvent Measures\Seq - InquirytoEnrollment_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2001,Package\Seq - LeadEvent Measures\Seq - InquirytoEnrollment_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2002,Package\Seq - LeadEvent Measures\Seq - InquirytoEnrollment_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLeadEvent(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLeadEvent(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2003,Package\Seq - LeadEvent Measures\Seq - InquirytoTours_Actual\Foreach - New or Updated Fiscal Week\SQL - End InquirytoTours_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2004,Package\Seq - LeadEvent Measures\Seq - InquirytoTours_Actual\Foreach - New or Updated Fiscal Week\SQL - Start InquirytoTours_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2005,Package\Seq - LeadEvent Measures\Seq - InquirytoTours_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2006,Package\Seq - LeadEvent Measures\Seq - InquirytoTours_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2007,Package\Seq - LeadEvent Measures\Seq - InquirytoTours_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2008,Package\Seq - LeadEvent Measures\Seq - InquirytoTours_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLeadEvent(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLeadEvent(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2009,Package\Seq - LeadEvent Measures\Seq - NoResponse_Actual\Foreach - New or Updated Fiscal Week\SQL - End NoResponse_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2010,Package\Seq - LeadEvent Measures\Seq - NoResponse_Actual\Foreach - New or Updated Fiscal Week\SQL - Start NoResponse_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2011,Package\Seq - LeadEvent Measures\Seq - NoResponse_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2012,Package\Seq - LeadEvent Measures\Seq - NoResponse_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2013,Package\Seq - LeadEvent Measures\Seq - NoResponse_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2014,Package\Seq - LeadEvent Measures\Seq - NoResponse_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLeadEvent (NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLeadEvent (NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2015,Package\Seq - LeadEvent Measures\Seq - SpeedOfResponseLessthan24_Actual\Foreach - New or Updated Fiscal Week\SQL - End SpeedOfResponseLessthan24_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2016,Package\Seq - LeadEvent Measures\Seq - SpeedOfResponseLessthan24_Actual\Foreach - New or Updated Fiscal Week\SQL - Start SpeedOfResponseLessthan24_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2017,Package\Seq - LeadEvent Measures\Seq - SpeedOfResponseLessthan24_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2018,Package\Seq - LeadEvent Measures\Seq - SpeedOfResponseLessthan24_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2019,Package\Seq - LeadEvent Measures\Seq - SpeedOfResponseLessthan24_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2020,Package\Seq - LeadEvent Measures\Seq - SpeedOfResponseLessthan24_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLeadEvent (NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLeadEvent (NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2021,Package\Seq - LeadEvent Measures\Seq - SpeedOfResponseMorethan24_Actual\Foreach - New or Updated Fiscal Week\SQL - End SpeedOfResponseMorethan24_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2022,Package\Seq - LeadEvent Measures\Seq - SpeedOfResponseMorethan24_Actual\Foreach - New or Updated Fiscal Week\SQL - Start SpeedOfResponseMorethan24_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2023,Package\Seq - LeadEvent Measures\Seq - SpeedOfResponseMorethan24_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2024,Package\Seq - LeadEvent Measures\Seq - SpeedOfResponseMorethan24_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2025,Package\Seq - LeadEvent Measures\Seq - SpeedOfResponseMorethan24_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2026,Package\Seq - LeadEvent Measures\Seq - SpeedOfResponseMorethan24_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLeadEvent (NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLeadEvent (NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2027,Package\Seq - LeadEvent Measures\Seq - SpeedOfResponseWebInquiries_Actual\Foreach - New or Updated Fiscal Week\SQL - End SpeedOfResponseWebInquiries_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2028,Package\Seq - LeadEvent Measures\Seq - SpeedOfResponseWebInquiries_Actual\Foreach - New or Updated Fiscal Week\SQL - Start SpeedOfResponseWebInquiries_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2029,Package\Seq - LeadEvent Measures\Seq - SpeedOfResponseWebInquiries_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2030,Package\Seq - LeadEvent Measures\Seq - SpeedOfResponseWebInquiries_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2031,Package\Seq - LeadEvent Measures\Seq - SpeedOfResponseWebInquiries_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2032,Package\Seq - LeadEvent Measures\Seq - SpeedOfResponseWebInquiries_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLeadEvent(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLeadEvent(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2033,Package\Seq - LeadEvent Measures\Seq - TotalInquiries_Actual\Foreach - New or Updated Fiscal Week\SQL - End TotalInquiries_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2034,Package\Seq - LeadEvent Measures\Seq - TotalInquiries_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TotalInquiries_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2035,Package\Seq - LeadEvent Measures\Seq - TotalInquiries_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2036,Package\Seq - LeadEvent Measures\Seq - TotalInquiries_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2037,Package\Seq - LeadEvent Measures\Seq - TotalInquiries_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2038,Package\Seq - LeadEvent Measures\Seq - TotalInquiries_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLeadEvent (NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLeadEvent (NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2039,Package\Seq - LeadEvent Measures\Seq - TotalWebInquiries_Actual\Foreach - New or Updated Fiscal Week\SQL - End TotalInquiries_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2040,Package\Seq - LeadEvent Measures\Seq - TotalWebInquiries_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TotalInquiries_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2041,Package\Seq - LeadEvent Measures\Seq - TotalWebInquiries_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2042,Package\Seq - LeadEvent Measures\Seq - TotalWebInquiries_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2043,Package\Seq - LeadEvent Measures\Seq - TotalWebInquiries_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2044,Package\Seq - LeadEvent Measures\Seq - TotalWebInquiries_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLeadEvent (NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLeadEvent (NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2045,Package\Seq - LeadEvent Measures\Seq - Tour_Actual\Foreach - New or Updated Fiscal Week\SQL - End Tour_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2046,Package\Seq - LeadEvent Measures\Seq - Tour_Actual\Foreach - New or Updated Fiscal Week\SQL - Start Tour_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2047,Package\Seq - LeadEvent Measures\Seq - Tour_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2048,Package\Seq - LeadEvent Measures\Seq - Tour_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2049,Package\Seq - LeadEvent Measures\Seq - Tour_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2050,Package\Seq - LeadEvent Measures\Seq - Tour_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLeadEvent(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLeadEvent(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2051,Package\Seq - LeadEvent Measures\Seq - TourstoEnrollment_Actual\Foreach - New or Updated Fiscal Week\SQL - End TourstoEnrollment_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2052,Package\Seq - LeadEvent Measures\Seq - TourstoEnrollment_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TourstoEnrollment_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2053,Package\Seq - LeadEvent Measures\Seq - TourstoEnrollment_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2054,Package\Seq - LeadEvent Measures\Seq - TourstoEnrollment_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2055,Package\Seq - LeadEvent Measures\Seq - TourstoEnrollment_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2056,Package\Seq - LeadEvent Measures\Seq - TourstoEnrollment_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLeadEvent(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLeadEvent(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2057,Package\Seq - LifeCycleStatus Measures\Seq - LifeCycleStatusSnapshot_Actual\Foreach - New or Updated Fiscal Week\SQL - End LifeCycleStatusSnapshot_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2058,Package\Seq - LifeCycleStatus Measures\Seq - LifeCycleStatusSnapshot_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LifeCycleStatusSnapshot_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2059,Package\Seq - LifeCycleStatus Measures\Seq - LifeCycleStatusSnapshot_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2060,Package\Seq - LifeCycleStatus Measures\Seq - LifeCycleStatusSnapshot_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2061,Package\Seq - LifeCycleStatus Measures\Seq - LifeCycleStatusSnapshot_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2062,Package\Seq - LifeCycleStatus Measures\Seq - LifeCycleStatusSnapshot_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLifeCycleStatusSnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLifeCycleStatusSnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2063,Package\Seq - LifeCycleStatus Measures\Seq - NSEBTSLost_Actual\Foreach - New or Updated Fiscal Week\SQL - End NSEBTSLost_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2064,Package\Seq - LifeCycleStatus Measures\Seq - NSEBTSLost_Actual\Foreach - New or Updated Fiscal Week\SQL - Start NSEBTSLost_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2065,Package\Seq - LifeCycleStatus Measures\Seq - NSEBTSLost_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2066,Package\Seq - LifeCycleStatus Measures\Seq - NSEBTSLost_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2067,Package\Seq - LifeCycleStatus Measures\Seq - NSEBTSLost_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2068,Package\Seq - LifeCycleStatus Measures\Seq - NSEBTSLost_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLifeCycleStatusSnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLifeCycleStatusSnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2069,Package\Seq - LifeCycleStatus Measures\Seq - NSEBTS_Actual\Foreach - New or Updated Fiscal Week\SQL - End NSEBTS_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2070,Package\Seq - LifeCycleStatus Measures\Seq - NSEBTS_Actual\Foreach - New or Updated Fiscal Week\SQL - Start NSEBTS_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2071,Package\Seq - LifeCycleStatus Measures\Seq - NSEBTS_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2072,Package\Seq - LifeCycleStatus Measures\Seq - NSEBTS_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2073,Package\Seq - LifeCycleStatus Measures\Seq - NSEBTS_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2074,Package\Seq - LifeCycleStatus Measures\Seq - NSEBTS_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLifeCycleStatusSnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLifeCycleStatusSnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2075,Package\Seq - LifeCycleStatus Measures\Seq - Withdrawn_Actual\Foreach - New or Updated Fiscal Week\SQL - End Withdrawn_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2076,Package\Seq - LifeCycleStatus Measures\Seq - Withdrawn_Actual\Foreach - New or Updated Fiscal Week\SQL - Start Withdrawn_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2077,Package\Seq - LifeCycleStatus Measures\Seq - Withdrawn_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2078,Package\Seq - LifeCycleStatus Measures\Seq - Withdrawn_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2079,Package\Seq - LifeCycleStatus Measures\Seq - Withdrawn_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2080,Package\Seq - LifeCycleStatus Measures\Seq - Withdrawn_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLifeCycleStatusSnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactLifeCycleStatusSnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2081,Package\Seq - NSESD\Foreach - New or Updated Fiscal Week\SQL - End NSE_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2082,Package\Seq - NSESD\Foreach - New or Updated Fiscal Week\SQL - Start NSE_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2083,Package\Seq - NSESD\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseDailyMeasureFTE
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2084,Package\Seq - NSESD\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 201901) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '2019-01-04') AS LastProcessDate",1,1,0,0,0,0,1
2085,Package\Seq - NSESD\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM dbo.FactFTESnapshot(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM dbo.FactFTESnapshot(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]

   UNION 
   SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM CMS_Staging.dbo.enrlScheduleDay AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.EffectiveDate = d.FullDate
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].StgModifiedDate > ?
   AND f.EffectiveDate BETWEEN '2019-01-04' AND GETDATE()
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
     ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2086,Package\Seq - NSESD\SpPopulateNSESupportSD, Exec [dbo].[SpPopulateNSESupportSD]   @DebugMode =1,1,1,0,0,0,0,1
2087,Package\Seq - NetRevenue Measures\Seq - BadDebt_Actual\Foreach - New or Updated Fiscal Week\SQL - End BadDebt_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2088,Package\Seq - NetRevenue Measures\Seq - BadDebt_Actual\Foreach - New or Updated Fiscal Week\SQL - Start BadDebt_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2089,Package\Seq - NetRevenue Measures\Seq - BadDebt_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2090,Package\Seq - NetRevenue Measures\Seq - BadDebt_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2091,Package\Seq - NetRevenue Measures\Seq - BadDebt_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2092,Package\Seq - NetRevenue Measures\Seq - BadDebt_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2093,Package\Seq - NetRevenue Measures\Seq - ChargeOffAverage_Actual\Foreach - New or Updated Fiscal Week\SQL - End ChargeOffAverage_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2094,Package\Seq - NetRevenue Measures\Seq - ChargeOffAverage_Actual\Foreach - New or Updated Fiscal Week\SQL - Start ChargeOffAverage_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2095,Package\Seq - NetRevenue Measures\Seq - ChargeOffAverage_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2096,Package\Seq - NetRevenue Measures\Seq - ChargeOffAverage_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2097,Package\Seq - NetRevenue Measures\Seq - ChargeOffAverage_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2098,Package\Seq - NetRevenue Measures\Seq - ChargeOffAverage_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2099,Package\Seq - NetRevenue Measures\Seq - ChargeOff_Actual\Foreach - New or Updated Fiscal Week\SQL - End ChargeOff_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2100,Package\Seq - NetRevenue Measures\Seq - ChargeOff_Actual\Foreach - New or Updated Fiscal Week\SQL - Start ChargeOff_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2101,Package\Seq - NetRevenue Measures\Seq - ChargeOff_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2102,Package\Seq - NetRevenue Measures\Seq - ChargeOff_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2103,Package\Seq - NetRevenue Measures\Seq - ChargeOff_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2104,Package\Seq - NetRevenue Measures\Seq - ChargeOff_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2105,Package\Seq - NetRevenue Measures\Seq - DiscountCareSelect_Actual\Foreach - New or Updated Fiscal Week\SQL - End DiscountCareSelect_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2106,Package\Seq - NetRevenue Measures\Seq - DiscountCareSelect_Actual\Foreach - New or Updated Fiscal Week\SQL - Start DiscountCareSelect_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2107,Package\Seq - NetRevenue Measures\Seq - DiscountCareSelect_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2108,Package\Seq - NetRevenue Measures\Seq - DiscountCareSelect_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2109,Package\Seq - NetRevenue Measures\Seq - DiscountCareSelect_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2110,Package\Seq - NetRevenue Measures\Seq - DiscountCareSelect_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2111,Package\Seq - NetRevenue Measures\Seq - DiscountClosedCenterPriceMatch_Actual\Foreach - New or Updated Fiscal Week\SQL - End DiscountClosedCenterPriceMatch_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2112,Package\Seq - NetRevenue Measures\Seq - DiscountClosedCenterPriceMatch_Actual\Foreach - New or Updated Fiscal Week\SQL - Start DiscountClosedCenterPriceMatch_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2113,Package\Seq - NetRevenue Measures\Seq - DiscountClosedCenterPriceMatch_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2114,Package\Seq - NetRevenue Measures\Seq - DiscountClosedCenterPriceMatch_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2115,Package\Seq - NetRevenue Measures\Seq - DiscountClosedCenterPriceMatch_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2116,Package\Seq - NetRevenue Measures\Seq - DiscountClosedCenterPriceMatch_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2117,Package\Seq - NetRevenue Measures\Seq - DiscountDMApproved_Actual\Foreach - New or Updated Fiscal Week\SQL - End DiscountDMApproved_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2118,Package\Seq - NetRevenue Measures\Seq - DiscountDMApproved_Actual\Foreach - New or Updated Fiscal Week\SQL - Start DiscountDMApproved_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2119,Package\Seq - NetRevenue Measures\Seq - DiscountDMApproved_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2120,Package\Seq - NetRevenue Measures\Seq - DiscountDMApproved_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2121,Package\Seq - NetRevenue Measures\Seq - DiscountDMApproved_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2122,Package\Seq - NetRevenue Measures\Seq - DiscountDMApproved_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2123,Package\Seq - NetRevenue Measures\Seq - DiscountDiscretionaryPctTuitionPP_Actual\Foreach - New or Updated Fiscal Week\SQL - End DiscountDiscretionaryPctTuitionPP_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2124,Package\Seq - NetRevenue Measures\Seq - DiscountDiscretionaryPctTuitionPP_Actual\Foreach - New or Updated Fiscal Week\SQL - Start DiscountDiscretionaryPctTuitionPP_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2125,Package\Seq - NetRevenue Measures\Seq - DiscountDiscretionaryPctTuitionPP_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2126,Package\Seq - NetRevenue Measures\Seq - DiscountDiscretionaryPctTuitionPP_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2127,Package\Seq - NetRevenue Measures\Seq - DiscountDiscretionaryPctTuitionPP_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2128,Package\Seq - NetRevenue Measures\Seq - DiscountDiscretionaryPctTuitionPP_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2129,Package\Seq - NetRevenue Measures\Seq - DiscountDiscretionaryPrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - End DiscountDiscretionaryPrivatePay_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2130,Package\Seq - NetRevenue Measures\Seq - DiscountDiscretionaryPrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - Start DiscountDiscretionaryPrivatePay_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2131,Package\Seq - NetRevenue Measures\Seq - DiscountDiscretionaryPrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2132,Package\Seq - NetRevenue Measures\Seq - DiscountDiscretionaryPrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2133,Package\Seq - NetRevenue Measures\Seq - DiscountDiscretionaryPrivatePay_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2134,Package\Seq - NetRevenue Measures\Seq - DiscountDiscretionaryPrivatePay_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2135,Package\Seq - NetRevenue Measures\Seq - DiscountDiscretionary_Actual\Foreach - New or Updated Fiscal Week\SQL - End DiscountDiscretionary_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2136,Package\Seq - NetRevenue Measures\Seq - DiscountDiscretionary_Actual\Foreach - New or Updated Fiscal Week\SQL - Start DiscountDiscretionary_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2137,Package\Seq - NetRevenue Measures\Seq - DiscountDiscretionary_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2138,Package\Seq - NetRevenue Measures\Seq - DiscountDiscretionary_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2139,Package\Seq - NetRevenue Measures\Seq - DiscountDiscretionary_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2140,Package\Seq - NetRevenue Measures\Seq - DiscountDiscretionary_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2141,Package\Seq - NetRevenue Measures\Seq - DiscountFamily_Actual\Foreach - New or Updated Fiscal Week\SQL - End DiscountFamily_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2142,Package\Seq - NetRevenue Measures\Seq - DiscountFamily_Actual\Foreach - New or Updated Fiscal Week\SQL - Start DiscountFamily_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2143,Package\Seq - NetRevenue Measures\Seq - DiscountFamily_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2144,Package\Seq - NetRevenue Measures\Seq - DiscountFamily_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2145,Package\Seq - NetRevenue Measures\Seq - DiscountFamily_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2146,Package\Seq - NetRevenue Measures\Seq - DiscountFamily_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2147,Package\Seq - NetRevenue Measures\Seq - DiscountFees_Actual\Foreach - New or Updated Fiscal Week\SQL - End DiscountFees_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2148,Package\Seq - NetRevenue Measures\Seq - DiscountFees_Actual\Foreach - New or Updated Fiscal Week\SQL - Start DiscountFees_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2149,Package\Seq - NetRevenue Measures\Seq - DiscountFees_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2150,Package\Seq - NetRevenue Measures\Seq - DiscountFees_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2151,Package\Seq - NetRevenue Measures\Seq - DiscountFees_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2152,Package\Seq - NetRevenue Measures\Seq - DiscountFees_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2153,Package\Seq - NetRevenue Measures\Seq - DiscountFreeDay_Actual\Foreach - New or Updated Fiscal Week\SQL - End DiscountFreeDay_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2154,Package\Seq - NetRevenue Measures\Seq - DiscountFreeDay_Actual\Foreach - New or Updated Fiscal Week\SQL - Start DiscountFreeDay_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2155,Package\Seq - NetRevenue Measures\Seq - DiscountFreeDay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2156,Package\Seq - NetRevenue Measures\Seq - DiscountFreeDay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2157,Package\Seq - NetRevenue Measures\Seq - DiscountFreeDay_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2158,Package\Seq - NetRevenue Measures\Seq - DiscountFreeDay_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2159,Package\Seq - NetRevenue Measures\Seq - DiscountGiftOfEducation_Actual\Foreach - New or Updated Fiscal Week\SQL - End DiscountGiftOfEducation_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2160,Package\Seq - NetRevenue Measures\Seq - DiscountGiftOfEducation_Actual\Foreach - New or Updated Fiscal Week\SQL - Start DiscountGiftOfEducation_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2161,Package\Seq - NetRevenue Measures\Seq - DiscountGiftOfEducation_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2162,Package\Seq - NetRevenue Measures\Seq - DiscountGiftOfEducation_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2163,Package\Seq - NetRevenue Measures\Seq - DiscountGiftOfEducation_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2164,Package\Seq - NetRevenue Measures\Seq - DiscountGiftOfEducation_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2165,Package\Seq - NetRevenue Measures\Seq - DiscountNationalMarketing_Actual\Foreach - New or Updated Fiscal Week\SQL - End DiscountNationalMarketing_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2166,Package\Seq - NetRevenue Measures\Seq - DiscountNationalMarketing_Actual\Foreach - New or Updated Fiscal Week\SQL - Start DiscountNationalMarketing_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2167,Package\Seq - NetRevenue Measures\Seq - DiscountNationalMarketing_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2168,Package\Seq - NetRevenue Measures\Seq - DiscountNationalMarketing_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2169,Package\Seq - NetRevenue Measures\Seq - DiscountNationalMarketing_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2170,Package\Seq - NetRevenue Measures\Seq - DiscountNationalMarketing_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2171,Package\Seq - NetRevenue Measures\Seq - DiscountNationalTuition_Actual\Foreach - New or Updated Fiscal Week\SQL - End DiscountNationalTuition_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2172,Package\Seq - NetRevenue Measures\Seq - DiscountNationalTuition_Actual\Foreach - New or Updated Fiscal Week\SQL - Start DiscountNationalTuition_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2173,Package\Seq - NetRevenue Measures\Seq - DiscountNationalTuition_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2174,Package\Seq - NetRevenue Measures\Seq - DiscountNationalTuition_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2175,Package\Seq - NetRevenue Measures\Seq - DiscountNationalTuition_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2176,Package\Seq - NetRevenue Measures\Seq - DiscountNationalTuition_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2177,Package\Seq - NetRevenue Measures\Seq - DiscountOther_Actual\Foreach - New or Updated Fiscal Week\SQL - End DiscountOther_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2178,Package\Seq - NetRevenue Measures\Seq - DiscountOther_Actual\Foreach - New or Updated Fiscal Week\SQL - Start DiscountOther_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2179,Package\Seq - NetRevenue Measures\Seq - DiscountOther_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2180,Package\Seq - NetRevenue Measures\Seq - DiscountOther_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2181,Package\Seq - NetRevenue Measures\Seq - DiscountOther_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2182,Package\Seq - NetRevenue Measures\Seq - DiscountOther_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2183,Package\Seq - NetRevenue Measures\Seq - DiscountPPPctTuitionPP_Actual\Foreach - New or Updated Fiscal Week\SQL - End DiscountPPPctTuitionPP_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2184,Package\Seq - NetRevenue Measures\Seq - DiscountPPPctTuitionPP_Actual\Foreach - New or Updated Fiscal Week\SQL - Start DiscountPPPctTuitionPP_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2185,Package\Seq - NetRevenue Measures\Seq - DiscountPPPctTuitionPP_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2186,Package\Seq - NetRevenue Measures\Seq - DiscountPPPctTuitionPP_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2187,Package\Seq - NetRevenue Measures\Seq - DiscountPPPctTuitionPP_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2188,Package\Seq - NetRevenue Measures\Seq - DiscountPPPctTuitionPP_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2189,Package\Seq - NetRevenue Measures\Seq - DiscountPrimary_Actual\Foreach - New or Updated Fiscal Week\SQL - End DiscountPrimary_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2190,Package\Seq - NetRevenue Measures\Seq - DiscountPrimary_Actual\Foreach - New or Updated Fiscal Week\SQL - Start DiscountPrimary_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2191,Package\Seq - NetRevenue Measures\Seq - DiscountPrimary_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2192,Package\Seq - NetRevenue Measures\Seq - DiscountPrimary_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2193,Package\Seq - NetRevenue Measures\Seq - DiscountPrimary_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2194,Package\Seq - NetRevenue Measures\Seq - DiscountPrimary_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2195,Package\Seq - NetRevenue Measures\Seq - DiscountPrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - End DiscountPrivatePay_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2196,Package\Seq - NetRevenue Measures\Seq - DiscountPrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - Start DiscountPrivatePay_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2197,Package\Seq - NetRevenue Measures\Seq - DiscountPrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2198,Package\Seq - NetRevenue Measures\Seq - DiscountPrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2199,Package\Seq - NetRevenue Measures\Seq - DiscountPrivatePay_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2200,Package\Seq - NetRevenue Measures\Seq - DiscountPrivatePay_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2201,Package\Seq - NetRevenue Measures\Seq - DiscountPromotion_Actual\Foreach - New or Updated Fiscal Week\SQL - End DiscountPromotion_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2202,Package\Seq - NetRevenue Measures\Seq - DiscountPromotion_Actual\Foreach - New or Updated Fiscal Week\SQL - Start DiscountPromotion_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2203,Package\Seq - NetRevenue Measures\Seq - DiscountPromotion_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2204,Package\Seq - NetRevenue Measures\Seq - DiscountPromotion_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2205,Package\Seq - NetRevenue Measures\Seq - DiscountPromotion_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2206,Package\Seq - NetRevenue Measures\Seq - DiscountPromotion_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2207,Package\Seq - NetRevenue Measures\Seq - DiscountReferral_Actual\Foreach - New or Updated Fiscal Week\SQL - End DiscountReferral_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2208,Package\Seq - NetRevenue Measures\Seq - DiscountReferral_Actual\Foreach - New or Updated Fiscal Week\SQL - Start DiscountReferral_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2209,Package\Seq - NetRevenue Measures\Seq - DiscountReferral_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2210,Package\Seq - NetRevenue Measures\Seq - DiscountReferral_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2211,Package\Seq - NetRevenue Measures\Seq - DiscountReferral_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2212,Package\Seq - NetRevenue Measures\Seq - DiscountReferral_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2213,Package\Seq - NetRevenue Measures\Seq - DiscountSpecialPrograms_Actual\Foreach - New or Updated Fiscal Week\SQL - End DiscountSpecialPrograms_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2214,Package\Seq - NetRevenue Measures\Seq - DiscountSpecialPrograms_Actual\Foreach - New or Updated Fiscal Week\SQL - Start DiscountSpecialPrograms_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2215,Package\Seq - NetRevenue Measures\Seq - DiscountSpecialPrograms_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2216,Package\Seq - NetRevenue Measures\Seq - DiscountSpecialPrograms_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2217,Package\Seq - NetRevenue Measures\Seq - DiscountSpecialPrograms_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2218,Package\Seq - NetRevenue Measures\Seq - DiscountSpecialPrograms_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2219,Package\Seq - NetRevenue Measures\Seq - DiscountStaff_Actual\Foreach - New or Updated Fiscal Week\SQL - End DiscountStaff_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2220,Package\Seq - NetRevenue Measures\Seq - DiscountStaff_Actual\Foreach - New or Updated Fiscal Week\SQL - Start DiscountStaff_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2221,Package\Seq - NetRevenue Measures\Seq - DiscountStaff_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2222,Package\Seq - NetRevenue Measures\Seq - DiscountStaff_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2223,Package\Seq - NetRevenue Measures\Seq - DiscountStaff_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2224,Package\Seq - NetRevenue Measures\Seq - DiscountStaff_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2225,Package\Seq - NetRevenue Measures\Seq - DiscountSubsidyPctTuitionSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - End DiscountSubsidyPctTuitionSubsidy_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2226,Package\Seq - NetRevenue Measures\Seq - DiscountSubsidyPctTuitionSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - Start DiscountSubsidyPctTuitionSubsidy_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2227,Package\Seq - NetRevenue Measures\Seq - DiscountSubsidyPctTuitionSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2228,Package\Seq - NetRevenue Measures\Seq - DiscountSubsidyPctTuitionSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2229,Package\Seq - NetRevenue Measures\Seq - DiscountSubsidyPctTuitionSubsidy_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2230,Package\Seq - NetRevenue Measures\Seq - DiscountSubsidyPctTuitionSubsidy_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2231,Package\Seq - NetRevenue Measures\Seq - DiscountSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - End DiscountSubsidy_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2232,Package\Seq - NetRevenue Measures\Seq - DiscountSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - Start DiscountSubsidy_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2233,Package\Seq - NetRevenue Measures\Seq - DiscountSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2234,Package\Seq - NetRevenue Measures\Seq - DiscountSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2235,Package\Seq - NetRevenue Measures\Seq - DiscountSubsidy_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2236,Package\Seq - NetRevenue Measures\Seq - DiscountSubsidy_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2237,Package\Seq - NetRevenue Measures\Seq - DiscountTieredTuition_Actual\Foreach - New or Updated Fiscal Week\SQL - End DiscountTieredTuition_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2238,Package\Seq - NetRevenue Measures\Seq - DiscountTieredTuition_Actual\Foreach - New or Updated Fiscal Week\SQL - Start DiscountTieredTuition_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2239,Package\Seq - NetRevenue Measures\Seq - DiscountTieredTuition_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2240,Package\Seq - NetRevenue Measures\Seq - DiscountTieredTuition_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2241,Package\Seq - NetRevenue Measures\Seq - DiscountTieredTuition_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2242,Package\Seq - NetRevenue Measures\Seq - DiscountTieredTuition_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2243,Package\Seq - NetRevenue Measures\Seq - DiscountTotalTuitionPctTuition_Actual\Foreach - New or Updated Fiscal Week\SQL - End DiscountTotalTuitionPctTuition_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2244,Package\Seq - NetRevenue Measures\Seq - DiscountTotalTuitionPctTuition_Actual\Foreach - New or Updated Fiscal Week\SQL - Start DiscountTotalTuitionPctTuition_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2245,Package\Seq - NetRevenue Measures\Seq - DiscountTotalTuitionPctTuition_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2246,Package\Seq - NetRevenue Measures\Seq - DiscountTotalTuitionPctTuition_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2247,Package\Seq - NetRevenue Measures\Seq - DiscountTotalTuitionPctTuition_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2248,Package\Seq - NetRevenue Measures\Seq - DiscountTotalTuitionPctTuition_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2249,Package\Seq - NetRevenue Measures\Seq - DiscountTotalTuition_Actual\Foreach - New or Updated Fiscal Week\SQL - End DiscountTotalTuition_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2250,Package\Seq - NetRevenue Measures\Seq - DiscountTotalTuition_Actual\Foreach - New or Updated Fiscal Week\SQL - Start DiscountTotalTuition_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2251,Package\Seq - NetRevenue Measures\Seq - DiscountTotalTuition_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2252,Package\Seq - NetRevenue Measures\Seq - DiscountTotalTuition_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2253,Package\Seq - NetRevenue Measures\Seq - DiscountTotalTuition_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2254,Package\Seq - NetRevenue Measures\Seq - DiscountTotalTuition_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2255,Package\Seq - NetRevenue Measures\Seq - DiscountTotal_Actual\Foreach - New or Updated Fiscal Week\SQL - End DiscountTotal_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2256,Package\Seq - NetRevenue Measures\Seq - DiscountTotal_Actual\Foreach - New or Updated Fiscal Week\SQL - Start DiscountTotal_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2257,Package\Seq - NetRevenue Measures\Seq - DiscountTotal_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2258,Package\Seq - NetRevenue Measures\Seq - DiscountTotal_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2259,Package\Seq - NetRevenue Measures\Seq - DiscountTotal_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2260,Package\Seq - NetRevenue Measures\Seq - DiscountTotal_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2261,Package\Seq - NetRevenue Measures\Seq - FeesEducation_Actual\Foreach - New or Updated Fiscal Week\SQL - End FeesEducation_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2262,Package\Seq - NetRevenue Measures\Seq - FeesEducation_Actual\Foreach - New or Updated Fiscal Week\SQL - Start FeesEducation_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2263,Package\Seq - NetRevenue Measures\Seq - FeesEducation_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2264,Package\Seq - NetRevenue Measures\Seq - FeesEducation_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2265,Package\Seq - NetRevenue Measures\Seq - FeesEducation_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2266,Package\Seq - NetRevenue Measures\Seq - FeesEducation_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2267,Package\Seq - NetRevenue Measures\Seq - FeesRegistration_Actual\Foreach - New or Updated Fiscal Week\SQL - End FeesRegistration_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2268,Package\Seq - NetRevenue Measures\Seq - FeesRegistration_Actual\Foreach - New or Updated Fiscal Week\SQL - Start FeesRegistration_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2269,Package\Seq - NetRevenue Measures\Seq - FeesRegistration_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2270,Package\Seq - NetRevenue Measures\Seq - FeesRegistration_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2271,Package\Seq - NetRevenue Measures\Seq - FeesRegistration_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2272,Package\Seq - NetRevenue Measures\Seq - FeesRegistration_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2273,Package\Seq - NetRevenue Measures\Seq - FeesReservation_Actual\Foreach - New or Updated Fiscal Week\SQL - End FeesReservation_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2274,Package\Seq - NetRevenue Measures\Seq - FeesReservation_Actual\Foreach - New or Updated Fiscal Week\SQL - Start FeesReservation_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2275,Package\Seq - NetRevenue Measures\Seq - FeesReservation_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2276,Package\Seq - NetRevenue Measures\Seq - FeesReservation_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2277,Package\Seq - NetRevenue Measures\Seq - FeesReservation_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2278,Package\Seq - NetRevenue Measures\Seq - FeesReservation_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2279,Package\Seq - NetRevenue Measures\Seq - FeesRevenue_Actual\Foreach - New or Updated Fiscal Week\SQL - End FeesRevenue_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2280,Package\Seq - NetRevenue Measures\Seq - FeesRevenue_Actual\Foreach - New or Updated Fiscal Week\SQL - Start FeesRevenue_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2281,Package\Seq - NetRevenue Measures\Seq - FeesRevenue_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2282,Package\Seq - NetRevenue Measures\Seq - FeesRevenue_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2283,Package\Seq - NetRevenue Measures\Seq - FeesRevenue_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2284,Package\Seq - NetRevenue Measures\Seq - FeesRevenue_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2285,Package\Seq - NetRevenue Measures\Seq - LaborSalaryPctNetRevenue_Actual\Foreach - New or Updated Fiscal Week\SQL - End LaborSalaryPctNetRevenue_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2286,Package\Seq - NetRevenue Measures\Seq - LaborSalaryPctNetRevenue_Actual\Foreach - New or Updated Fiscal Week\SQL - Start LaborSalaryPctNetRevenue_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2287,Package\Seq - NetRevenue Measures\Seq - LaborSalaryPctNetRevenue_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2288,Package\Seq - NetRevenue Measures\Seq - LaborSalaryPctNetRevenue_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2289,Package\Seq - NetRevenue Measures\Seq - LaborSalaryPctNetRevenue_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2290,Package\Seq - NetRevenue Measures\Seq - LaborSalaryPctNetRevenue_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2291,Package\Seq - NetRevenue Measures\Seq - NetAverageRatePrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - End NetAverageRatePrivatePay_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2292,Package\Seq - NetRevenue Measures\Seq - NetAverageRatePrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - Start NetAverageRatePrivatePay_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2293,Package\Seq - NetRevenue Measures\Seq - NetAverageRatePrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2294,Package\Seq - NetRevenue Measures\Seq - NetAverageRatePrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2295,Package\Seq - NetRevenue Measures\Seq - NetAverageRatePrivatePay_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2296,Package\Seq - NetRevenue Measures\Seq - NetAverageRatePrivatePay_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2297,Package\Seq - NetRevenue Measures\Seq - NetAverageRateSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - End NetAverageRateSubsidy_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2298,Package\Seq - NetRevenue Measures\Seq - NetAverageRateSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - Start NetAverageRateSubsidy_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2299,Package\Seq - NetRevenue Measures\Seq - NetAverageRateSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2300,Package\Seq - NetRevenue Measures\Seq - NetAverageRateSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2301,Package\Seq - NetRevenue Measures\Seq - NetAverageRateSubsidy_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2302,Package\Seq - NetRevenue Measures\Seq - NetAverageRateSubsidy_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2303,Package\Seq - NetRevenue Measures\Seq - NetAverageRate_Actual\Foreach - New or Updated Fiscal Week\SQL - End NetAverageRate_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2304,Package\Seq - NetRevenue Measures\Seq - NetAverageRate_Actual\Foreach - New or Updated Fiscal Week\SQL - Start NetAverageRate_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2305,Package\Seq - NetRevenue Measures\Seq - NetAverageRate_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2306,Package\Seq - NetRevenue Measures\Seq - NetAverageRate_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2307,Package\Seq - NetRevenue Measures\Seq - NetAverageRate_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2308,Package\Seq - NetRevenue Measures\Seq - NetAverageRate_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2309,Package\Seq - NetRevenue Measures\Seq - NetFees_Actual\Foreach - New or Updated Fiscal Week\SQL - End NetFees_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2310,Package\Seq - NetRevenue Measures\Seq - NetFees_Actual\Foreach - New or Updated Fiscal Week\SQL - Start NetFees_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2311,Package\Seq - NetRevenue Measures\Seq - NetFees_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2312,Package\Seq - NetRevenue Measures\Seq - NetFees_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2313,Package\Seq - NetRevenue Measures\Seq - NetFees_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2314,Package\Seq - NetRevenue Measures\Seq - NetFees_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2315,Package\Seq - NetRevenue Measures\Seq - NetRevenue_Actual\Foreach - New or Updated Fiscal Week\SQL - End NetRevenue_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2316,Package\Seq - NetRevenue Measures\Seq - NetRevenue_Actual\Foreach - New or Updated Fiscal Week\SQL - Start NetRevenue_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2317,Package\Seq - NetRevenue Measures\Seq - NetRevenue_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2318,Package\Seq - NetRevenue Measures\Seq - NetRevenue_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2319,Package\Seq - NetRevenue Measures\Seq - NetRevenue_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2320,Package\Seq - NetRevenue Measures\Seq - NetRevenue_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2321,Package\Seq - NetRevenue Measures\Seq - NetSpecialPrograms_Actual\Foreach - New or Updated Fiscal Week\SQL - End NetSpecialPrograms_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2322,Package\Seq - NetRevenue Measures\Seq - NetSpecialPrograms_Actual\Foreach - New or Updated Fiscal Week\SQL - Start NetSpecialPrograms_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2323,Package\Seq - NetRevenue Measures\Seq - NetSpecialPrograms_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2324,Package\Seq - NetRevenue Measures\Seq - NetSpecialPrograms_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2325,Package\Seq - NetRevenue Measures\Seq - NetSpecialPrograms_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2326,Package\Seq - NetRevenue Measures\Seq - NetSpecialPrograms_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2327,Package\Seq - NetRevenue Measures\Seq - NetTuitionPrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - End NetTuitionPrivatePay_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2328,Package\Seq - NetRevenue Measures\Seq - NetTuitionPrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - Start NetTuitionPrivatePay_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2329,Package\Seq - NetRevenue Measures\Seq - NetTuitionPrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2330,Package\Seq - NetRevenue Measures\Seq - NetTuitionPrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2331,Package\Seq - NetRevenue Measures\Seq - NetTuitionPrivatePay_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2332,Package\Seq - NetRevenue Measures\Seq - NetTuitionPrivatePay_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2333,Package\Seq - NetRevenue Measures\Seq - NetTuitionSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - End NetTuitionSubsidy_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2334,Package\Seq - NetRevenue Measures\Seq - NetTuitionSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - Start NetTuitionSubsidy_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2335,Package\Seq - NetRevenue Measures\Seq - NetTuitionSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2336,Package\Seq - NetRevenue Measures\Seq - NetTuitionSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2337,Package\Seq - NetRevenue Measures\Seq - NetTuitionSubsidy_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2338,Package\Seq - NetRevenue Measures\Seq - NetTuitionSubsidy_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2339,Package\Seq - NetRevenue Measures\Seq - NetTuition_Actual\Foreach - New or Updated Fiscal Week\SQL - End NetTuition_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2340,Package\Seq - NetRevenue Measures\Seq - NetTuition_Actual\Foreach - New or Updated Fiscal Week\SQL - Start NetTuition_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2341,Package\Seq - NetRevenue Measures\Seq - NetTuition_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2342,Package\Seq - NetRevenue Measures\Seq - NetTuition_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2343,Package\Seq - NetRevenue Measures\Seq - NetTuition_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2344,Package\Seq - NetRevenue Measures\Seq - NetTuition_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2345,Package\Seq - NetRevenue Measures\Seq - Recovery_Actual\Foreach - New or Updated Fiscal Week\SQL - End Recovery_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2346,Package\Seq - NetRevenue Measures\Seq - Recovery_Actual\Foreach - New or Updated Fiscal Week\SQL - Start Recovery_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2347,Package\Seq - NetRevenue Measures\Seq - Recovery_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2348,Package\Seq - NetRevenue Measures\Seq - Recovery_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2349,Package\Seq - NetRevenue Measures\Seq - Recovery_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2350,Package\Seq - NetRevenue Measures\Seq - Recovery_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2351,Package\Seq - NetRevenue Measures\Seq - RevenueActivities_Actual\Foreach - New or Updated Fiscal Week\SQL - End RevenueActivities_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2352,Package\Seq - NetRevenue Measures\Seq - RevenueActivities_Actual\Foreach - New or Updated Fiscal Week\SQL - Start RevenueActivities_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2353,Package\Seq - NetRevenue Measures\Seq - RevenueActivities_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2354,Package\Seq - NetRevenue Measures\Seq - RevenueActivities_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2355,Package\Seq - NetRevenue Measures\Seq - RevenueActivities_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2356,Package\Seq - NetRevenue Measures\Seq - RevenueActivities_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2357,Package\Seq - NetRevenue Measures\Seq - RevenueEPManagementFee_Actual\Foreach - New or Updated Fiscal Week\SQL - End RevenueEPManagementFee_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2358,Package\Seq - NetRevenue Measures\Seq - RevenueEPManagementFee_Actual\Foreach - New or Updated Fiscal Week\SQL - Start RevenueEPManagementFee_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2359,Package\Seq - NetRevenue Measures\Seq - RevenueEPManagementFee_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2360,Package\Seq - NetRevenue Measures\Seq - RevenueEPManagementFee_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2361,Package\Seq - NetRevenue Measures\Seq - RevenueEPManagementFee_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2362,Package\Seq - NetRevenue Measures\Seq - RevenueEPManagementFee_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2363,Package\Seq - NetRevenue Measures\Seq - RevenueFieldTrips_Actual\Foreach - New or Updated Fiscal Week\SQL - End RevenueFieldTrips_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2364,Package\Seq - NetRevenue Measures\Seq - RevenueFieldTrips_Actual\Foreach - New or Updated Fiscal Week\SQL - Start RevenueFieldTrips_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2365,Package\Seq - NetRevenue Measures\Seq - RevenueFieldTrips_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2366,Package\Seq - NetRevenue Measures\Seq - RevenueFieldTrips_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2367,Package\Seq - NetRevenue Measures\Seq - RevenueFieldTrips_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2368,Package\Seq - NetRevenue Measures\Seq - RevenueFieldTrips_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2369,Package\Seq - NetRevenue Measures\Seq - RevenueHeadStart_Actual\Foreach - New or Updated Fiscal Week\SQL - End RevenueHeadStart_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2370,Package\Seq - NetRevenue Measures\Seq - RevenueHeadStart_Actual\Foreach - New or Updated Fiscal Week\SQL - Start RevenueHeadStart_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2371,Package\Seq - NetRevenue Measures\Seq - RevenueHeadStart_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2372,Package\Seq - NetRevenue Measures\Seq - RevenueHeadStart_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2373,Package\Seq - NetRevenue Measures\Seq - RevenueHeadStart_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2374,Package\Seq - NetRevenue Measures\Seq - RevenueHeadStart_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2375,Package\Seq - NetRevenue Measures\Seq - RevenueKLCStore_Actual\Foreach - New or Updated Fiscal Week\SQL - End RevenueKLCStore_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2376,Package\Seq - NetRevenue Measures\Seq - RevenueKLCStore_Actual\Foreach - New or Updated Fiscal Week\SQL - Start RevenueKLCStore_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2377,Package\Seq - NetRevenue Measures\Seq - RevenueKLCStore_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2378,Package\Seq - NetRevenue Measures\Seq - RevenueKLCStore_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2379,Package\Seq - NetRevenue Measures\Seq - RevenueKLCStore_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2380,Package\Seq - NetRevenue Measures\Seq - RevenueKLCStore_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2381,Package\Seq - NetRevenue Measures\Seq - RevenueLatePayment_Actual\Foreach - New or Updated Fiscal Week\SQL - End RevenueLatePayment_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2382,Package\Seq - NetRevenue Measures\Seq - RevenueLatePayment_Actual\Foreach - New or Updated Fiscal Week\SQL - Start RevenueLatePayment_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2383,Package\Seq - NetRevenue Measures\Seq - RevenueLatePayment_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2384,Package\Seq - NetRevenue Measures\Seq - RevenueLatePayment_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2385,Package\Seq - NetRevenue Measures\Seq - RevenueLatePayment_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2386,Package\Seq - NetRevenue Measures\Seq - RevenueLatePayment_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2387,Package\Seq - NetRevenue Measures\Seq - RevenueLatePickup_Actual\Foreach - New or Updated Fiscal Week\SQL - End RevenueLatePickup_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2388,Package\Seq - NetRevenue Measures\Seq - RevenueLatePickup_Actual\Foreach - New or Updated Fiscal Week\SQL - Start RevenueLatePickup_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2389,Package\Seq - NetRevenue Measures\Seq - RevenueLatePickup_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2390,Package\Seq - NetRevenue Measures\Seq - RevenueLatePickup_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2391,Package\Seq - NetRevenue Measures\Seq - RevenueLatePickup_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2392,Package\Seq - NetRevenue Measures\Seq - RevenueLatePickup_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2393,Package\Seq - NetRevenue Measures\Seq - RevenueMiscandOther_Actual\Foreach - New or Updated Fiscal Week\SQL - End RevenueMiscandOther_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2394,Package\Seq - NetRevenue Measures\Seq - RevenueMiscandOther_Actual\Foreach - New or Updated Fiscal Week\SQL - Start RevenueMiscandOther_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2395,Package\Seq - NetRevenue Measures\Seq - RevenueMiscandOther_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2396,Package\Seq - NetRevenue Measures\Seq - RevenueMiscandOther_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2397,Package\Seq - NetRevenue Measures\Seq - RevenueMiscandOther_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2398,Package\Seq - NetRevenue Measures\Seq - RevenueMiscandOther_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2399,Package\Seq - NetRevenue Measures\Seq - RevenueNationalAccounts_Actual\Foreach - New or Updated Fiscal Week\SQL - End RevenueNationalAccounts_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2400,Package\Seq - NetRevenue Measures\Seq - RevenueNationalAccounts_Actual\Foreach - New or Updated Fiscal Week\SQL - Start RevenueNationalAccounts_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2401,Package\Seq - NetRevenue Measures\Seq - RevenueNationalAccounts_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2402,Package\Seq - NetRevenue Measures\Seq - RevenueNationalAccounts_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2403,Package\Seq - NetRevenue Measures\Seq - RevenueNationalAccounts_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2404,Package\Seq - NetRevenue Measures\Seq - RevenueNationalAccounts_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2405,Package\Seq - NetRevenue Measures\Seq - RevenueOther_Actual\Foreach - New or Updated Fiscal Week\SQL - End RevenueOther_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2406,Package\Seq - NetRevenue Measures\Seq - RevenueOther_Actual\Foreach - New or Updated Fiscal Week\SQL - Start RevenueOther_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2407,Package\Seq - NetRevenue Measures\Seq - RevenueOther_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2408,Package\Seq - NetRevenue Measures\Seq - RevenueOther_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2409,Package\Seq - NetRevenue Measures\Seq - RevenueOther_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2410,Package\Seq - NetRevenue Measures\Seq - RevenueOther_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2411,Package\Seq - NetRevenue Measures\Seq - RevenuePrimary_Actual\Foreach - New or Updated Fiscal Week\SQL - End RevenuePrimary_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2412,Package\Seq - NetRevenue Measures\Seq - RevenuePrimary_Actual\Foreach - New or Updated Fiscal Week\SQL - Start RevenuePrimary_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2413,Package\Seq - NetRevenue Measures\Seq - RevenuePrimary_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2414,Package\Seq - NetRevenue Measures\Seq - RevenuePrimary_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2415,Package\Seq - NetRevenue Measures\Seq - RevenuePrimary_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2416,Package\Seq - NetRevenue Measures\Seq - RevenuePrimary_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2417,Package\Seq - NetRevenue Measures\Seq - RevenueSpecialServices_Actual\Foreach - New or Updated Fiscal Week\SQL - End RevenueSpecialServices_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2418,Package\Seq - NetRevenue Measures\Seq - RevenueSpecialServices_Actual\Foreach - New or Updated Fiscal Week\SQL - Start RevenueSpecialServices_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2419,Package\Seq - NetRevenue Measures\Seq - RevenueSpecialServices_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2420,Package\Seq - NetRevenue Measures\Seq - RevenueSpecialServices_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2421,Package\Seq - NetRevenue Measures\Seq - RevenueSpecialServices_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2422,Package\Seq - NetRevenue Measures\Seq - RevenueSpecialServices_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2423,Package\Seq - NetRevenue Measures\Seq - ReverseChargesMemo_Actual\Foreach - New or Updated Fiscal Week\SQL - End ReverseChargesMemo_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2424,Package\Seq - NetRevenue Measures\Seq - ReverseChargesMemo_Actual\Foreach - New or Updated Fiscal Week\SQL - Start ReverseChargesMemo_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2425,Package\Seq - NetRevenue Measures\Seq - ReverseChargesMemo_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2426,Package\Seq - NetRevenue Measures\Seq - ReverseChargesMemo_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2427,Package\Seq - NetRevenue Measures\Seq - ReverseChargesMemo_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2428,Package\Seq - NetRevenue Measures\Seq - ReverseChargesMemo_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2429,Package\Seq - NetRevenue Measures\Seq - TotalMiscellaneousIncome_Actual\Foreach - New or Updated Fiscal Week\SQL - End TotalMiscellaneousIncome_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2430,Package\Seq - NetRevenue Measures\Seq - TotalMiscellaneousIncome_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TotalMiscellaneousIncome_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2431,Package\Seq - NetRevenue Measures\Seq - TotalMiscellaneousIncome_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2432,Package\Seq - NetRevenue Measures\Seq - TotalMiscellaneousIncome_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2433,Package\Seq - NetRevenue Measures\Seq - TotalMiscellaneousIncome_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2434,Package\Seq - NetRevenue Measures\Seq - TotalMiscellaneousIncome_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2435,Package\Seq - NetRevenue Measures\Seq - TotalNetMiscAndOtherRevenues_Actual\Foreach - New or Updated Fiscal Week\SQL - End TotalNetMiscAndOtherRevenues_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2436,Package\Seq - NetRevenue Measures\Seq - TotalNetMiscAndOtherRevenues_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TotalNetMiscAndOtherRevenues_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2437,Package\Seq - NetRevenue Measures\Seq - TotalNetMiscAndOtherRevenues_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2438,Package\Seq - NetRevenue Measures\Seq - TotalNetMiscAndOtherRevenues_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2439,Package\Seq - NetRevenue Measures\Seq - TotalNetMiscAndOtherRevenues_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2440,Package\Seq - NetRevenue Measures\Seq - TotalNetMiscAndOtherRevenues_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2441,Package\Seq - NetRevenue Measures\Seq - TuitionAdjustmentsPrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - End TuitionAdjustmentsPrivatePay_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2442,Package\Seq - NetRevenue Measures\Seq - TuitionAdjustmentsPrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TuitionAdjustmentsPrivatePay_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2443,Package\Seq - NetRevenue Measures\Seq - TuitionAdjustmentsPrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2444,Package\Seq - NetRevenue Measures\Seq - TuitionAdjustmentsPrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2445,Package\Seq - NetRevenue Measures\Seq - TuitionAdjustmentsPrivatePay_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2446,Package\Seq - NetRevenue Measures\Seq - TuitionAdjustmentsPrivatePay_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2447,Package\Seq - NetRevenue Measures\Seq - TuitionAdjustmentsSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - End TuitionAdjustmentsSubsidy_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2448,Package\Seq - NetRevenue Measures\Seq - TuitionAdjustmentsSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TuitionAdjustmentsSubsidy_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2449,Package\Seq - NetRevenue Measures\Seq - TuitionAdjustmentsSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2450,Package\Seq - NetRevenue Measures\Seq - TuitionAdjustmentsSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2451,Package\Seq - NetRevenue Measures\Seq - TuitionAdjustmentsSubsidy_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2452,Package\Seq - NetRevenue Measures\Seq - TuitionAdjustmentsSubsidy_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2453,Package\Seq - NetRevenue Measures\Seq - TuitionAdjustments_Actual\Foreach - New or Updated Fiscal Week\SQL - End TuitionAdjustments_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2454,Package\Seq - NetRevenue Measures\Seq - TuitionAdjustments_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TuitionAdjustments_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2455,Package\Seq - NetRevenue Measures\Seq - TuitionAdjustments_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2456,Package\Seq - NetRevenue Measures\Seq - TuitionAdjustments_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2457,Package\Seq - NetRevenue Measures\Seq - TuitionAdjustments_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2458,Package\Seq - NetRevenue Measures\Seq - TuitionAdjustments_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2459,Package\Seq - NetRevenue Measures\Seq - TuitionDiscount_Actual\Foreach - New or Updated Fiscal Week\SQL - End TuitionDiscount_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2460,Package\Seq - NetRevenue Measures\Seq - TuitionDiscount_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TuitionDiscount_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2461,Package\Seq - NetRevenue Measures\Seq - TuitionDiscount_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2462,Package\Seq - NetRevenue Measures\Seq - TuitionDiscount_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2463,Package\Seq - NetRevenue Measures\Seq - TuitionDiscount_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2464,Package\Seq - NetRevenue Measures\Seq - TuitionDiscount_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2465,Package\Seq - NetRevenue Measures\Seq - TuitionFivesPrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - End TuitionFivesPrivatePay_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2466,Package\Seq - NetRevenue Measures\Seq - TuitionFivesPrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TuitionFivesPrivatePay_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2467,Package\Seq - NetRevenue Measures\Seq - TuitionFivesPrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2468,Package\Seq - NetRevenue Measures\Seq - TuitionFivesPrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2469,Package\Seq - NetRevenue Measures\Seq - TuitionFivesPrivatePay_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2470,Package\Seq - NetRevenue Measures\Seq - TuitionFivesPrivatePay_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2471,Package\Seq - NetRevenue Measures\Seq - TuitionFivesSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - End TuitionFivesSubsidy_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2472,Package\Seq - NetRevenue Measures\Seq - TuitionFivesSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TuitionFivesSubsidy_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2473,Package\Seq - NetRevenue Measures\Seq - TuitionFivesSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2474,Package\Seq - NetRevenue Measures\Seq - TuitionFivesSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2475,Package\Seq - NetRevenue Measures\Seq - TuitionFivesSubsidy_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2476,Package\Seq - NetRevenue Measures\Seq - TuitionFivesSubsidy_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2477,Package\Seq - NetRevenue Measures\Seq - TuitionFives_Actual\Foreach - New or Updated Fiscal Week\SQL - End TuitionFives_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2478,Package\Seq - NetRevenue Measures\Seq - TuitionFives_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TuitionFives_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2479,Package\Seq - NetRevenue Measures\Seq - TuitionFives_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2480,Package\Seq - NetRevenue Measures\Seq - TuitionFives_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2481,Package\Seq - NetRevenue Measures\Seq - TuitionFives_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2482,Package\Seq - NetRevenue Measures\Seq - TuitionFives_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2483,Package\Seq - NetRevenue Measures\Seq - TuitionFoursPrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - End TuitionFoursPrivatePay_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2484,Package\Seq - NetRevenue Measures\Seq - TuitionFoursPrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TuitionFoursPrivatePay_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2485,Package\Seq - NetRevenue Measures\Seq - TuitionFoursPrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2486,Package\Seq - NetRevenue Measures\Seq - TuitionFoursPrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2487,Package\Seq - NetRevenue Measures\Seq - TuitionFoursPrivatePay_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2488,Package\Seq - NetRevenue Measures\Seq - TuitionFoursPrivatePay_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2489,Package\Seq - NetRevenue Measures\Seq - TuitionFoursSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - End TuitionFoursSubsidy_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2490,Package\Seq - NetRevenue Measures\Seq - TuitionFoursSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TuitionFoursSubsidy_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2491,Package\Seq - NetRevenue Measures\Seq - TuitionFoursSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2492,Package\Seq - NetRevenue Measures\Seq - TuitionFoursSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2493,Package\Seq - NetRevenue Measures\Seq - TuitionFoursSubsidy_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2494,Package\Seq - NetRevenue Measures\Seq - TuitionFoursSubsidy_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2495,Package\Seq - NetRevenue Measures\Seq - TuitionFours_Actual\Foreach - New or Updated Fiscal Week\SQL - End TuitionFours_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2496,Package\Seq - NetRevenue Measures\Seq - TuitionFours_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TuitionFours_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2497,Package\Seq - NetRevenue Measures\Seq - TuitionFours_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2498,Package\Seq - NetRevenue Measures\Seq - TuitionFours_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2499,Package\Seq - NetRevenue Measures\Seq - TuitionFours_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2500,Package\Seq - NetRevenue Measures\Seq - TuitionFours_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2501,Package\Seq - NetRevenue Measures\Seq - TuitionHourlyDropInPP_Actual\Foreach - New or Updated Fiscal Week\SQL - End TuitionHourlyDropInPP_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2502,Package\Seq - NetRevenue Measures\Seq - TuitionHourlyDropInPP_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TuitionHourlyDropInPP_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2503,Package\Seq - NetRevenue Measures\Seq - TuitionHourlyDropInPP_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2504,Package\Seq - NetRevenue Measures\Seq - TuitionHourlyDropInPP_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2505,Package\Seq - NetRevenue Measures\Seq - TuitionHourlyDropInPP_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2506,Package\Seq - NetRevenue Measures\Seq - TuitionHourlyDropInPP_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2507,Package\Seq - NetRevenue Measures\Seq - TuitionHourlyDropInSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - End TuitionHourlyDropInSubsidy_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2508,Package\Seq - NetRevenue Measures\Seq - TuitionHourlyDropInSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TuitionHourlyDropInSubsidy_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2509,Package\Seq - NetRevenue Measures\Seq - TuitionHourlyDropInSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2510,Package\Seq - NetRevenue Measures\Seq - TuitionHourlyDropInSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2511,Package\Seq - NetRevenue Measures\Seq - TuitionHourlyDropInSubsidy_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2512,Package\Seq - NetRevenue Measures\Seq - TuitionHourlyDropInSubsidy_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2513,Package\Seq - NetRevenue Measures\Seq - TuitionHourlyDropIn_Actual\Foreach - New or Updated Fiscal Week\SQL - End TuitionHourlyDropIn_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2514,Package\Seq - NetRevenue Measures\Seq - TuitionHourlyDropIn_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TuitionHourlyDropIn_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2515,Package\Seq - NetRevenue Measures\Seq - TuitionHourlyDropIn_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2516,Package\Seq - NetRevenue Measures\Seq - TuitionHourlyDropIn_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2517,Package\Seq - NetRevenue Measures\Seq - TuitionHourlyDropIn_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2518,Package\Seq - NetRevenue Measures\Seq - TuitionHourlyDropIn_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2519,Package\Seq - NetRevenue Measures\Seq - TuitionInfantPrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - End TuitionInfantPrivatePay_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2520,Package\Seq - NetRevenue Measures\Seq - TuitionInfantPrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TuitionInfantPrivatePay_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2521,Package\Seq - NetRevenue Measures\Seq - TuitionInfantPrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2522,Package\Seq - NetRevenue Measures\Seq - TuitionInfantPrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2523,Package\Seq - NetRevenue Measures\Seq - TuitionInfantPrivatePay_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2524,Package\Seq - NetRevenue Measures\Seq - TuitionInfantPrivatePay_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2525,Package\Seq - NetRevenue Measures\Seq - TuitionInfantSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - End TuitionInfantSubsidy_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2526,Package\Seq - NetRevenue Measures\Seq - TuitionInfantSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TuitionInfantSubsidy_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2527,Package\Seq - NetRevenue Measures\Seq - TuitionInfantSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2528,Package\Seq - NetRevenue Measures\Seq - TuitionInfantSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2529,Package\Seq - NetRevenue Measures\Seq - TuitionInfantSubsidy_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2530,Package\Seq - NetRevenue Measures\Seq - TuitionInfantSubsidy_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2531,Package\Seq - NetRevenue Measures\Seq - TuitionInfant_Actual\Foreach - New or Updated Fiscal Week\SQL - End TuitionInfant_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2532,Package\Seq - NetRevenue Measures\Seq - TuitionInfant_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TuitionInfant_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2533,Package\Seq - NetRevenue Measures\Seq - TuitionInfant_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2534,Package\Seq - NetRevenue Measures\Seq - TuitionInfant_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2535,Package\Seq - NetRevenue Measures\Seq - TuitionInfant_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2536,Package\Seq - NetRevenue Measures\Seq - TuitionInfant_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2537,Package\Seq - NetRevenue Measures\Seq - TuitionKindergartenPrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - End TuitionKindergartenPrivatePay_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2538,Package\Seq - NetRevenue Measures\Seq - TuitionKindergartenPrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TuitionKindergartenPrivatePay_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2539,Package\Seq - NetRevenue Measures\Seq - TuitionKindergartenPrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2540,Package\Seq - NetRevenue Measures\Seq - TuitionKindergartenPrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2541,Package\Seq - NetRevenue Measures\Seq - TuitionKindergartenPrivatePay_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2542,Package\Seq - NetRevenue Measures\Seq - TuitionKindergartenPrivatePay_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2543,Package\Seq - NetRevenue Measures\Seq - TuitionKindergartenSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - End TuitionKindergartenSubsidy_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2544,Package\Seq - NetRevenue Measures\Seq - TuitionKindergartenSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TuitionKindergartenSubsidy_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2545,Package\Seq - NetRevenue Measures\Seq - TuitionKindergartenSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2546,Package\Seq - NetRevenue Measures\Seq - TuitionKindergartenSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2547,Package\Seq - NetRevenue Measures\Seq - TuitionKindergartenSubsidy_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2548,Package\Seq - NetRevenue Measures\Seq - TuitionKindergartenSubsidy_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2549,Package\Seq - NetRevenue Measures\Seq - TuitionKindergarten_Actual\Foreach - New or Updated Fiscal Week\SQL - End TuitionKindergarten_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2550,Package\Seq - NetRevenue Measures\Seq - TuitionKindergarten_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TuitionKindergarten_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2551,Package\Seq - NetRevenue Measures\Seq - TuitionKindergarten_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2552,Package\Seq - NetRevenue Measures\Seq - TuitionKindergarten_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2553,Package\Seq - NetRevenue Measures\Seq - TuitionKindergarten_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2554,Package\Seq - NetRevenue Measures\Seq - TuitionKindergarten_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2555,Package\Seq - NetRevenue Measures\Seq - TuitionMultiagePrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - End TuitionMultiagePrivatePay_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2556,Package\Seq - NetRevenue Measures\Seq - TuitionMultiagePrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TuitionMultiagePrivatePay_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2557,Package\Seq - NetRevenue Measures\Seq - TuitionMultiagePrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2558,Package\Seq - NetRevenue Measures\Seq - TuitionMultiagePrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2559,Package\Seq - NetRevenue Measures\Seq - TuitionMultiagePrivatePay_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2560,Package\Seq - NetRevenue Measures\Seq - TuitionMultiagePrivatePay_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2561,Package\Seq - NetRevenue Measures\Seq - TuitionMultiageSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - End TuitionMultiageSubsidy_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2562,Package\Seq - NetRevenue Measures\Seq - TuitionMultiageSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TuitionMultiageSubsidy_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2563,Package\Seq - NetRevenue Measures\Seq - TuitionMultiageSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2564,Package\Seq - NetRevenue Measures\Seq - TuitionMultiageSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2565,Package\Seq - NetRevenue Measures\Seq - TuitionMultiageSubsidy_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2566,Package\Seq - NetRevenue Measures\Seq - TuitionMultiageSubsidy_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2567,Package\Seq - NetRevenue Measures\Seq - TuitionMultiage_Actual\Foreach - New or Updated Fiscal Week\SQL - End TuitionMultiage_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2568,Package\Seq - NetRevenue Measures\Seq - TuitionMultiage_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TuitionMultiage_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2569,Package\Seq - NetRevenue Measures\Seq - TuitionMultiage_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2570,Package\Seq - NetRevenue Measures\Seq - TuitionMultiage_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2571,Package\Seq - NetRevenue Measures\Seq - TuitionMultiage_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2572,Package\Seq - NetRevenue Measures\Seq - TuitionMultiage_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2573,Package\Seq - NetRevenue Measures\Seq - TuitionSchoolagePrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - End TuitionSchoolagePrivatePay_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2574,Package\Seq - NetRevenue Measures\Seq - TuitionSchoolagePrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TuitionSchoolagePrivatePay_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2575,Package\Seq - NetRevenue Measures\Seq - TuitionSchoolagePrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2576,Package\Seq - NetRevenue Measures\Seq - TuitionSchoolagePrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2577,Package\Seq - NetRevenue Measures\Seq - TuitionSchoolagePrivatePay_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2578,Package\Seq - NetRevenue Measures\Seq - TuitionSchoolagePrivatePay_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2579,Package\Seq - NetRevenue Measures\Seq - TuitionSchoolageSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - End TuitionSchoolageSubsidy_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2580,Package\Seq - NetRevenue Measures\Seq - TuitionSchoolageSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TuitionSchoolageSubsidy_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2581,Package\Seq - NetRevenue Measures\Seq - TuitionSchoolageSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2582,Package\Seq - NetRevenue Measures\Seq - TuitionSchoolageSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2583,Package\Seq - NetRevenue Measures\Seq - TuitionSchoolageSubsidy_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2584,Package\Seq - NetRevenue Measures\Seq - TuitionSchoolageSubsidy_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2585,Package\Seq - NetRevenue Measures\Seq - TuitionSchoolage_Actual\Foreach - New or Updated Fiscal Week\SQL - End TuitionSchoolage_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2586,Package\Seq - NetRevenue Measures\Seq - TuitionSchoolage_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TuitionSchoolage_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2587,Package\Seq - NetRevenue Measures\Seq - TuitionSchoolage_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2588,Package\Seq - NetRevenue Measures\Seq - TuitionSchoolage_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2589,Package\Seq - NetRevenue Measures\Seq - TuitionSchoolage_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2590,Package\Seq - NetRevenue Measures\Seq - TuitionSchoolage_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2591,Package\Seq - NetRevenue Measures\Seq - TuitionSpecialPrograms_Actual\Foreach - New or Updated Fiscal Week\SQL - End TuitionSpecialPrograms_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2592,Package\Seq - NetRevenue Measures\Seq - TuitionSpecialPrograms_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TuitionSpecialPrograms_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2593,Package\Seq - NetRevenue Measures\Seq - TuitionSpecialPrograms_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2594,Package\Seq - NetRevenue Measures\Seq - TuitionSpecialPrograms_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2595,Package\Seq - NetRevenue Measures\Seq - TuitionSpecialPrograms_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2596,Package\Seq - NetRevenue Measures\Seq - TuitionSpecialPrograms_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2597,Package\Seq - NetRevenue Measures\Seq - TuitionThreesPrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - End TuitionThreesPrivatePay_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2598,Package\Seq - NetRevenue Measures\Seq - TuitionThreesPrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TuitionThreesPrivatePay_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2599,Package\Seq - NetRevenue Measures\Seq - TuitionThreesPrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2600,Package\Seq - NetRevenue Measures\Seq - TuitionThreesPrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2601,Package\Seq - NetRevenue Measures\Seq - TuitionThreesPrivatePay_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2602,Package\Seq - NetRevenue Measures\Seq - TuitionThreesPrivatePay_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2603,Package\Seq - NetRevenue Measures\Seq - TuitionThreesSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - End TuitionThreesSubsidy_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2604,Package\Seq - NetRevenue Measures\Seq - TuitionThreesSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TuitionThreesSubsidy_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2605,Package\Seq - NetRevenue Measures\Seq - TuitionThreesSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2606,Package\Seq - NetRevenue Measures\Seq - TuitionThreesSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2607,Package\Seq - NetRevenue Measures\Seq - TuitionThreesSubsidy_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2608,Package\Seq - NetRevenue Measures\Seq - TuitionThreesSubsidy_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2609,Package\Seq - NetRevenue Measures\Seq - TuitionThrees_Actual\Foreach - New or Updated Fiscal Week\SQL - End TuitionThrees_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2610,Package\Seq - NetRevenue Measures\Seq - TuitionThrees_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TuitionThrees_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2611,Package\Seq - NetRevenue Measures\Seq - TuitionThrees_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2612,Package\Seq - NetRevenue Measures\Seq - TuitionThrees_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2613,Package\Seq - NetRevenue Measures\Seq - TuitionThrees_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2614,Package\Seq - NetRevenue Measures\Seq - TuitionThrees_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2615,Package\Seq - NetRevenue Measures\Seq - TuitionToddlerPrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - End TuitionToddlerPrivatePay_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2616,Package\Seq - NetRevenue Measures\Seq - TuitionToddlerPrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TuitionToddlerPrivatePay_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2617,Package\Seq - NetRevenue Measures\Seq - TuitionToddlerPrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2618,Package\Seq - NetRevenue Measures\Seq - TuitionToddlerPrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2619,Package\Seq - NetRevenue Measures\Seq - TuitionToddlerPrivatePay_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2620,Package\Seq - NetRevenue Measures\Seq - TuitionToddlerPrivatePay_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2621,Package\Seq - NetRevenue Measures\Seq - TuitionToddlerSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - End TuitionToddlerSubsidy_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2622,Package\Seq - NetRevenue Measures\Seq - TuitionToddlerSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TuitionToddlerSubsidy_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2623,Package\Seq - NetRevenue Measures\Seq - TuitionToddlerSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2624,Package\Seq - NetRevenue Measures\Seq - TuitionToddlerSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2625,Package\Seq - NetRevenue Measures\Seq - TuitionToddlerSubsidy_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2626,Package\Seq - NetRevenue Measures\Seq - TuitionToddlerSubsidy_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2627,Package\Seq - NetRevenue Measures\Seq - TuitionToddler_Actual\Foreach - New or Updated Fiscal Week\SQL - End TuitionToddler_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2628,Package\Seq - NetRevenue Measures\Seq - TuitionToddler_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TuitionToddler_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2629,Package\Seq - NetRevenue Measures\Seq - TuitionToddler_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2630,Package\Seq - NetRevenue Measures\Seq - TuitionToddler_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2631,Package\Seq - NetRevenue Measures\Seq - TuitionToddler_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2632,Package\Seq - NetRevenue Measures\Seq - TuitionToddler_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2633,Package\Seq - NetRevenue Measures\Seq - TuitionTotalPrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - End TuitionTotalPrivatePay_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2634,Package\Seq - NetRevenue Measures\Seq - TuitionTotalPrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TuitionTotalPrivatePay_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2635,Package\Seq - NetRevenue Measures\Seq - TuitionTotalPrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2636,Package\Seq - NetRevenue Measures\Seq - TuitionTotalPrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2637,Package\Seq - NetRevenue Measures\Seq - TuitionTotalPrivatePay_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2638,Package\Seq - NetRevenue Measures\Seq - TuitionTotalPrivatePay_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2639,Package\Seq - NetRevenue Measures\Seq - TuitionTotalSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - End TuitionTotalSubsidy_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2640,Package\Seq - NetRevenue Measures\Seq - TuitionTotalSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TuitionTotalSubsidy_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2641,Package\Seq - NetRevenue Measures\Seq - TuitionTotalSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2642,Package\Seq - NetRevenue Measures\Seq - TuitionTotalSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2643,Package\Seq - NetRevenue Measures\Seq - TuitionTotalSubsidy_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2644,Package\Seq - NetRevenue Measures\Seq - TuitionTotalSubsidy_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2645,Package\Seq - NetRevenue Measures\Seq - TuitionTotal_Actual\Foreach - New or Updated Fiscal Week\SQL - End TuitionTotal_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2646,Package\Seq - NetRevenue Measures\Seq - TuitionTotal_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TuitionTotal_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2647,Package\Seq - NetRevenue Measures\Seq - TuitionTotal_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2648,Package\Seq - NetRevenue Measures\Seq - TuitionTotal_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2649,Package\Seq - NetRevenue Measures\Seq - TuitionTotal_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2650,Package\Seq - NetRevenue Measures\Seq - TuitionTotal_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2651,Package\Seq - NetRevenue Measures\Seq - TuitionTwosPrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - End TuitionTwosPrivatePay_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2652,Package\Seq - NetRevenue Measures\Seq - TuitionTwosPrivatePay_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TuitionTwosPrivatePay_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2653,Package\Seq - NetRevenue Measures\Seq - TuitionTwosPrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2654,Package\Seq - NetRevenue Measures\Seq - TuitionTwosPrivatePay_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2655,Package\Seq - NetRevenue Measures\Seq - TuitionTwosPrivatePay_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2656,Package\Seq - NetRevenue Measures\Seq - TuitionTwosPrivatePay_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2657,Package\Seq - NetRevenue Measures\Seq - TuitionTwosSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - End TuitionTwosSubsidy_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2658,Package\Seq - NetRevenue Measures\Seq - TuitionTwosSubsidy_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TuitionTwosSubsidy_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2659,Package\Seq - NetRevenue Measures\Seq - TuitionTwosSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2660,Package\Seq - NetRevenue Measures\Seq - TuitionTwosSubsidy_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2661,Package\Seq - NetRevenue Measures\Seq - TuitionTwosSubsidy_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2662,Package\Seq - NetRevenue Measures\Seq - TuitionTwosSubsidy_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2663,Package\Seq - NetRevenue Measures\Seq - TuitionTwos_Actual\Foreach - New or Updated Fiscal Week\SQL - End TuitionTwos_Actual Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2664,Package\Seq - NetRevenue Measures\Seq - TuitionTwos_Actual\Foreach - New or Updated Fiscal Week\SQL - Start TuitionTwos_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2665,Package\Seq - NetRevenue Measures\Seq - TuitionTwos_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete Data Scenario Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'Actual';
SELECT @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2666,Package\Seq - NetRevenue Measures\Seq - TuitionTwos_Actual\Foreach - New or Updated Fiscal Week\Seq - Delete Existing Data\SQL - Delete LY Data,"DELETE 
    FROM dbo.BaseWeeklyMeasure
    WHERE MeasureName = ?
        AND FiscalWeekEndDate = ?
        AND DataScenarioName = 'LY';
SELECT ? + @@ROWCOUNT AS DeleteCount;",1,1,0,0,0,0,1
2667,Package\Seq - NetRevenue Measures\Seq - TuitionTwos_Actual\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 200001) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '1900-01-01') AS LastProcessDate",1,1,0,0,0,0,1
2668,Package\Seq - NetRevenue Measures\Seq - TuitionTwos_Actual\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
      JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [f].[EDWCreatedDate] > ?
   GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
UNION
SELECT d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
     , d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate
     , ISNULL(d_nyr.[FiscalWeekNumber], d.[FiscalWeekNumber] + 100) AS LYFiscalWeekNumber
     , ISNULL(d_nyr.[FiscalWeekEndDate], DATEADD(week, DATEDIFF(week, d.FiscalWeekEndDate, d.FiscalYearEndDate) + d.FiscalWeekOfYearNumber, d.[FiscalWeekEndDate])) AS LYFiscalWeekEndDate
   FROM FactNetRevenue(NOLOCK) AS f
         JOIN DimDate(NOLOCK) AS d
        ON f.DateKey = d.DateKey
      LEFT JOIN DimDate(NOLOCK) AS d_nyr 
        ON d.FiscalWeekOfYearNumber = d_nyr.FiscalWeekOfYearNumber
           AND d.FiscalYearNumber = d_nyr.FiscalYearNumber - 1
           AND d_nyr.FullDate = d_nyr.FiscalWeekEndDate
   WHERE [d].[FiscalWeekNumber] > ?
      GROUP BY d.[FiscalWeekNumber]
     , d.[FiscalWeekEndDate]
  , d.[FiscalYearEndDate]
  , d.[FiscalWeekOfYearNumber]
     , d_nyr.[FiscalWeekNumber]
     , d_nyr.[FiscalWeekEndDate]
   ORDER BY DataScenarioFiscalWeekNumber",1,1,0,0,0,0,1
2669,Package\Sequence Container 1\Seq - New FTE\Foreach - New or Updated Fiscal Week\Foreach Loop Container\SQL - End NewFTE Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2670,Package\Sequence Container 1\Seq - New FTE\Foreach - New or Updated Fiscal Week\SQL - Start NewFTE_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2671,Package\Sequence Container 1\Seq - New FTE\Foreach - New or Updated Fiscal Week\SQL- Assigning SRC query to Variable,"DECLARE @QueryTable TABLE
(
    SQLQUERY VARCHAR(MAX) NULL
);

DECLARE @Measurename VARCHAR(100);
DECLARE csr_fact_rabalance_fisc_weekend CURSOR FOR
SELECT MeasureName
FROM GL_Staging..MartASALookup
WHERE MeasureName NOT IN
      (
          SELECT DISTINCT MeasureName FROM BING_EDW..SupportDailyMeasureFTE
      )
      AND GLMetricTypeCode = 'Stat';
--
-- Use cursor to loop through the values we have chosen to split this batch by
--
OPEN csr_fact_rabalance_fisc_weekend;
FETCH NEXT FROM csr_fact_rabalance_fisc_weekend
INTO @Measurename;
WHILE @@FETCH_STATUS = 0
BEGIN


    IF
    (
        SELECT TuitionType
        FROM GL_Staging..MartASALookup
        WHERE MeasureName = @Measurename
    ) NOT LIKE '%[A-Z]%'
    BEGIN
        DECLARE @Field AS TABLE
        (
            FieldPath VARCHAR(MAX) NOT NULL
        );
        DELETE FROM @Field;
        INSERT INTO @Field
        (
            FieldPath
        )
        (SELECT FieldPath
         FROM GL_Staging.dbo.MartASALookup
         WHERE MeasureName = @Measurename);
        DECLARE @SQL NVARCHAR(MAX);

        SET @SQL
            = N'SELECT 
       DD.FullDate,
	   DD.FiscalWeekEndDate,
       Std.StudentID,
       Spn.SponsorID,
	   COALESCE(Spn.PartnerID, -1) PartnerID,
       Tsp.TuitionAssistanceProviderID,
       CC.CostCenterNumber, ' + N'''' + @Measurename + N''''
              + N'  AS Measurename,
       Acct.AccountSubaccountID,
       Tr.TierID,
       Pgm.ProgramID,
       SS.SessionID,
       Schd.ScheduleWeekName,
       Lcs.LifecycleStatusName,
       SUM(FTE.FTE) AS Value1,
       FTE.SourceSystem AS SourceSystem,
      Std.CSSStudentNumber ,
      Spn.CSSCenterNumber  ,
      Spn.CSSFamilyNumber  ,
      Tr.CSSTierNumber	   ,
      Pgm.ProgramName	   ,
      SS.SessionName
FROM dbo.FactFTESnapshot FTE
    INNER JOIN dbo.DimDate DD
        ON FTE.DateKey = DD.DateKey
    INNER JOIN dbo.DimStudent Std
        ON FTE.StudentKey = Std.StudentKey
    INNER JOIN dbo.DimSponsor Spn
        ON FTE.SponsorKey = Spn.SponsorKey
    INNER JOIN dbo.DimTuitionAssistanceProvider Tsp
        ON FTE.TuitionAssistanceProviderKey = Tsp.TuitionAssistanceProviderKey
    INNER JOIN dbo.DimCostCenter CC
        ON FTE.CostCenterKey = CC.CostCenterKey
    INNER JOIN dbo.DimAccountSubaccount Acct
        ON FTE.AccountSubaccountKey = Acct.AccountSubaccountKey
    INNER JOIN dbo.DimTier Tr
        ON FTE.TierKey = Tr.TierKey
    INNER JOIN dbo.DimProgram Pgm
        ON FTE.ProgramKey = Pgm.ProgramKey
    INNER JOIN dbo.DimSession SS
        ON FTE.SessionKey = SS.SessionKey
    INNER JOIN dbo.DimScheduleWeek Schd
        ON FTE.ScheduleWeekKey = Schd.ScheduleWeekKey
    INNER JOIN dbo.DimLifecycleStatus Lcs
        ON FTE.LifecycleStatusKey = Lcs.LifecycleStatusKey' + N' WHERE DD.FiscalWeekEndDate IN ( ' + N''''
              + CONVERT(VARCHAR, ?, 23) + N'''' + N' )' + N' AND Acct.AccountSubaccountKey IN ('
              + N'SELECT AccountSubaccountKey ' + N' FROM model.vAccountSubAccount '
              + ISNULL(
                          NCHAR(10) + N'WHERE '
                          + STUFF(
                            (
                                SELECT NCHAR(10) + N'  OR ' + (f.FieldPath)
                                FROM @Field f
                                FOR XML PATH(N'')
                            ),
                            1,
                            6,
                            N''
                                 ),
                          N''
                      ) + N')'
              + +N'
GROUP BY DD.FullDate,
         DD.FiscalWeekEndDate,
		 Std.StudentID,
         Spn.SponsorID,
		 Spn.PartnerID,
         Tsp.TuitionAssistanceProviderID,
         CC.CostCenterNumber,
         Acct.AccountSubaccountID,
         Tr.TierID,
         Pgm.ProgramID,
         SS.SessionID,
         Schd.ScheduleWeekName,
         Lcs.LifecycleStatusName,
         FTE.SourceSystem,
       Std.CSSStudentNumber,
         Spn.CSSCenterNumber,
         Spn.CSSFamilyNumber,
         Tr.CSSTierNumber,
         Pgm.ProgramName,
         SS.SessionName';
        INSERT INTO @QueryTable
        (
            SQLQUERY
        )
        SELECT CAST(@SQL AS VARCHAR(MAX));
    END;

    ELSE
    BEGIN
        DECLARE @Field2 AS TABLE
        (
            FieldPath VARCHAR(MAX) NOT NULL,
            TuitionType VARCHAR(50) NULL
        );
        DELETE FROM @Field2;
        INSERT INTO @Field2
        (
            FieldPath,
            TuitionType
        )
        (SELECT FieldPath,
                TuitionType
         FROM GL_Staging.dbo.MartASALookup
         WHERE MeasureName = @Measurename);


        DECLARE @SQL2 NVARCHAR(MAX);

        SET @SQL2
            = N'SELECT 
       DD.FullDate,
	   DD.FiscalWeekEndDate,
       Std.StudentID,
       Spn.SponsorID,
	   COALESCE(Spn.PartnerID, -1) PartnerID,
       Tsp.TuitionAssistanceProviderID,
       CC.CostCenterNumber, ' + N'''' + @Measurename + N''''
              + N'  AS Measurename,
       Acct.AccountSubaccountID,
       Tr.TierID,
       Pgm.ProgramID,
       SS.SessionID,
       Schd.ScheduleWeekName,
       Lcs.LifecycleStatusName,
       SUM(FTE.FTE) AS Value1,
       FTE.SourceSystem AS SourceSystem,
      Std.CSSStudentNumber ,
      Spn.CSSCenterNumber  ,
      Spn.CSSFamilyNumber  ,
      Tr.CSSTierNumber	   ,
      Pgm.ProgramName	   ,
      SS.SessionName
FROM dbo.FactFTESnapshot FTE
    INNER JOIN dbo.DimDate DD
        ON FTE.DateKey = DD.DateKey
    INNER JOIN dbo.DimStudent Std
        ON FTE.StudentKey = Std.StudentKey
    INNER JOIN dbo.DimSponsor Spn
        ON FTE.SponsorKey = Spn.SponsorKey
    INNER JOIN dbo.DimTuitionAssistanceProvider Tsp
        ON FTE.TuitionAssistanceProviderKey = Tsp.TuitionAssistanceProviderKey
    INNER JOIN dbo.DimCostCenter CC
        ON FTE.CostCenterKey = CC.CostCenterKey
    INNER JOIN dbo.DimAccountSubaccount Acct
        ON FTE.AccountSubaccountKey = Acct.AccountSubaccountKey
    INNER JOIN dbo.DimTier Tr
        ON FTE.TierKey = Tr.TierKey
    INNER JOIN dbo.DimProgram Pgm
        ON FTE.ProgramKey = Pgm.ProgramKey
    INNER JOIN dbo.DimSession SS
        ON FTE.SessionKey = SS.SessionKey
    INNER JOIN dbo.DimScheduleWeek Schd
        ON FTE.ScheduleWeekKey = Schd.ScheduleWeekKey
    INNER JOIN dbo.DimLifecycleStatus Lcs
        ON FTE.LifecycleStatusKey = Lcs.LifecycleStatusKey' + N' WHERE DD.FiscalWeekEndDate IN ( ' + N''''
              + CONVERT(VARCHAR, ?, 23) + N'''' + N' )' + N' AND Acct.AccountSubaccountKey IN ('
              + N'SELECT AccountSubaccountKey ' + N' FROM model.vAccountSubAccount '
              + ISNULL(
                          NCHAR(10) + N'WHERE '
                          + STUFF(
                            (
                                SELECT NCHAR(10) + N'  OR ' + (f.FieldPath)
                                FROM @Field2 f
                                FOR XML PATH(N'')
                            ),
                            1,
                            6,
                            N''
                                 ),
                          N''
                      ) + +N'AND' + N'[Tuition ' + N'Type]= ' + N''''
              + STUFF(
                (
                    SELECT ',' + TuitionType FROM @Field2 FOR XML PATH('')
                ),
                1,
                1,
                ''
                     ) + N'''' + N')'
              + N'
GROUP BY DD.FullDate,
		 DD.FiscalWeekEndDate,
         Std.StudentID,
         Spn.SponsorID,
		 Spn.PartnerID,
         Tsp.TuitionAssistanceProviderID,
         CC.CostCenterNumber,
         Acct.AccountSubaccountID,
         Tr.TierID,
         Pgm.ProgramID,
         SS.SessionID,
         Schd.ScheduleWeekName,
         Lcs.LifecycleStatusName,
         FTE.SourceSystem,
         Std.CSSStudentNumber,
         Spn.CSSCenterNumber,
         Spn.CSSFamilyNumber,
         Tr.CSSTierNumber,
         Pgm.ProgramName,
         SS.SessionName';
        INSERT INTO @QueryTable
        (
            SQLQUERY
        )
        SELECT CAST(@SQL2 AS VARCHAR(MAX));

    END;

    FETCH NEXT FROM csr_fact_rabalance_fisc_weekend
    INTO @Measurename;
END;

CLOSE csr_fact_rabalance_fisc_weekend;
DEALLOCATE csr_fact_rabalance_fisc_weekend;




SELECT CAST(REPLACE(
            (
                SELECT STUFF(
                       (
                           SELECT N' UNION ' + (SQLQUERY) FROM @QueryTable FOR XML PATH(N'')
                       ),
                       1,
                       6,
                       N''
                            )
            ),
            '&#x0D;',
            ''
                   ) AS VARCHAR(MAX));",1,1,0,0,0,0,1
2672,Package\Sequence Container 1\Seq - New FTE\Get Processed Date to End,"DECLARE @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessDate,GETDATE()) AS LastProcessDate",1,1,0,0,0,0,1
2673,Package\Sequence Container 1\Seq - New FTE\SQL - Get Last Processed Dates,"SELECT  201101 AS LastProcessFiscalWeekNumber, '01-08-2011' AS LastProcessDate",1,1,0,0,0,0,1
2674,Package\Sequence Container 1\Seq - New FTE\SQL - Get List Of Weeks to Process,"IF (SELECT TOP 1 MeasureName
FROM GL_Staging..MartASALookup
WHERE MeasureName NOT IN
      (
          SELECT DISTINCT MeasureName FROM BING_EDW..SupportDailyMeasureFTE
      )
      AND GLMetricTypeCode = 'Stat' ) IS NULL 
	  BEGIN 
	  SELECT d.[FiscalWeekStartDate] AS DataScenarioFiscalWeekStartDate,
       d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate,
    d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber

FROM dbo.FactFTESnapshot (NOLOCK) AS f
    JOIN dbo.DimDate (NOLOCK) AS d
        ON f.DateKey = d.DateKey
WHERE[f].EDWCreatedDate  BETWEEN '01-01-1900' AND  '01-01-1900'
GROUP BY d.[FiscalWeekNumber],
         d.[FiscalWeekEndDate],
         d.[FiscalYearEndDate],
         d.[FiscalWeekOfYearNumber],
   d.[FiscalWeekStartDate]
   END 
   ELSE 
   BEGIN

SELECT d.[FiscalWeekStartDate] AS DataScenarioFiscalWeekStartDate,
       d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate,
    d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber

FROM dbo.FactFTESnapshot (NOLOCK) AS f
    JOIN dbo.DimDate (NOLOCK) AS d
        ON f.DateKey = d.DateKey
WHERE [d].Fulldate  BETWEEN ? AND ?
GROUP BY d.[FiscalWeekNumber],
         d.[FiscalWeekEndDate],
         d.[FiscalYearEndDate],
         d.[FiscalWeekOfYearNumber],
   d.[FiscalWeekStartDate]
UNION
SELECT [FiscalWeekStartDate] AS DataScenarioFiscalWeekStartDate,
       d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate,
    d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
FROM dbo.FactFTESnapshot (NOLOCK) AS f
    JOIN dbo.DimDate (NOLOCK) AS d
        ON f.DateKey = d.DateKey
WHERE [d].[FiscalWeekNumber] > ? AND [d].[Fulldate]<= ?
GROUP BY d.[FiscalWeekNumber],
         d.[FiscalWeekEndDate],
         d.[FiscalYearEndDate],
         d.[FiscalWeekOfYearNumber],
   d.[FiscalWeekStartDate]
ORDER BY  DataScenarioFiscalWeekStartDate

END ",1,1,0,0,0,0,1
2675,Package\Sequence Container 1\Seq - New NetRev\Foreach - New or Updated Fiscal Week\Foreach Loop Container\SQL - End NewNetRev Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2676,Package\Sequence Container 1\Seq - New NetRev\Foreach - New or Updated Fiscal Week\SQL - Start NewNetRev_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2677,Package\Sequence Container 1\Seq - New NetRev\Foreach - New or Updated Fiscal Week\SQL- Assigning SRC query to Variable,"DECLARE @QueryTable TABLE
(
    SQLQUERY VARCHAR(MAX) NULL
);

DECLARE @Measurename VARCHAR(100);
DECLARE csr_BaseRevenue CURSOR FOR
SELECT Distinct  MeasureName
FROM GL_Staging..MartASALookup
WHERE MeasureName NOT IN
      (
          SELECT DISTINCT MeasureName FROM BING_EDW..SupportDailyMeasureRev
      )
	  AND MeasureName <> 'Payroll'
      AND GLMetricTypeCode = 'USD';
--
-- Use cursor to loop through the values we have chosen to split this batch by
--
OPEN csr_BaseRevenue;
FETCH NEXT FROM csr_BaseRevenue
INTO @Measurename;
WHILE @@FETCH_STATUS = 0
BEGIN


    IF
    (
        SELECT  TuitionType
        FROM GL_Staging..MartASALookup
        WHERE MeasureName = @Measurename
    ) NOT LIKE '%[A-Z]%'
    BEGIN
        DECLARE @Field AS TABLE
        (
            FieldPath VARCHAR(MAX) NOT NULL
        );
        DELETE FROM @Field;
        INSERT INTO @Field
        (
            FieldPath
        )
        (SELECT FieldPath
         FROM GL_Staging.dbo.MartASALookup
         WHERE MeasureName = @Measurename);
        DECLARE @SQL NVARCHAR(MAX);

        SET @SQL
            = N'SELECT 
       DD.FullDate,
	   DD.FiscalWeekEndDate,
       Std.StudentID,
       Spn.SponsorID,
	  COALESCE(Spn.PartnerID, -1) PartnerID,
       Tsp.TuitionAssistanceProviderID,
       CC.CostCenterNumber, ' + N'''' + @Measurename + N''''
              + N'  AS Measurename,
       Acct.AccountSubaccountID,
       Tr.TierID,
       Pgm.ProgramID,
       SS.SessionID,
       Schd.ScheduleWeekName,
       Lcs.LifecycleStatusName,
        Net.TransactionNumber,
       SUM(Net.NetRevenueAmount) AS Value1,
       Net.SourceSystem AS SourceSystem,
       Std.CSSStudentNumber,
       Spn.CSSCenterNumber,
       Spn.CSSFamilyNumber,
	   Tsp.CSSCustomerCode,
       Tr.CSSTierNumber,
       Pgm.ProgramName,
       SS.SessionName
FROM dbo.FactNetRevenue Net
    INNER JOIN dbo.DimDate DD
        ON Net.DateKey = DD.DateKey
    INNER JOIN dbo.DimStudent Std
        ON Net.StudentKey = Std.StudentKey
    INNER JOIN dbo.DimSponsor Spn
        ON Net.SponsorKey = Spn.SponsorKey
    INNER JOIN dbo.DimTuitionAssistanceProvider Tsp
        ON Net.TuitionAssistanceProviderKey = Tsp.TuitionAssistanceProviderKey
    INNER JOIN dbo.DimCostCenter CC
        ON Net.CostCenterKey = CC.CostCenterKey
    INNER JOIN dbo.DimAccountSubaccount Acct
        ON Net.AccountSubaccountKey = Acct.AccountSubaccountKey
    INNER JOIN dbo.DimTier Tr
        ON Net.TierKey = Tr.TierKey
    INNER JOIN dbo.DimProgram Pgm
        ON Net.ProgramKey = Pgm.ProgramKey
    INNER JOIN dbo.DimSession SS
        ON Net.SessionKey = SS.SessionKey
    INNER JOIN dbo.DimScheduleWeek Schd
        ON Net.ScheduleWeekKey = Schd.ScheduleWeekKey
    INNER JOIN dbo.DimLifecycleStatus Lcs
        ON Net.LifecycleStatusKey = Lcs.LifecycleStatusKey' + N' WHERE DD.FiscalWeekEndDate IN ( ' + N''''
              + CONVERT(VARCHAR,?, 23) + N'''' + N' )' + N' AND Acct.AccountSubaccountKey IN ('
              + N'SELECT AccountSubaccountKey ' + N' FROM model.vAccountSubAccount '
              + ISNULL(
                          NCHAR(10) + N'WHERE '
                          + STUFF(
                            (
                                SELECT NCHAR(10) + N'  OR ' + (f.FieldPath)
                                FROM @Field f
                                FOR XML PATH(N'')
                            ),
                            1,
                            6,
                            N''
                                 ),
                          N''
                      ) + N')'
              + +N'
GROUP BY DD.FullDate,
         DD.FiscalWeekEndDate,
		 Std.StudentID,
         Spn.SponsorID,
		 Spn.PartnerID,
         Tsp.TuitionAssistanceProviderID,
         CC.CostCenterNumber,
         Acct.AccountSubaccountID,
         Tr.TierID,
         Pgm.ProgramID,
         SS.SessionID,
         Schd.ScheduleWeekName,
         Lcs.LifecycleStatusName,
		 Net.SourceSystem,
        Net.TransactionNumber,
         Std.CSSStudentNumber,
         Spn.CSSCenterNumber,
         Spn.CSSFamilyNumber,
		 Tsp.CSSCustomerCode,
         Tr.CSSTierNumber,
         Pgm.ProgramName,
         SS.SessionName';
        INSERT INTO @QueryTable
        (
            SQLQUERY
        )
        SELECT CAST(@SQL AS VARCHAR(MAX));
    END;

    ELSE
    BEGIN
        DECLARE @Field2 AS TABLE
        (
            FieldPath VARCHAR(MAX) NOT NULL,
            TuitionType VARCHAR(50) NULL
        );
        DELETE FROM @Field2;
        INSERT INTO @Field2
        (
            FieldPath,
            TuitionType
        )
        (SELECT FieldPath,
                TuitionType
         FROM GL_Staging.dbo.MartASALookup
         WHERE MeasureName = @Measurename);


        DECLARE @SQL2 NVARCHAR(MAX);

        SET @SQL2
            = N'SELECT 
       DD.FullDate,
	   DD.FiscalWeekEndDate,
       Std.StudentID,
       Spn.SponsorID,
	   COALESCE(Spn.PartnerID, -1) PartnerID,
       Tsp.TuitionAssistanceProviderID,
       CC.CostCenterNumber, ' + N'''' + @Measurename + N''''
              + N'  AS Measurename,
       Acct.AccountSubaccountID,
       Tr.TierID,
       Pgm.ProgramID,
       SS.SessionID,
       Schd.ScheduleWeekName,
       Lcs.LifecycleStatusName,
        Net.TransactionNumber,
       SUM(Net.NetRevenueAmount) AS Value1,
       Net.SourceSystem AS SourceSystem,
       Std.CSSStudentNumber,
       Spn.CSSCenterNumber,
       Spn.CSSFamilyNumber,
	   Tsp.CSSCustomerCode,
       Tr.CSSTierNumber,
       Pgm.ProgramName,
       SS.SessionName
FROM dbo.FactNetRevenue Net
    INNER JOIN dbo.DimDate DD
        ON Net.DateKey = DD.DateKey
    INNER JOIN dbo.DimStudent Std
        ON Net.StudentKey = Std.StudentKey
    INNER JOIN dbo.DimSponsor Spn
        ON Net.SponsorKey = Spn.SponsorKey
    INNER JOIN dbo.DimTuitionAssistanceProvider Tsp
        ON Net.TuitionAssistanceProviderKey = Tsp.TuitionAssistanceProviderKey
    INNER JOIN dbo.DimCostCenter CC
        ON Net.CostCenterKey = CC.CostCenterKey
    INNER JOIN dbo.DimAccountSubaccount Acct
        ON Net.AccountSubaccountKey = Acct.AccountSubaccountKey
    INNER JOIN dbo.DimTier Tr
        ON Net.TierKey = Tr.TierKey
    INNER JOIN dbo.DimProgram Pgm
        ON Net.ProgramKey = Pgm.ProgramKey
    INNER JOIN dbo.DimSession SS
        ON Net.SessionKey = SS.SessionKey
    INNER JOIN dbo.DimScheduleWeek Schd
        ON Net.ScheduleWeekKey = Schd.ScheduleWeekKey
    INNER JOIN dbo.DimLifecycleStatus Lcs
        ON Net.LifecycleStatusKey = Lcs.LifecycleStatusKey' + N' WHERE DD.FiscalWeekEndDate IN ( ' + N''''
              + CONVERT(VARCHAR, ?, 23) + N'''' + N' )' + N' AND Acct.AccountSubaccountKey IN ('
              + N'SELECT AccountSubaccountKey ' + N' FROM model.vAccountSubAccount '
              + ISNULL(
                          NCHAR(10) + N'WHERE '
                          + STUFF(
                            (
                                SELECT NCHAR(10) + N'  OR ' + (f.FieldPath)
                                FROM @Field2 f
                                FOR XML PATH(N'')
                            ),
                            1,
                            6,
                            N''
                                 ),
                          N''
                      ) + +N'AND' + N'[Tuition ' + N'Type]= ' + N''''
              + STUFF(
                (
                    SELECT ',' + TuitionType FROM @Field2 FOR XML PATH('')
                ),
                1,
                1,
                ''
                     ) + N'''' + N')'
              + N'
GROUP BY DD.FullDate,
		 DD.FiscalWeekEndDate,
         Std.StudentID,
         Spn.SponsorID,
		 Spn.PartnerID,
         Tsp.TuitionAssistanceProviderID,
         CC.CostCenterNumber,
         Acct.AccountSubaccountID,
         Tr.TierID,
         Pgm.ProgramID,
         SS.SessionID,
         Schd.ScheduleWeekName,
         Lcs.LifecycleStatusName,
		 Net.SourceSystem,
         Net.TransactionNumber,
         Std.CSSStudentNumber,
         Spn.CSSCenterNumber,
         Spn.CSSFamilyNumber,
		 Tsp.CSSCustomerCode,
         Tr.CSSTierNumber,
         Pgm.ProgramName,
         SS.SessionName';
        INSERT INTO @QueryTable
        (
            SQLQUERY
        )
        SELECT CAST(@SQL2 AS VARCHAR(MAX));

    END;

    FETCH NEXT FROM csr_BaseRevenue
    INTO @Measurename;
END;

CLOSE csr_BaseRevenue;
DEALLOCATE csr_BaseRevenue;




SELECT CAST(REPLACE(
            (
                SELECT STUFF(
                       (
                           SELECT N' UNION ' + (SQLQUERY) FROM @QueryTable FOR XML PATH(N'')
                       ),
                       1,
                       6,
                       N''
                            )
            ),
            '&#x0D;',
            ''
                   ) AS VARCHAR(MAX))
	WHERE CAST(REPLACE(
            (
                SELECT STUFF(
                       (
                           SELECT N' UNION ' + (SQLQUERY) FROM @QueryTable FOR XML PATH(N'')
                       ),
                       1,
                       6,
                       N''
                            )
            ),
            '&#x0D;',
            ''
                   ) AS VARCHAR(MAX)) IS NOT NULL;",1,1,0,0,0,0,1
2678,Package\Sequence Container 1\Seq - New NetRev\Get Processed Date to End,"DECLARE @LastProcessDate datetime;
WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
SELECT ISNULL(@LastProcessDate,GETDATE()) AS LastProcessDate",1,1,0,0,0,0,1
2679,Package\Sequence Container 1\Seq - New NetRev\SQL - Get Last Processed Dates,"SELECT  201101 AS LastProcessFiscalWeekNumber, '01-08-2011' AS LastProcessDate",1,1,0,0,0,0,1
2680,Package\Sequence Container 1\Seq - New NetRev\SQL - Get List Of Weeks to Process,"IF (SELECT TOP 1 MeasureName
FROM GL_Staging..MartASALookup
WHERE MeasureName NOT IN
      (
          SELECT MeasureName FROM BING_EDW..SupportDailyMeasureRev
      )
      AND GLMetricTypeCode = 'USD' ) IS  NULL
	  BEGIN 
	  SELECT d.[FiscalWeekStartDate] AS DataScenarioFiscalWeekStartDate,
       d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate,
    d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber

FROM dbo.FactNetRevenue (NOLOCK) AS f
    JOIN dbo.DimDate (NOLOCK) AS d
        ON f.DateKey = d.DateKey
WHERE [f].[EDWCreatedDate]  BETWEEN '01-01-1900' AND  '01-01-1900'
GROUP BY d.[FiscalWeekNumber],
         d.[FiscalWeekEndDate],
         d.[FiscalYearEndDate],
         d.[FiscalWeekOfYearNumber],
   d.[FiscalWeekStartDate]
   END 
   ELSE 
   BEGIN

SELECT d.[FiscalWeekStartDate] AS DataScenarioFiscalWeekStartDate,
       d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate,
    d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber

FROM dbo.FactNetRevenue (NOLOCK) AS f
    JOIN dbo.DimDate (NOLOCK) AS d
        ON f.DateKey = d.DateKey
WHERE [d].FullDate  BETWEEN  ? AND  ?
GROUP BY d.[FiscalWeekNumber],
         d.[FiscalWeekEndDate],
         d.[FiscalYearEndDate],
         d.[FiscalWeekOfYearNumber],
   d.[FiscalWeekStartDate]
UNION
SELECT [FiscalWeekStartDate] AS DataScenarioFiscalWeekStartDate,
       d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate,
    d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
FROM dbo.FactNetRevenue (NOLOCK) AS f
    JOIN dbo.DimDate (NOLOCK) AS d
        ON f.DateKey = d.DateKey
WHERE [d].[FiscalWeekNumber] > ? AND [d].FullDate<=?
GROUP BY d.[FiscalWeekNumber],
         d.[FiscalWeekEndDate],
         d.[FiscalYearEndDate],
         d.[FiscalWeekOfYearNumber],
   d.[FiscalWeekStartDate]
ORDER BY  DataScenarioFiscalWeekStartDate

END",1,1,0,0,0,0,1
2681,Package\Sequence Container\Seq - Incremental FTE\Foreach - New or Updated Fiscal Week\Foreach Loop Container\SQL - End IncremenalFTE Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2682,Package\Sequence Container\Seq - Incremental FTE\Foreach - New or Updated Fiscal Week\SQL - Delete DailyMeasureFTE,"DELETE FROM DW_Base.dbo.BaseDailyMeasureFTE WHERE FiscalWeekEndDate =?


Select @@Rowcount as DC",1,1,0,0,0,0,1
2683,Package\Sequence Container\Seq - Incremental FTE\Foreach - New or Updated Fiscal Week\SQL - Start IncrementalFTE_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2684,Package\Sequence Container\Seq - Incremental FTE\Foreach - New or Updated Fiscal Week\SQL- Assigning SRC query to Variable,"DECLARE @QueryTable TABLE
(
    SQLQUERY VARCHAR(MAX) NULL
);

DECLARE @Measurename VARCHAR(100);
DECLARE csr_fact_rabalance_fisc_weekend CURSOR FOR
SELECT MeasureName
FROM GL_Staging..MartASALookup
WHERE GLMetricTypeCode = 'Stat';

OPEN csr_fact_rabalance_fisc_weekend;
FETCH NEXT FROM csr_fact_rabalance_fisc_weekend
INTO @Measurename;
WHILE @@FETCH_STATUS = 0
BEGIN

 
    IF
    (
        SELECT TuitionType
        FROM GL_Staging..MartASALookup
        WHERE MeasureName = @Measurename
    ) NOT LIKE '%[A-Z]%'
    BEGIN
        DECLARE @Field AS TABLE
        (
            FieldPath VARCHAR(MAX) NOT NULL
        );
		DELETE FROM @Field
        INSERT INTO @Field
        (
            FieldPath
        )
        (SELECT FieldPath
         FROM GL_Staging.dbo.MartASALookup
         WHERE MeasureName = @Measurename);
        DECLARE @SQL NVARCHAR(MAX);

        SET @SQL
            = N'SELECT 
       DD.FullDate,
	   DD.FiscalWeekEndDate,
       Std.StudentID,
       Spn.SponsorID,
	   COALESCE(Spn.PartnerID, -1)PartnerID,
       Tsp.TuitionAssistanceProviderID,
       CC.CostCenterNumber, ' + '''' +
	  @MeasureName +'''' + '  AS Measurename,
       Acct.AccountSubaccountID,
       Tr.TierID,
       Pgm.ProgramID,
       SS.SessionID,
       Schd.ScheduleWeekName,
       Lcs.LifecycleStatusName,
       SUM(FTE.FTE) AS Value1,
       FTE.SourceSystem AS SourceSystem,
      Std.CSSStudentNumber ,
      Spn.CSSCenterNumber  ,
      Spn.CSSFamilyNumber  ,
      Tr.CSSTierNumber	   ,
      Pgm.ProgramName	   ,
      SS.SessionName
FROM dbo.FactFTESnapshot FTE
    INNER JOIN dbo.DimDate DD
        ON FTE.DateKey = DD.DateKey
    INNER JOIN dbo.DimStudent Std
        ON FTE.StudentKey = Std.StudentKey
    INNER JOIN dbo.DimSponsor Spn
        ON FTE.SponsorKey = Spn.SponsorKey
    INNER JOIN dbo.DimTuitionAssistanceProvider Tsp
        ON FTE.TuitionAssistanceProviderKey = Tsp.TuitionAssistanceProviderKey
    INNER JOIN dbo.DimCostCenter CC
        ON FTE.CostCenterKey = CC.CostCenterKey
    INNER JOIN dbo.DimAccountSubaccount Acct
        ON FTE.AccountSubaccountKey = Acct.AccountSubaccountKey
    INNER JOIN dbo.DimTier Tr
        ON FTE.TierKey = Tr.TierKey
    INNER JOIN dbo.DimProgram Pgm
        ON FTE.ProgramKey = Pgm.ProgramKey
    INNER JOIN dbo.DimSession SS
        ON FTE.SessionKey = SS.SessionKey
    INNER JOIN dbo.DimScheduleWeek Schd
        ON FTE.ScheduleWeekKey = Schd.ScheduleWeekKey
    INNER JOIN dbo.DimLifecycleStatus Lcs
        ON FTE.LifecycleStatusKey = Lcs.LifecycleStatusKey' + N' WHERE DD.FiscalWeekEndDate IN ( '
             +  '''' + CONVERT(VARCHAR, ?, 23) + '''' +' )'
                 + N' AND Acct.AccountSubaccountKey IN (' + N'SELECT AccountSubaccountKey '
              + N' FROM model.vAccountSubAccount '
              + ISNULL(
                          NCHAR(10) + N'WHERE '
                          + STUFF(
                            (
                                SELECT NCHAR(10) + N'  OR ' + (f.FieldPath)
                                FROM @Field f
                                FOR XML PATH(N'')
                            ),
                            1,
                            6,
                            N''
                                 ),
                          N''
                      ) + N')'
              + +N'
GROUP BY DD.FullDate,
         DD.FiscalWeekEndDate,
		 Std.StudentID,
         Spn.SponsorID,
		 Spn.PartnerID,
         Tsp.TuitionAssistanceProviderID,
         CC.CostCenterNumber,
         Acct.AccountSubaccountID,
         Tr.TierID,
         Pgm.ProgramID,
         SS.SessionID,
         Schd.ScheduleWeekName,
         Lcs.LifecycleStatusName,
         FTE.SourceSystem,
       Std.CSSStudentNumber,
         Spn.CSSCenterNumber,
         Spn.CSSFamilyNumber,
         Tr.CSSTierNumber,
         Pgm.ProgramName,
         SS.SessionName';
        INSERT INTO @QueryTable
        (
            SQLQUERY
        )
        SELECT CAST(@SQL AS VARCHAR(MAX));
    END;

    ELSE
    BEGIN
        DECLARE @Field2 AS TABLE
        (
            FieldPath VARCHAR(MAX) NOT NULL,
            TuitionType VARCHAR(50) NULL
        );
		DELETE FROM @Field2
        INSERT INTO @Field2
        (
            FieldPath,
            TuitionType
        )
        (SELECT FieldPath,
                TuitionType
         FROM GL_Staging.dbo.MartASALookup
         WHERE MeasureName = @Measurename);


        DECLARE @SQL2 NVARCHAR(MAX);

        SET @SQL2
            = N'SELECT 
       DD.FullDate,
	   DD.FiscalWeekEndDate,
       Std.StudentID,
       Spn.SponsorID,
	   COALESCE(Spn.PartnerID, -1)PartnerID,
       Tsp.TuitionAssistanceProviderID,
       CC.CostCenterNumber, ' + '''' +
	  @MeasureName +'''' + '  AS Measurename,
       Acct.AccountSubaccountID,
       Tr.TierID,
       Pgm.ProgramID,
       SS.SessionID,
       Schd.ScheduleWeekName,
       Lcs.LifecycleStatusName,
       SUM(FTE.FTE) AS Value1,
       FTE.SourceSystem AS SourceSystem,
      Std.CSSStudentNumber ,
      Spn.CSSCenterNumber  ,
      Spn.CSSFamilyNumber  ,
      Tr.CSSTierNumber	   ,
      Pgm.ProgramName	   ,
      SS.SessionName
FROM dbo.FactFTESnapshot FTE
    INNER JOIN dbo.DimDate DD
        ON FTE.DateKey = DD.DateKey
    INNER JOIN dbo.DimStudent Std
        ON FTE.StudentKey = Std.StudentKey
    INNER JOIN dbo.DimSponsor Spn
        ON FTE.SponsorKey = Spn.SponsorKey
    INNER JOIN dbo.DimTuitionAssistanceProvider Tsp
        ON FTE.TuitionAssistanceProviderKey = Tsp.TuitionAssistanceProviderKey
    INNER JOIN dbo.DimCostCenter CC
        ON FTE.CostCenterKey = CC.CostCenterKey
    INNER JOIN dbo.DimAccountSubaccount Acct
        ON FTE.AccountSubaccountKey = Acct.AccountSubaccountKey
    INNER JOIN dbo.DimTier Tr
        ON FTE.TierKey = Tr.TierKey
    INNER JOIN dbo.DimProgram Pgm
        ON FTE.ProgramKey = Pgm.ProgramKey
    INNER JOIN dbo.DimSession SS
        ON FTE.SessionKey = SS.SessionKey
    INNER JOIN dbo.DimScheduleWeek Schd
        ON FTE.ScheduleWeekKey = Schd.ScheduleWeekKey
    INNER JOIN dbo.DimLifecycleStatus Lcs
        ON FTE.LifecycleStatusKey = Lcs.LifecycleStatusKey' + N' WHERE DD.FiscalWeekEndDate IN ( '
             +  '''' + CONVERT(VARCHAR, ?, 23) + '''' +' )' + N' AND Acct.AccountSubaccountKey IN (' + N'SELECT AccountSubaccountKey '
              + N' FROM model.vAccountSubAccount '
              + ISNULL(
                          NCHAR(10) + N'WHERE '
                          + STUFF(
                            (
                                SELECT NCHAR(10) + N'  OR ' + (f.FieldPath)
                                FROM @Field2 f
                                FOR XML PATH(N'')
                            ),
                            1,
                            6,
                            N''
                                 ),
                          N''
                      ) + +N'AND' + N'[Tuition ' + N'Type]= ' + N''''
              + STUFF(
                (
                    SELECT ',' + TuitionType FROM @Field2 FOR XML PATH('')
                ),
                1,
                1,
                ''
                     ) + N'''' + N')'
              + N'
GROUP BY DD.FullDate,
		 DD.FiscalWeekEndDate,
         Std.StudentID,
         Spn.SponsorID,
		 Spn.PartnerID,
         Tsp.TuitionAssistanceProviderID,
         CC.CostCenterNumber,
         Acct.AccountSubaccountID,
         Tr.TierID,
         Pgm.ProgramID,
         SS.SessionID,
         Schd.ScheduleWeekName,
         Lcs.LifecycleStatusName,
         FTE.SourceSystem,
         Std.CSSStudentNumber,
         Spn.CSSCenterNumber,
         Spn.CSSFamilyNumber,
         Tr.CSSTierNumber,
         Pgm.ProgramName,
         SS.SessionName';
        INSERT INTO @QueryTable
        (
            SQLQUERY
        )
        SELECT CAST(@SQL2 AS VARCHAR(MAX));

    END;

    FETCH NEXT FROM csr_fact_rabalance_fisc_weekend
    INTO @Measurename;
END;

CLOSE csr_fact_rabalance_fisc_weekend;
DEALLOCATE csr_fact_rabalance_fisc_weekend;

SELECT CAST( Replace ((SELECT STUFF(( SELECT  N' UNION ' + (SQLQUERY) FROM @QueryTable FOR XML PATH(N'')),1,6,N'')) , '&#x0D;', '') AS VARCHAR(MAX) )",1,1,0,0,0,0,1
2685,Package\Sequence Container\Seq - Incremental FTE\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate DATETIME, @LastsuccessfulDate DATETIME;
IF (SELECT Top 1 AuditId
           FROM dbo.AuditLog WHERE TaskName= ?) IS NULL 
BEGIN
    WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName ='NewFTE' )
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;

WITH LatestJobAuditBySuccessfulRun AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastsuccessfulDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditBySuccessfulRun AS lja ON lja.LatestJobAudit = ja.AuditId;

SELECT ISNULL(@LastProcessFiscalWeekNumber, 201101) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '01-08-2011') AS LastProcessDate,
ISNULL(@LastsuccessfulDate, '01-08-2011') AS LastsuccessfulDate
END
ELSE 
BEGIN

WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;

WITH LatestJobAuditBySuccessfulRun AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastsuccessfulDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditBySuccessfulRun AS lja ON lja.LatestJobAudit = ja.AuditId;

SELECT ISNULL(@LastProcessFiscalWeekNumber, 201101) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '01-08-2011') AS LastProcessDate,
ISNULL(@LastsuccessfulDate, '01-08-2011') AS LastsuccessfulDate;

END",1,1,0,0,0,0,1
2686,Package\Sequence Container\Seq - Incremental FTE\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekStartDate] AS DataScenarioFiscalWeekStartDate,
       d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate,
    d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber

FROM dbo.FactFTESnapshot (NOLOCK) AS f
    JOIN dbo.DimDate (NOLOCK) AS d
        ON f.DateKey = d.DateKey
WHERE [f].[EDWCreatedDate] > ?
GROUP BY d.[FiscalWeekNumber],
         d.[FiscalWeekEndDate],
         d.[FiscalYearEndDate],
         d.[FiscalWeekOfYearNumber],
   d.[FiscalWeekStartDate]
UNION
SELECT [FiscalWeekStartDate] AS DataScenarioFiscalWeekStartDate,
       d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate,
    d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
FROM dbo.FactFTESnapshot (NOLOCK) AS f
    JOIN dbo.DimDate (NOLOCK) AS d
        ON f.DateKey = d.DateKey
WHERE [d].[FiscalWeekNumber] > ? AND [f].[EDWCreatedDate] > ?
GROUP BY d.[FiscalWeekNumber],
         d.[FiscalWeekEndDate],
         d.[FiscalYearEndDate],
         d.[FiscalWeekOfYearNumber],
   d.[FiscalWeekStartDate]
ORDER BY  DataScenarioFiscalWeekStartDate",1,1,0,0,0,0,1
2687,Package\Sequence Container\Seq - Incremental NetRev\Foreach - New or Updated Fiscal Week\Foreach Loop Container\SQL - End IncremenalNetRev Auditlog,"Execute spEndAuditLog ?,?,?,?,?,?,?;",1,1,0,0,0,0,1
2688,Package\Sequence Container\Seq - Incremental NetRev\Foreach - New or Updated Fiscal Week\SQL - Delete DailyMeasureNetRevenue,"DELETE FROM DW_Base.dbo.BaseDailyMeasureNetRevenue WHERE FiscalWeekEndDate =?


Select @@Rowcount as DC",1,1,0,0,0,0,1
2689,Package\Sequence Container\Seq - Incremental NetRev\Foreach - New or Updated Fiscal Week\SQL - Start IncrementalNet_Actual Audit Log,"Execute spBeginAuditLog ? OUTPUT, ?, ?;",1,1,0,0,0,0,1
2690,Package\Sequence Container\Seq - Incremental NetRev\Foreach - New or Updated Fiscal Week\SQL- Assigning SRC query to Variable,"DECLARE @QueryTable TABLE
(
    SQLQUERY VARCHAR(MAX) NULL
);

DECLARE @Measurename VARCHAR(100);
DECLARE csr_BaseRevenue CURSOR FOR
SELECT   MeasureName
FROM GL_Staging..MartASALookup

      WHERE  GLMetricTypeCode = 'USD' and MeasureName<>'Payroll';
--
-- Use cursor to loop through the values we have chosen to split this batch by
--
OPEN csr_BaseRevenue;
FETCH NEXT FROM csr_BaseRevenue
INTO @Measurename;
WHILE @@FETCH_STATUS = 0
BEGIN


    IF
    (
        SELECT  TuitionType
        FROM GL_Staging..MartASALookup
        WHERE MeasureName = @Measurename
    ) NOT LIKE '%[A-Z]%'
    BEGIN
        DECLARE @Field AS TABLE
        (
            FieldPath VARCHAR(MAX) NOT NULL
        );
        DELETE FROM @Field;
        INSERT INTO @Field
        (
            FieldPath
        )
        (SELECT FieldPath
         FROM GL_Staging.dbo.MartASALookup
         WHERE MeasureName = @Measurename);
        DECLARE @SQL NVARCHAR(MAX);

        SET @SQL
            = N'SELECT 
       DD.FullDate,
	   DD.FiscalWeekEndDate,
       Std.StudentID,
       Spn.SponsorID,
	   COALESCE(Spn.PartnerID, -1) PartnerID,
       Tsp.TuitionAssistanceProviderID,
       CC.CostCenterNumber, ' + N'''' + @Measurename + N''''
              + N'  AS Measurename,
       Acct.AccountSubaccountID,
       Tr.TierID,
       Pgm.ProgramID,
       SS.SessionID,
       Schd.ScheduleWeekName,
       Lcs.LifecycleStatusName,
        Net.TransactionNumber,
       SUM(Net.NetRevenueAmount) AS Value1,
       Net.SourceSystem AS SourceSystem,
       Std.CSSStudentNumber,
       Spn.CSSCenterNumber,
       Spn.CSSFamilyNumber,
	   Tsp.CSSCustomerCode,
       Tr.CSSTierNumber,
       Pgm.ProgramName,
       SS.SessionName
FROM dbo.FactNetRevenue Net
    INNER JOIN dbo.DimDate DD
        ON Net.DateKey = DD.DateKey
    INNER JOIN dbo.DimStudent Std
        ON Net.StudentKey = Std.StudentKey
    INNER JOIN dbo.DimSponsor Spn
        ON Net.SponsorKey = Spn.SponsorKey
    INNER JOIN dbo.DimTuitionAssistanceProvider Tsp
        ON Net.TuitionAssistanceProviderKey = Tsp.TuitionAssistanceProviderKey
    INNER JOIN dbo.DimCostCenter CC
        ON Net.CostCenterKey = CC.CostCenterKey
    INNER JOIN dbo.DimAccountSubaccount Acct
        ON Net.AccountSubaccountKey = Acct.AccountSubaccountKey
    INNER JOIN dbo.DimTier Tr
        ON Net.TierKey = Tr.TierKey
    INNER JOIN dbo.DimProgram Pgm
        ON Net.ProgramKey = Pgm.ProgramKey
    INNER JOIN dbo.DimSession SS
        ON Net.SessionKey = SS.SessionKey
    INNER JOIN dbo.DimScheduleWeek Schd
        ON Net.ScheduleWeekKey = Schd.ScheduleWeekKey
    INNER JOIN dbo.DimLifecycleStatus Lcs
        ON Net.LifecycleStatusKey = Lcs.LifecycleStatusKey' + N' WHERE DD.FiscalWeekEndDate IN ( ' + N''''
              + CONVERT(VARCHAR,?, 23) + N'''' + N' )' + N' AND Acct.AccountSubaccountKey IN ('
              + N'SELECT AccountSubaccountKey ' + N' FROM model.vAccountSubAccount '
              + ISNULL(
                          NCHAR(10) + N'WHERE '
                          + STUFF(
                            (
                                SELECT NCHAR(10) + N'  OR ' + (f.FieldPath)
                                FROM @Field f
                                FOR XML PATH(N'')
                            ),
                            1,
                            6,
                            N''
                                 ),
                          N''
                      ) + N')'
              + +N'
GROUP BY DD.FullDate,
         DD.FiscalWeekEndDate,
		 Std.StudentID,
         Spn.SponsorID,
		 Spn.PartnerID,
         Tsp.TuitionAssistanceProviderID,
         CC.CostCenterNumber,
         Acct.AccountSubaccountID,
         Tr.TierID,
         Pgm.ProgramID,
         SS.SessionID,
         Schd.ScheduleWeekName,
         Lcs.LifecycleStatusName,
		 Net.SourceSystem,
        Net.TransactionNumber,
         Std.CSSStudentNumber,
         Spn.CSSCenterNumber,
         Spn.CSSFamilyNumber,
		 Tsp.CSSCustomerCode,
         Tr.CSSTierNumber,
         Pgm.ProgramName,
         SS.SessionName';
        INSERT INTO @QueryTable
        (
            SQLQUERY
        )
        SELECT CAST(@SQL AS VARCHAR(MAX));
    END;

    ELSE
    BEGIN
        DECLARE @Field2 AS TABLE
        (
            FieldPath VARCHAR(MAX) NOT NULL,
            TuitionType VARCHAR(50) NULL
        );
        DELETE FROM @Field2;
        INSERT INTO @Field2
        (
            FieldPath,
            TuitionType
        )
        (SELECT FieldPath,
                TuitionType
         FROM GL_Staging.dbo.MartASALookup
         WHERE MeasureName = @Measurename);


        DECLARE @SQL2 NVARCHAR(MAX);

        SET @SQL2
            = N'SELECT 
       DD.FullDate,
	   DD.FiscalWeekEndDate,
       Std.StudentID,
       Spn.SponsorID,
	   COALESCE(Spn.PartnerID, -1) PartnerID,
       Tsp.TuitionAssistanceProviderID,
       CC.CostCenterNumber, ' + N'''' + @Measurename + N''''
              + N'  AS Measurename,
       Acct.AccountSubaccountID,
       Tr.TierID,
       Pgm.ProgramID,
       SS.SessionID,
       Schd.ScheduleWeekName,
       Lcs.LifecycleStatusName,
        Net.TransactionNumber,
       SUM(Net.NetRevenueAmount) AS Value1,
       Net.SourceSystem AS SourceSystem,
       Std.CSSStudentNumber,
       Spn.CSSCenterNumber,
       Spn.CSSFamilyNumber,
	   Tsp.CSSCustomerCode,
       Tr.CSSTierNumber,
       Pgm.ProgramName,
       SS.SessionName
FROM dbo.FactNetRevenue Net
    INNER JOIN dbo.DimDate DD
        ON Net.DateKey = DD.DateKey
    INNER JOIN dbo.DimStudent Std
        ON Net.StudentKey = Std.StudentKey
    INNER JOIN dbo.DimSponsor Spn
        ON Net.SponsorKey = Spn.SponsorKey
    INNER JOIN dbo.DimTuitionAssistanceProvider Tsp
        ON Net.TuitionAssistanceProviderKey = Tsp.TuitionAssistanceProviderKey
    INNER JOIN dbo.DimCostCenter CC
        ON Net.CostCenterKey = CC.CostCenterKey
    INNER JOIN dbo.DimAccountSubaccount Acct
        ON Net.AccountSubaccountKey = Acct.AccountSubaccountKey
    INNER JOIN dbo.DimTier Tr
        ON Net.TierKey = Tr.TierKey
    INNER JOIN dbo.DimProgram Pgm
        ON Net.ProgramKey = Pgm.ProgramKey
    INNER JOIN dbo.DimSession SS
        ON Net.SessionKey = SS.SessionKey
    INNER JOIN dbo.DimScheduleWeek Schd
        ON Net.ScheduleWeekKey = Schd.ScheduleWeekKey
    INNER JOIN dbo.DimLifecycleStatus Lcs
        ON Net.LifecycleStatusKey = Lcs.LifecycleStatusKey' + N' WHERE DD.FiscalWeekEndDate IN ( ' + N''''
              + CONVERT(VARCHAR, ?, 23) + N'''' + N' )' + N' AND Acct.AccountSubaccountKey IN ('
              + N'SELECT AccountSubaccountKey ' + N' FROM model.vAccountSubAccount '
              + ISNULL(
                          NCHAR(10) + N'WHERE '
                          + STUFF(
                            (
                                SELECT NCHAR(10) + N'  OR ' + (f.FieldPath)
                                FROM @Field2 f
                                FOR XML PATH(N'')
                            ),
                            1,
                            6,
                            N''
                                 ),
                          N''
                      ) + +N'AND' + N'[Tuition ' + N'Type]= ' + N''''
              + STUFF(
                (
                    SELECT ',' + TuitionType FROM @Field2 FOR XML PATH('')
                ),
                1,
                1,
                ''
                     ) + N'''' + N')'
              + N'
GROUP BY DD.FullDate,
		 DD.FiscalWeekEndDate,
         Std.StudentID,
         Spn.SponsorID,
		 Spn.PartnerID,
         Tsp.TuitionAssistanceProviderID,
         CC.CostCenterNumber,
         Acct.AccountSubaccountID,
         Tr.TierID,
         Pgm.ProgramID,
         SS.SessionID,
         Schd.ScheduleWeekName,
         Lcs.LifecycleStatusName,
		 Net.SourceSystem,
         Net.TransactionNumber,
         Std.CSSStudentNumber,
         Spn.CSSCenterNumber,
         Spn.CSSFamilyNumber,
		 Tsp.CSSCustomerCode,
         Tr.CSSTierNumber,
         Pgm.ProgramName,
         SS.SessionName';
        INSERT INTO @QueryTable
        (
            SQLQUERY
        )
        SELECT CAST(@SQL2 AS VARCHAR(MAX));

    END;

    FETCH NEXT FROM csr_BaseRevenue
    INTO @Measurename;
END;

CLOSE csr_BaseRevenue;
DEALLOCATE csr_BaseRevenue;




SELECT CAST(REPLACE(
            (
                SELECT STUFF(
                       (
                           SELECT N' UNION ' + (SQLQUERY) FROM @QueryTable FOR XML PATH(N'')
                       ),
                       1,
                       6,
                       N''
                            )
            ),
            '&#x0D;',
            ''
                   ) AS VARCHAR(MAX));",1,1,0,0,0,0,1
2691,Package\Sequence Container\Seq - Incremental NetRev\SQL - Get Last Processed Dates,"DECLARE @LastProcessFiscalWeekNumber int, @LastProcessDate DATETIME , @LastsuccessfulDate DateTime;
IF (SELECT Top 1 AuditId
           FROM dbo.AuditLog WHERE TaskName= ?) IS NULL 
BEGIN
    WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName ='NewNetRev' )
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
	    WITH CTE AS (	  SELECT TaskName,MAX(AuditId) AS e FROM dbo.AuditLog WHERE Statuscode=1 AND TaskName =?   GROUP BY TaskName)
	  
	  SELECT  @LastsuccessfulDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN CTE AS lja ON lja.e = ja.AuditId;
SELECT ISNULL(@LastProcessFiscalWeekNumber, 201101) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '01-08-2011') AS LastProcessDate, ISNULL(@LastsuccessfulDate, '01-08-2011') AS LastsuccessfulDate
END
ELSE 
BEGIN

WITH LatestJobAuditByTaskName AS (
   SELECT TaskName, MAX(AuditId) AS LatestJobAudit
      FROM dbo.AuditLog (NOLOCK)
      WHERE (StatusCode = 1) AND (TaskName = ?)
      GROUP BY TaskName)
SELECT @LastProcessFiscalWeekNumber = ja.BatchSplitByValue, @LastProcessDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN LatestJobAuditByTaskName AS lja ON lja.LatestJobAudit = ja.AuditId;
	  
	  WITH CTE AS (	  SELECT TaskName,MAX(AuditId) AS e FROM dbo.AuditLog WHERE Statuscode=1 AND TaskName =?   GROUP BY TaskName)
	  
	  SELECT  @LastsuccessfulDate = ja.StartTime
   FROM dbo.AuditLog (NOLOCK) AS ja 
      INNER JOIN CTE AS lja ON lja.e = ja.AuditId;

SELECT ISNULL(@LastProcessFiscalWeekNumber, 201101) AS LastProcessFiscalWeekNumber, ISNULL(@LastProcessDate, '01-08-2011') AS LastProcessDate,ISNULL(@LastsuccessfulDate, '01-08-2011') AS LastsuccessfulDate

END",1,1,0,0,0,0,1
2692,Package\Sequence Container\Seq - Incremental NetRev\SQL - Get List Of Weeks to Process,"SELECT d.[FiscalWeekStartDate] AS DataScenarioFiscalWeekStartDate,
       d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate,
    d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber

FROM dbo.FactNetRevenue (NOLOCK) AS f
    JOIN dbo.DimDate (NOLOCK) AS d
        ON f.DateKey = d.DateKey
WHERE [f].[EDWCreatedDate] > ?
GROUP BY d.[FiscalWeekNumber],
         d.[FiscalWeekEndDate],
         d.[FiscalYearEndDate],
         d.[FiscalWeekOfYearNumber],
   d.[FiscalWeekStartDate]
UNION
SELECT [FiscalWeekStartDate] AS DataScenarioFiscalWeekStartDate,
       d.[FiscalWeekEndDate] AS DataScenarioFiscalWeekEndDate,
    d.[FiscalWeekNumber] AS DataScenarioFiscalWeekNumber
FROM dbo.FactNetRevenue (NOLOCK) AS f
    JOIN dbo.DimDate (NOLOCK) AS d
        ON f.DateKey = d.DateKey
WHERE [d].[FiscalWeekNumber] > ?
AND [f].[EDWCreatedDate] > ?
GROUP BY d.[FiscalWeekNumber],
         d.[FiscalWeekEndDate],
         d.[FiscalYearEndDate],
         d.[FiscalWeekOfYearNumber],
   d.[FiscalWeekStartDate]
ORDER BY  DataScenarioFiscalWeekStartDate",1,1,0,0,0,0,1
2693,Package\Truncate Table Support Table,TRUNCATE TABLE  BING_EDW..SupportDailyMeasureFTE,1,1,0,0,0,0,1
2694,Package\Truncate Table Support Table,TRUNCATE TABLE  BING_EDW..SupportDailyMeasureRev,1,1,0,0,0,0,1
